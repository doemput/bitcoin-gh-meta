[
   {
      "body" : "Potential nit, haven't looked at the code in detail: by their local nature there's no way that scoped addresses can work in the P2P address advertising logic - so from a privacy angle, does this make sure that these can't leak to the P2P network?",
      "created_at" : "2016-02-24T09:05:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-188148858",
      "id" : 188148858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-02-24T09:05:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188148858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "For the link-local addresses I believe that is accounted for already because CNetAddr::IsRFC4862 matches them and thus CNetAddr::IsRoutable returns false for them.\r\n\r\nAbout the site-local category of scoped addresses, upon more investigation, their usage is already deprecated by RFC 3879 (https://www.ietf.org/rfc/rfc3879.txt) and Linux does not support them. I only mentioned them because the Windows documents mentioned them and I'm inclined to think that we don't need to concern ourselves with them. If we do, then we could maybe add another method to match them and then make that part of the IsRoutable check too.",
      "created_at" : "2016-02-25T03:05:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-188579984",
      "id" : 188579984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-02-25T03:05:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188579984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2016-03-30T12:45:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-203415400",
      "id" : 203415400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-03-30T12:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/203415400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "I rebased and re-worked this commit to make it easier to review.\r\nPreviously, I tried to be complete. This only changes the minimum needed to get it to work.\r\n\r\nAlso, circling back on the site-local addresses...\r\nTheir original behavior has been deprecated for many years.\r\nI tested `fec0/10` and `fec0/64` addresses with Bitcoin Core 0.12.0, and it already binds them with no problem and does not treat them as local (it advertises them).\r\nThat existing behavior is in line with RFC guidance:\r\nhttps://tools.ietf.org/html/rfc4291#section-2.5.7\r\n```\r\n\"The special behavior of this prefix defined in [RFC3513] must no longer be supported in new implementations (i.e., new implementations must treat this prefix as Global Unicast).\"\r\n```\r\n\r\nThat's good. It means this PR only has to concern itself with link-local (which was the original intent).\r\n\r\nThe link-local `fe80/64` [https://tools.ietf.org/html/rfc4291#section-2.5.6] addresses are treated as being local/non-routable/non-advertisable already.\r\nDiscovery of our own addresses does not add/include link-locals.\r\nAs stated before, `CNetAddr::IsRFC4862` matches link-locals and thus `CNetAddr::IsRoutable` returns false for them. This ultimately stops them from being advertised.\r\n\r\nThe motivation for this change is to make it easier to deploy and manage a cluster of nodes on a local network.\r\nFor example, I was spinning up multiple nodes on an adhoc WIFI network for a simulation and IPv6 link-local addressing made that process easier by a few steps for each node.\r\n",
      "created_at" : "2016-04-05T22:48:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-206023440",
      "id" : 206023440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-04-05T22:48:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206023440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   },
   {
      "body" : "Thanks for the explanation. I was indeed curious what one would use this for in practice.\r\n\r\nutACK https://github.com/bitcoin/bitcoin/pull/7570/commits/eda3d9248971a1c3df6e6c4b23ba89be30508b51",
      "created_at" : "2016-04-06T14:08:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-206389190",
      "id" : 206389190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-04-06T14:08:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206389190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/7570/commits/eda3d9248971a1c3df6e6c4b23ba89be30508b51",
      "created_at" : "2016-04-06T14:46:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7570#issuecomment-206410771",
      "id" : 206410771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7570",
      "updated_at" : "2016-04-06T14:46:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206410771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
