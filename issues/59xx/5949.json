{
   "assignee" : null,
   "body" : "In the spirit of dropping openssl where possible...\r\n\r\nThis uses @sipa's AES impelementation from #5885. As I understand it, he is comfortable with pulling this part in before the rest of fortuna.\r\n\r\nThe bulk of changes here are tests, the actual changes are small. Tests verify that encryption/decryption/keygen work as expected, but also that the results match openssl's exactly (including output buffers in failure cases).\r\n\r\nThe aes-cbc decryption attempts to be done in constant-time, in case it's re-used in the future in places that may be susceptible to timing attacks. It works with/without padding, so it could be re-used in different contexts.\r\n\r\n@sipa I copied your structures for AES*Decrypt/AES*Encrypt for the sake of simplicity, so there's a good bit of duplication here now. I'm happy to re-work with templates, merged classes, separate files, etc.\r\n\r\nBesides the unit tests, I've also done some quick sanity checks via rpc to verify that switching back and forth between implementations works as expected. Wallets encrypted with openssl still decrypt fine, and likewise the other way around.",
   "closed_at" : "2016-03-15T08:21:35Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 23,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949/comments",
   "created_at" : "2015-03-27T00:14:30Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949",
   "id" : 64662345,
   "labels" : [
      {
         "color" : "e10c02",
         "name" : "Priority High",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Priority%20High"
      },
      {
         "color" : "E6F6D6",
         "name" : "Refactoring",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 12,
      "created_at" : "2015-12-03T11:07:58Z",
      "creator" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      },
      "description" : "",
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestones/0.13.0",
      "id" : 1441894,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/20/labels",
      "number" : 20,
      "open_issues" : 15,
      "state" : "open",
      "title" : "0.13.0",
      "updated_at" : "2016-06-15T19:06:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/20"
   },
   "number" : 5949,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/5949.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/5949.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5949"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Replace openssl aes encryption/decryption/key creation implementations with our own",
   "updated_at" : "2016-03-15T08:21:35Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
      "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theuni/followers",
      "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theuni",
      "id" : 417043,
      "login" : "theuni",
      "organizations_url" : "https://api.github.com/users/theuni/orgs",
      "received_events_url" : "https://api.github.com/users/theuni/received_events",
      "repos_url" : "https://api.github.com/users/theuni/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theuni"
   }
}
