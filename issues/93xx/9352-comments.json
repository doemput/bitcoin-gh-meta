[
   {
      "body" : "Concept ACK, good step forward.",
      "created_at" : "2016-12-14T22:34:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267178426",
      "id" : 267178426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-14T22:34:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267178426",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "#9325 already does this, and more, doesn't it? i.e. #9325 will already cause the block to be made if a compact block is received and all txs are present, but in addition, it will request the blocktxns which almost always arrive before the full block requested.\r\n\r\nAlso, the current logic of requesting a full block, I suspect, will be removed soon as this only happens from peers which cannot provide compact blocks - in a way, these nodes are a hindrance to the network more often than not and I expect a future PR will disable these nodes from being block providers (in much the same way that non-SegWit nodes stop being block providers).\r\n\r\nAlso, #9325 is incredibly simple - only 2 lines deleted - the only thing missing that I would propose adding is some logic to restrict how many blocktxns it is allowed to request (currently the worst case scenario is that it can request one for every cmpctblock received - which is limited to 3).",
      "created_at" : "2016-12-15T05:51:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267245052",
      "id" : 267245052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-15T06:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267245052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad Responded in #9325 about some of the issues with that patch.",
      "created_at" : "2016-12-15T15:32:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267356744",
      "id" : 267356744,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-15T15:32:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267356744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Testing.",
      "created_at" : "2016-12-15T18:16:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267400479",
      "id" : 267400479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-15T18:16:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267400479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9352#discussion_r92820948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9352"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/92820948"
         }
      },
      "body" : "This appears to be a novel use of `fForceProcessing`(not non-network nor whitelist peer), might want to note that in the argument description.",
      "commit_id" : "813ede91e12dd777faee60f6286a9ed5bb72761a",
      "created_at" : "2016-12-16T14:34:46Z",
      "diff_hunk" : "@@ -1889,6 +1911,29 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n                 return ProcessMessage(pfrom, NetMsgType::HEADERS, vHeadersMsg, nTimeReceived, chainparams, connman);\n             }\n         }\n+\n+        if (fBlockReconstructed) {\n+            // If we got here, we were able to optimistically reconstruct a\n+            // block that is in flight from some other peer.\n+            {\n+                LOCK(cs_main);\n+                mapBlockSource.emplace(pblock->GetHash(), std::make_pair(pfrom->GetId(), false));\n+            }\n+            bool fNewBlock = false;\n+            ProcessNewBlock(chainparams, pblock, true, &fNewBlock);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#discussion_r92820948",
      "id" : 92820948,
      "original_commit_id" : "813ede91e12dd777faee60f6286a9ed5bb72761a",
      "original_position" : 49,
      "path" : "src/net_processing.cpp",
      "position" : 49,
      "pull_request_review_id" : 13343287,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9352",
      "updated_at" : "2016-12-16T14:34:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/92820948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "utACK 7017298eb2c72e262b865cd417d6844bcdd14a3f",
      "created_at" : "2016-12-16T14:35:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267606638",
      "id" : 267606638,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-16T14:35:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267606638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9352#discussion_r92917879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9352"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/92917879"
         }
      },
      "body" : "The documentation is just flat out wrong, it seems. fForceProcessing means \"make sure to store this to disk, we decided we wanted to request this block for some reason, so probably want it no matter what validation.cpp thinks\". Indeed, the use here is slightly different from elsewhere, but given that we already check for blocks which do not mesh with our idea of the best chain further up, and that we will only get here if the block was within two blocks of our tip, I'm pretty confident this is the right use.",
      "commit_id" : "813ede91e12dd777faee60f6286a9ed5bb72761a",
      "created_at" : "2016-12-17T08:19:40Z",
      "diff_hunk" : "@@ -1889,6 +1911,29 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n                 return ProcessMessage(pfrom, NetMsgType::HEADERS, vHeadersMsg, nTimeReceived, chainparams, connman);\n             }\n         }\n+\n+        if (fBlockReconstructed) {\n+            // If we got here, we were able to optimistically reconstruct a\n+            // block that is in flight from some other peer.\n+            {\n+                LOCK(cs_main);\n+                mapBlockSource.emplace(pblock->GetHash(), std::make_pair(pfrom->GetId(), false));\n+            }\n+            bool fNewBlock = false;\n+            ProcessNewBlock(chainparams, pblock, true, &fNewBlock);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#discussion_r92917879",
      "id" : 92917879,
      "original_commit_id" : "813ede91e12dd777faee60f6286a9ed5bb72761a",
      "original_position" : 49,
      "path" : "src/net_processing.cpp",
      "position" : 49,
      "pull_request_review_id" : 13443233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9352",
      "updated_at" : "2016-12-17T08:19:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/92917879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "utACK 813ede91e12dd777faee60f6286a9ed5bb72761a",
      "created_at" : "2016-12-17T08:23:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267750270",
      "id" : 267750270,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-17T08:23:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267750270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "ACK. Appears to be highly effective on mainnet too.",
      "created_at" : "2016-12-17T21:08:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267787003",
      "id" : 267787003,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-17T21:08:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267787003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "utACK 7017298eb2c72e262b865cd417d6844bcdd14a3f",
      "created_at" : "2016-12-19T05:19:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267884196",
      "id" : 267884196,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-19T05:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267884196",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "This was backported in #9357",
      "created_at" : "2016-12-19T08:02:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-267903886",
      "id" : 267903886,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-19T08:02:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267903886",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "posthumous utACK",
      "created_at" : "2016-12-19T16:46:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9352#issuecomment-268014098",
      "id" : 268014098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9352",
      "updated_at" : "2016-12-19T16:46:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268014098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   }
]
