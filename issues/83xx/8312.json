{
   "assignee" : null,
   "assignees" : [],
   "body" : "~~Fixes #8279~~\r\n\r\nIn addition to the problem highlighted in that issue, there's an additional, related problem in the sigops policy check.  Because witness sigops are counted without checking that the witness program matches the commitment in the scriptPubKey being spent, it's possible to change a transaction's witness to cause the sigops policy check to fail, without changing the txid.\r\n\r\nSimilarly, because the bytes-per-sigop check is affected by the size of the transaction including the witness, it's possible to even remove a witness and cause that sigops check to fail, again without changing the txid.\r\n\r\n~~So this PR does the following:~~\r\n- ~~Moves the IsStandard check to happen after checking for premature-witness.  (This should prevent the bug reported in #8279 from possibly affecting 0.13.0 nodes, which should never accept witness transactions.)~~\r\n- ~~Changes IsStandard to set a bool which will indicate if the transaction could be malleated, so that the caller can act appropriately.~~\r\n- ~~Reorders the checks in IsStandard so that the size check is performed last, and sets the could-be-malleated bool if the test fails.~~\r\n- ~~Changes the error for sigops failure to always set the could-be-malleated flag.~~\r\n- ~~Adds tests to p2p-segwit.py to catch both scenarios.~~\r\n",
   "closed_at" : "2016-07-14T06:21:28Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8312/comments",
   "created_at" : "2016-07-07T01:48:28Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8312/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/8312",
   "id" : 164212127,
   "labels" : [
      {
         "color" : "006b75",
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8312/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 37,
      "created_at" : "2015-12-03T11:07:58Z",
      "creator" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      },
      "description" : "",
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestones/0.13.0",
      "id" : 1441894,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/20/labels",
      "number" : 20,
      "open_issues" : 10,
      "state" : "open",
      "title" : "0.13.0",
      "updated_at" : "2016-07-14T06:21:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/20"
   },
   "number" : 8312,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/8312.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8312",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/8312.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8312"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Fix mempool DoS vulnerability from malleated transactions",
   "updated_at" : "2016-07-14T06:21:29Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8312",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
      "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sdaftuar/followers",
      "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sdaftuar",
      "id" : 7463573,
      "login" : "sdaftuar",
      "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
      "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
      "repos_url" : "https://api.github.com/users/sdaftuar/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sdaftuar"
   }
}
