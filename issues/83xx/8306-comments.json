[
   {
      "body" : "I observed a testnet node persistently stuck (even across restarts) in a case where its best header chain was invalid and the public network has a best valid chain with much more work than the invalid best header chain that I have, but it took more than one headers message to connect it.\r\n\r\nSuhas identified this PR as the probable cause, and on revert the node immediately became unstuck. Considering how near we are to release, I think simply reverting this is the right action currently. The issue it was fixing should have been rare and largely inconsequential on the Bitcoin network.",
      "created_at" : "2016-07-05T20:50:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-230599035",
      "id" : 230599035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-05T20:50:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/230599035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "utACK.  We should tag this for 0.13.0.",
      "created_at" : "2016-07-05T22:07:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-230617290",
      "id" : 230617290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-05T22:07:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/230617290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "I ran into this problem, this fixed it.",
      "created_at" : "2016-07-05T23:28:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-230632503",
      "id" : 230632503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-05T23:28:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/230632503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "I've run into at least two people on IRC with this issue (in addition to Patrick).",
      "created_at" : "2016-07-06T03:30:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-230662871",
      "id" : 230662871,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-06T03:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/230662871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Even if the issue my original patch fixed is rare in practice, I would like to see it fixed.  I understand that it is best to roll the change back after finding the issue now before the upcoming release, though.  Can I open an issue to track a \"fixed fix\" for 0.14?  Also, I do not yet fully understand how a node could become stuck with the patch even if it is on an invalid chain.  Does anyone have a good explanation for what the issue is exactly?",
      "created_at" : "2016-07-09T11:55:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-231530775",
      "id" : 231530775,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-09T11:55:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/231530775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "@domob1812  One example: before reverting this patch, if there are two competing forks with tips A and B, and a node is at tip A and the fork point C between A and B is more than 2000 blocks in the past, and a node already has the first 2000 headers from C to B but no later ones, then it's possible that the hasHeaders check added by #8054 would prevent the node from ever learning about tip B, causing chain sync to fail.",
      "created_at" : "2016-07-10T11:38:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-231584578",
      "id" : 231584578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-13T16:17:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/231584578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Thanks @sdaftuar, makes sense.  I'll think about it.",
      "created_at" : "2016-07-13T16:15:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8306#issuecomment-232406467",
      "id" : 232406467,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8306",
      "updated_at" : "2016-07-13T16:15:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/232406467",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   }
]
