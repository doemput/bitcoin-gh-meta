[
   {
      "body" : "Concept ACK, but I'm concerned about defining a `wait_until` in util.py, when there's already a `wait_until` defined in mininode.py. This is a problem since wildcard imports are used in a lot of tests, so behavior will be unpredictable.",
      "created_at" : "2017-08-16T15:57:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#issuecomment-322818043",
      "id" : 322818043,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11067",
      "updated_at" : "2017-08-16T15:58:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322818043",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Rebase on #11068?",
      "created_at" : "2017-08-17T17:52:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#issuecomment-323146652",
      "id" : 323146652,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11067",
      "updated_at" : "2017-08-17T17:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323146652",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Looks great. Tested ACK fa7d395048c9395bbf23439c2986751db560aa8b",
      "created_at" : "2017-08-24T13:19:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#issuecomment-324632533",
      "id" : 324632533,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11067",
      "updated_at" : "2017-08-24T13:19:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324632533",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Solved merge conflict fa7d39504 ... fa72a0011",
      "created_at" : "2017-08-24T20:28:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#issuecomment-324747998",
      "id" : 324747998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11067",
      "updated_at" : "2017-08-24T20:28:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324747998",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r135295391"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135295391"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this method should also set `self.rpc` to None",
      "commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-08-25T16:04:58Z",
      "diff_hunk" : "@@ -121,25 +124,27 @@ def is_node_stopped(self):\n         if not self.running:\n             return True\n         return_code = self.process.poll()\n-        if return_code is not None:\n-            # process has stopped. Assert that it didn't return an error code.\n-            assert_equal(return_code, 0)\n-            self.running = False\n-            self.process = None\n-            self.log.debug(\"Node stopped\")\n-            return True\n-        return False\n+        if return_code is None:\n+            return False\n+\n+        # process has stopped. Assert that it didn't return an error code.\n+        assert_equal(return_code, 0)\n+        self.running = False\n+        self.process = None\n+        self.rpc_connected = False",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r135295391",
      "id" : 135295391,
      "original_commit_id" : "fa72a0011bead99f60e6442b79ddad407d3a3df2",
      "original_position" : 32,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 32,
      "pull_request_review_id" : 58696066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067",
      "updated_at" : "2017-09-06T16:41:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135295391",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137323565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137323565"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jnewbery Done",
      "commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-09-06T16:42:10Z",
      "diff_hunk" : "@@ -121,25 +124,27 @@ def is_node_stopped(self):\n         if not self.running:\n             return True\n         return_code = self.process.poll()\n-        if return_code is not None:\n-            # process has stopped. Assert that it didn't return an error code.\n-            assert_equal(return_code, 0)\n-            self.running = False\n-            self.process = None\n-            self.log.debug(\"Node stopped\")\n-            return True\n-        return False\n+        if return_code is None:\n+            return False\n+\n+        # process has stopped. Assert that it didn't return an error code.\n+        assert_equal(return_code, 0)\n+        self.running = False\n+        self.process = None\n+        self.rpc_connected = False",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137323565",
      "id" : 137323565,
      "in_reply_to_id" : 135295391,
      "original_commit_id" : "fa72a0011bead99f60e6442b79ddad407d3a3df2",
      "original_position" : 32,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 32,
      "pull_request_review_id" : 60975394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067",
      "updated_at" : "2017-09-06T16:42:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137323565",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137329727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137329727"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This constant is now only used in one place. Perhaps remove it as a constant and add it as an integer literal in the definition of `wait_until_stopped()` with a comment.\r\n\r\nIf not, perhaps move this constant assignment down to just above the call to `wait_until_stopped()`",
      "commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-09-06T17:04:16Z",
      "diff_hunk" : "@@ -17,9 +17,12 @@\n     assert_equal,\n     get_rpc_proxy,\n     rpc_url,\n+    wait_until,\n )\n from .authproxy import JSONRPCException\n \n+BITCOIND_PROC_WAIT_TIMEOUT = 60",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137329727",
      "id" : 137329727,
      "original_commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "original_position" : 8,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 8,
      "pull_request_review_id" : 60982299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067",
      "updated_at" : "2017-09-06T17:04:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137329727",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137330456"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137330456"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I prefer to put constants at the top of a file and my personal taste is that it is ugly to place them between or inside methods/functions. ",
      "commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-09-06T17:07:17Z",
      "diff_hunk" : "@@ -17,9 +17,12 @@\n     assert_equal,\n     get_rpc_proxy,\n     rpc_url,\n+    wait_until,\n )\n from .authproxy import JSONRPCException\n \n+BITCOIND_PROC_WAIT_TIMEOUT = 60",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137330456",
      "id" : 137330456,
      "in_reply_to_id" : 137329727,
      "original_commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "original_position" : 8,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 8,
      "pull_request_review_id" : 60983142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067",
      "updated_at" : "2017-09-06T17:07:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137330456",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137343836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137343836"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's reasonable",
      "commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-09-06T17:58:54Z",
      "diff_hunk" : "@@ -17,9 +17,12 @@\n     assert_equal,\n     get_rpc_proxy,\n     rpc_url,\n+    wait_until,\n )\n from .authproxy import JSONRPCException\n \n+BITCOIND_PROC_WAIT_TIMEOUT = 60",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#discussion_r137343836",
      "id" : 137343836,
      "in_reply_to_id" : 137329727,
      "original_commit_id" : "faa8d9581affde35a8242c63fca8a52004d4f943",
      "original_position" : 8,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 8,
      "pull_request_review_id" : 60998433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11067",
      "updated_at" : "2017-09-06T17:58:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137343836",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK faa8d9581affde35a8242c63fca8a52004d4f943",
      "created_at" : "2017-09-06T17:59:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11067#issuecomment-327564642",
      "id" : 327564642,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11067",
      "updated_at" : "2017-09-06T17:59:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327564642",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
