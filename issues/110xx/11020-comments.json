[
   {
      "body" : "Not sure why `zapwallettxes.py` is failing. It's not touching anything I changed (and the test passes on my fork's travis & when running the test locally / via `make check` ...). @jnewbery thoughts?",
      "created_at" : "2017-08-10T09:06:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-321495466",
      "id" : 321495466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-10T09:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321495466",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "The zapwallettxes' failure is intermittent. Respinned travis.",
      "created_at" : "2017-08-10T09:36:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-321502374",
      "id" : 321502374,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-10T09:36:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321502374",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "I'd hoped that #10330 had fixed the zapwallettxes intermittency. @MarcoFalke do you have an example of it failing (the failure on this PR is no longer available since the task was restarted in Travis).\r\n\r\n(apologies for being off-topic)",
      "created_at" : "2017-08-10T15:39:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-321589503",
      "id" : 321589503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-10T15:39:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321589503",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "@jnewbery Sorry I didn't keep track of the exact failure this time, I assume it was one of the known issues that popped up recently.",
      "created_at" : "2017-08-10T20:03:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-321658473",
      "id" : 321658473,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-10T20:03:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321658473",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132804998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132804998"
         }
      },
      "body" : "Nit, snake case.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-12T00:37:55Z",
      "diff_hunk" : "@@ -940,7 +940,7 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n     void ResendWalletTransactions(int64_t nBestBlockTime, CConnman* connman) override;\n     // ResendWalletTransactionsBefore may only be called if fBroadcastTransactions!\n     std::vector<uint256> ResendWalletTransactionsBefore(int64_t nTime, CConnman* connman);\n-    CAmount GetBalance() const;\n+    CAmount GetBalance(bool ignoreUnspendable = true) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132804998",
      "id" : 132804998,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 14,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 55930842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132804998",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805003"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805003"
         }
      },
      "body" : "Nit, snake case.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-12T00:38:00Z",
      "diff_hunk" : "@@ -465,7 +465,7 @@ class CWalletTx : public CMerkleTx\n     bool IsEquivalentTo(const CWalletTx& tx) const;\n \n     bool InMempool() const;\n-    bool IsTrusted() const;\n+    bool IsTrusted(bool ignoreUnspendable = true) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805003",
      "id" : 132805003,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 55930842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805003",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805193"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805193"
         }
      },
      "body" : "Assert exact value?",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-12T00:42:55Z",
      "diff_hunk" : "@@ -392,6 +392,8 @@ def run_test(self):\n         extra_txid = self.nodes[0].sendtoaddress(sending_addr, Decimal('0.0001'))\n         assert(extra_txid not in self.nodes[0].getrawmempool())\n         assert(extra_txid in [tx[\"txid\"] for tx in self.nodes[0].listtransactions()])\n+        # The change output for extra_txid should be in the balance if we include unspendable\n+        assert(self.nodes[0].getbalance() < self.nodes[0].getbalance(include_unspendable=True))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805193",
      "id" : 132805193,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "test/functional/wallet.py",
      "position" : null,
      "pull_request_review_id" : 55930842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805193",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805271"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805271"
         }
      },
      "body" : "Nit, snake case.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-12T00:44:34Z",
      "diff_hunk" : "@@ -1823,7 +1823,7 @@ bool CWalletTx::InMempool() const\n     return mempool.exists(GetHash());\n }\n \n-bool CWalletTx::IsTrusted() const\n+bool CWalletTx::IsTrusted(bool ignoreUnspendable) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805271",
      "id" : 132805271,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 55930842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805271",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805796"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805796"
         }
      },
      "body" : "Update comment.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-12T00:59:24Z",
      "diff_hunk" : "@@ -1837,7 +1837,7 @@ bool CWalletTx::IsTrusted() const\n         return false;\n \n     // Don't trust unconfirmed transactions from us unless they are in the mempool.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132805796",
      "id" : 132805796,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 55930842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132805796",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132976907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132976907"
         }
      },
      "body" : "I think this argument name is a bit confusing. Perhaps `include_not_yet_spendable`. It's a bit of a mouthful, but 'unspendable' sounds too permanent to me.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-14T15:11:54Z",
      "diff_hunk" : "@@ -755,6 +755,8 @@ UniValue getbalance(const JSONRPCRequest& request)\n             \"                     avoid passing this argument.\\n\"\n             \"2. minconf           (numeric, optional, default=1) Only include transactions confirmed at least this many times.\\n\"\n             \"3. include_watchonly (bool, optional, default=false) Also include balance in watch-only addresses (see 'importaddress')\\n\"\n+            \"4. include_unspendable (bool, optional, default=false) Also include balance for UTXOs which are currently not (but\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132976907",
      "id" : 132976907,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 16,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56108066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132976907",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132978397"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132978397"
         }
      },
      "body" : "This is confusing for me. `include_unspendable` only has effect if:\r\n\r\n- `account` is not specified; and\r\n- `minconf` is not specified; and\r\n- `include_watchonly` is not specified\r\n\r\nAdditionally, if `account` is specified as `\"\"` (ie balance not associated with any account), the returned balance will use `GetBalance()` if `include_unspendable` is not set, but `GetLegacyBalance()` if it is set.\r\n\r\nCan you explain the reasoning here?",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-14T15:17:22Z",
      "diff_hunk" : "@@ -768,8 +770,10 @@ UniValue getbalance(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    if (request.params.size() == 0)\n-        return  ValueFromAmount(pwallet->GetBalance());\n+    bool ignoreUnspendable = request.params[3].isNull() || !request.params[3].get_bool();\n+    if ((request.params[0].isNull() || (request.params[0].get_str() == \"\" && !ignoreUnspendable)) && request.params[1].isNull() && request.params[2].isNull()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132978397",
      "id" : 132978397,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 28,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56108066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132978397",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132978623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132978623"
         }
      },
      "body" : "I find it confusing that the API uses `include_unspendable`, but internally you use `ignoreUnspendable` which is the inverse. Any reason not to be consistent?",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-14T15:18:13Z",
      "diff_hunk" : "@@ -768,8 +770,10 @@ UniValue getbalance(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    if (request.params.size() == 0)\n-        return  ValueFromAmount(pwallet->GetBalance());\n+    bool ignoreUnspendable = request.params[3].isNull() || !request.params[3].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132978623",
      "id" : 132978623,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 27,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56108066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132978623",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132979387"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132979387"
         }
      },
      "body" : "Asserting on exact values can make the test more brittle. I think it's fine to test strict lesser than here.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-14T15:20:48Z",
      "diff_hunk" : "@@ -392,6 +392,8 @@ def run_test(self):\n         extra_txid = self.nodes[0].sendtoaddress(sending_addr, Decimal('0.0001'))\n         assert(extra_txid not in self.nodes[0].getrawmempool())\n         assert(extra_txid in [tx[\"txid\"] for tx in self.nodes[0].listtransactions()])\n+        # The change output for extra_txid should be in the balance if we include unspendable\n+        assert(self.nodes[0].getbalance() < self.nodes[0].getbalance(include_unspendable=True))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132979387",
      "id" : 132979387,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "test/functional/wallet.py",
      "position" : null,
      "pull_request_review_id" : 56108066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132979387",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132979704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132979704"
         }
      },
      "body" : "Again, I think the name `ignoreUnspendable` could be made clearer.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-14T15:21:54Z",
      "diff_hunk" : "@@ -1823,7 +1823,7 @@ bool CWalletTx::InMempool() const\n     return mempool.exists(GetHash());\n }\n \n-bool CWalletTx::IsTrusted() const\n+bool CWalletTx::IsTrusted(bool ignoreUnspendable) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r132979704",
      "id" : 132979704,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56108066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132979704",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133101706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133101706"
         }
      },
      "body" : "Not sure what you mean -- most other argument names are written in this style, e.g. redeemScript, mapKeyBirth, etc.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T01:37:10Z",
      "diff_hunk" : "@@ -465,7 +465,7 @@ class CWalletTx : public CMerkleTx\n     bool IsEquivalentTo(const CWalletTx& tx) const;\n \n     bool InMempool() const;\n-    bool IsTrusted() const;\n+    bool IsTrusted(bool ignoreUnspendable = true) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133101706",
      "id" : 133101706,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 56246240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133101706",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102025"
         }
      },
      "body" : "I was hoping the description of the argument would alleviate that, but you may be right.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T01:40:28Z",
      "diff_hunk" : "@@ -755,6 +755,8 @@ UniValue getbalance(const JSONRPCRequest& request)\n             \"                     avoid passing this argument.\\n\"\n             \"2. minconf           (numeric, optional, default=1) Only include transactions confirmed at least this many times.\\n\"\n             \"3. include_watchonly (bool, optional, default=false) Also include balance in watch-only addresses (see 'importaddress')\\n\"\n+            \"4. include_unspendable (bool, optional, default=false) Also include balance for UTXOs which are currently not (but\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102025",
      "id" : 133102025,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 16,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56246580,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102025",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102078"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102078"
         }
      },
      "body" : "It ended up that way. You're right, will fix.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T01:41:05Z",
      "diff_hunk" : "@@ -768,8 +770,10 @@ UniValue getbalance(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    if (request.params.size() == 0)\n-        return  ValueFromAmount(pwallet->GetBalance());\n+    bool ignoreUnspendable = request.params[3].isNull() || !request.params[3].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102078",
      "id" : 133102078,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 27,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56246634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102078",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102309"
         }
      },
      "body" : "The argument is the last in the list, and there's no way to give a default value for `account` because it's not being JSON parsed (you can't pass \"null\" as it would become the string \"null\"). Using named arguments, you can do this, but otherwise I have to make the \"special case\" of you passing defaults in.\r\n\r\nThe legacy balance seems to not be very used and possibly even about to be deprecated, so I didn't feel the need to update it. That, and it already kind of does what the PR is doing when you do a 0 `minconf` and `account=\"*\"`.\r\n",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T01:43:40Z",
      "diff_hunk" : "@@ -768,8 +770,10 @@ UniValue getbalance(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    if (request.params.size() == 0)\n-        return  ValueFromAmount(pwallet->GetBalance());\n+    bool ignoreUnspendable = request.params[3].isNull() || !request.params[3].get_bool();\n+    if ((request.params[0].isNull() || (request.params[0].get_str() == \"\" && !ignoreUnspendable)) && request.params[1].isNull() && request.params[2].isNull()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133102309",
      "id" : 133102309,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 28,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56246861,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133102309",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133103187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133103187"
         }
      },
      "body" : "> Asserting on exact values can make the test more brittle.\r\n\r\nIs that a bad thing?",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T01:53:11Z",
      "diff_hunk" : "@@ -392,6 +392,8 @@ def run_test(self):\n         extra_txid = self.nodes[0].sendtoaddress(sending_addr, Decimal('0.0001'))\n         assert(extra_txid not in self.nodes[0].getrawmempool())\n         assert(extra_txid in [tx[\"txid\"] for tx in self.nodes[0].listtransactions()])\n+        # The change output for extra_txid should be in the balance if we include unspendable\n+        assert(self.nodes[0].getbalance() < self.nodes[0].getbalance(include_unspendable=True))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133103187",
      "id" : 133103187,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "test/functional/wallet.py",
      "position" : null,
      "pull_request_review_id" : 56247799,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133103187",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@promag @jnewbery Thanks for the review!\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/11020/commits/28e8271424b8642e825889bfaa8e51ae6a2a60dd fixes comment\r\n* https://github.com/bitcoin/bitcoin/pull/11020/commits/df7228d5dec184c92f7190265afb2c380da0a9ae fixes the inconsistency in variable names, but currently retains the `include_unspendable` name. I'm not sure I agree with the longer version @jnewbery suggested, but I'm up for changing this to something more intuitive if people feel it's worthwhile.\r\n* https://github.com/bitcoin/bitcoin/pull/11020/commits/80acc02b0e77791605eb8f0cb20263986ea87399 adds the feature to `getunconfirmedbalance` (tested in https://github.com/bitcoin/bitcoin/pull/11020/commits/36423983a1b1a473151056bb5d4e3159975c9b18). I was not entirely sure about the logic on this one, but I went with `!IsTrusted() & depth=0 & (includeUnspendable || InMempool())`, changed from `!IsTrusted() & depth=0 & InMempool()`. This means some balance will overlap between `getbalance(include_unspendable=true)` and `getunconfirmedbalance(include_unspendable=true)` but I think that's ok.\r\n",
      "created_at" : "2017-08-15T02:27:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-322360378",
      "id" : 322360378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-15T02:27:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322360378",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133111389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133111389"
         }
      },
      "body" : "It's bad if the test will intermittently fail for unrelated reasons (rounding errors, for example).",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T03:38:32Z",
      "diff_hunk" : "@@ -392,6 +392,8 @@ def run_test(self):\n         extra_txid = self.nodes[0].sendtoaddress(sending_addr, Decimal('0.0001'))\n         assert(extra_txid not in self.nodes[0].getrawmempool())\n         assert(extra_txid in [tx[\"txid\"] for tx in self.nodes[0].listtransactions()])\n+        # The change output for extra_txid should be in the balance if we include unspendable\n+        assert(self.nodes[0].getbalance() < self.nodes[0].getbalance(include_unspendable=True))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133111389",
      "id" : 133111389,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "test/functional/wallet.py",
      "position" : null,
      "pull_request_review_id" : 56256562,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133111389",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133196962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133196962"
         }
      },
      "body" : "I find it surprising that `minconf` and `watchonly` only have effect if account is specified, and now `include_unspendable` only has effect if account is not specified. There doesn't appear to be any user documentation explaining that.\r\n\r\nI'm afraid I don't know the history or motivation for that. @ryanofsky made changes in this area recently. Perhaps he can shed light on this.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-15T14:02:31Z",
      "diff_hunk" : "@@ -768,8 +770,10 @@ UniValue getbalance(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    if (request.params.size() == 0)\n-        return  ValueFromAmount(pwallet->GetBalance());\n+    bool ignoreUnspendable = request.params[3].isNull() || !request.params[3].get_bool();\n+    if ((request.params[0].isNull() || (request.params[0].get_str() == \"\" && !ignoreUnspendable)) && request.params[1].isNull() && request.params[2].isNull()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133196962",
      "id" : 133196962,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 28,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56348991,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133196962",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "zapwallettxes.py again, @jnewbery: https://pastebin.com/70bQ7CLq",
      "created_at" : "2017-08-16T05:21:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-322669077",
      "id" : 322669077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-16T05:21:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322669077",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133457898"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133457898"
         }
      },
      "body" : "That should not happen. There are lots of exact asserts through out this file.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-16T14:01:30Z",
      "diff_hunk" : "@@ -392,6 +392,8 @@ def run_test(self):\n         extra_txid = self.nodes[0].sendtoaddress(sending_addr, Decimal('0.0001'))\n         assert(extra_txid not in self.nodes[0].getrawmempool())\n         assert(extra_txid in [tx[\"txid\"] for tx in self.nodes[0].listtransactions()])\n+        # The change output for extra_txid should be in the balance if we include unspendable\n+        assert(self.nodes[0].getbalance() < self.nodes[0].getbalance(include_unspendable=True))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133457898",
      "id" : 133457898,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 5,
      "path" : "test/functional/wallet.py",
      "position" : null,
      "pull_request_review_id" : 56640065,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133457898",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133458346"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133458346"
         }
      },
      "body" : "Also, please align other arguments as this is currently the longest.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-16T14:03:03Z",
      "diff_hunk" : "@@ -755,6 +755,8 @@ UniValue getbalance(const JSONRPCRequest& request)\n             \"                     avoid passing this argument.\\n\"\n             \"2. minconf           (numeric, optional, default=1) Only include transactions confirmed at least this many times.\\n\"\n             \"3. include_watchonly (bool, optional, default=false) Also include balance in watch-only addresses (see 'importaddress')\\n\"\n+            \"4. include_unspendable (bool, optional, default=false) Also include balance for UTXOs which are currently not (but\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133458346",
      "id" : 133458346,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 16,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56640618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133458346",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "IMO from the wallet point of view those UTXO should always be part of the balance, and in that case this should be a bug fix and not require more options. WDYT?\r\n\r\nEdit: unless `getbalance` defaults to available balance. If that's the case the option can be `include_unavailable` (default false) or `only_available` (default true).",
      "created_at" : "2017-08-16T14:18:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-322786328",
      "id" : 322786328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-16T14:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322786328",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "Yes `getbalance` is available balance, I think, so I don't think it should default to including these. Of course, there is the option of making the coin select include these coins even though they're not in the mempool, in which case `getbalance` could include them, but that's for another time (and PR).\r\n\r\nHm, `include_unavailable` seems like a better name for it than `include_unspendable`.",
      "created_at" : "2017-08-17T05:12:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#issuecomment-322970593",
      "id" : 322970593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11020",
      "updated_at" : "2017-08-17T05:12:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322970593",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133624848"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133624848"
         }
      },
      "body" : "Actually, `include_watchonly` is slightly longer, but I think realigning is a good idea yeah.",
      "commit_id" : "28120484acfb40d6027a3be320890cc6dc2ffc9c",
      "created_at" : "2017-08-17T05:16:02Z",
      "diff_hunk" : "@@ -755,6 +755,8 @@ UniValue getbalance(const JSONRPCRequest& request)\n             \"                     avoid passing this argument.\\n\"\n             \"2. minconf           (numeric, optional, default=1) Only include transactions confirmed at least this many times.\\n\"\n             \"3. include_watchonly (bool, optional, default=false) Also include balance in watch-only addresses (see 'importaddress')\\n\"\n+            \"4. include_unspendable (bool, optional, default=false) Also include balance for UTXOs which are currently not (but\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11020#discussion_r133624848",
      "id" : 133624848,
      "original_commit_id" : "5b644c85b725b11fd44d0412868023419b06492b",
      "original_position" : 16,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 56826673,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11020",
      "updated_at" : "2017-08-17T05:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133624848",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
