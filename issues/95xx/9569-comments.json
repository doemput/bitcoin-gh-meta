[
   {
      "body" : "Whitelisted peers can still relay transactions for blocksonly, I suspect this would break that. (FWIW I don't like that whitelisting does stuff like that, but its what it does and people depend on it)",
      "created_at" : "2017-01-17T23:48:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273338305",
      "id" : 273338305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-17T23:49:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273338305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "The intended behavior is for nodes in blocks only mode to have a mempool\nbecause of whitelisted peers.\n\nNACK\n\nOn Jan 17, 2017 4:48 PM, \"Gregory Maxwell\" <notifications@github.com> wrote:\n\n> Whitelisted peers can still relay transactions for blocksonly, I suspect\n> this would break that.\n>\n> Ã¢ÂÂ\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273338305>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAl4QxnJy-KrmMlFU_e6Trkgj7BTg3alks5rTVNRgaJpZM4LmBxS>\n> .\n>\n",
      "created_at" : "2017-01-18T16:06:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273517910",
      "id" : 273517910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-18T16:06:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273517910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Interesting, I was not aware.\n\nHow do we reconcile these things? Someone without whitelisted peers who\nsets -blocksonly will not have a mempool, and can reasonably expect that\nthere won't ne an extra 300 MB added to their dbcache.\n\nEven in cases where whitelisted peers exist, I doubt a full 300 MB (if\n-maxmempool was not changed) will be used in commom cases.\n\nMaybe -blocksonly should just disable the mempool/dbcache share, as\nwhatever mempool remains under these circumstances can't be a typical\nalways-full mempool?\n",
      "created_at" : "2017-01-18T16:12:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273519754",
      "id" : 273519754,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-18T16:12:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273519754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@gmaxwell @pstratem Thank you. I wasn't aware of this behaviour.\r\n\r\nAs far as I can tell, this can only happen to a -blocksonly node as follows:\r\n\r\n- the node connects to a peer and sends a version message. The 'relay' field is set to FALSE (see  PushNodeVersion() in net_processing.cpp - bitcoin core *always* sets relay to FALSE if -blocksonly is set since the global fRelayTxes = !blocksonly).\r\n- the peer disregards the relay field. Note that bitcoin core respects the relay field that it receives (see  ProcessMessage() in net_processing.cpp.\r\n- the peer sends INVs/TXs, which the node accepts because -whitelistrelay is set.\r\n\r\nso this can *only* happen if the node is connecting to a non-bitcoin-core peer which is disregarding the semantics of the relay field in the version message.\r\n\r\n@gmaxwell @pstratem can you give some use cases? Are people relying on this behaviour?",
      "created_at" : "2017-01-18T19:03:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273568508",
      "id" : 273568508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-18T19:03:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273568508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Transaction relay to whitelisted peers ignores fRelay\n\nOn Jan 18, 2017 12:03 PM, \"John Newbery\" <notifications@github.com> wrote:\n\n> @gmaxwell <https://github.com/gmaxwell> @pstratem\n> <https://github.com/pstratem> Thank you. I wasn't aware of this behaviour.\n>\n> As far as I can tell, this can only happen to a -blocksonly node as\n> follows:\n>\n>    - the node connects to a peer and sends a version message. The 'relay'\n>    field is set to FALSE (see PushNodeVersion() in net_processing.cpp -\n>    bitcoin core *always* sets relay to FALSE if -blocksonly is set since\n>    the global fRelayTxes = !blocksonly).\n>    - the peer disregards the relay field. Note that bitcoin core respects\n>    the relay field that it receives (see ProcessMessage() in\n>    net_processing.cpp.\n>    - the peer sends INVs/TXs, which the node accepts because\n>    -whitelistrelay is set.\n>\n> so this can *only* happen if the node is connecting to a non-bitcoin-core\n> peer which is disregarding the semantics of the relay field in the version\n> message.\n>\n> @gmaxwell <https://github.com/gmaxwell> @pstratem\n> <https://github.com/pstratem> can you give some use cases? Are people\n> relying on this behaviour?\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273568508>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAl4Q4_0uz6blDzMpNtW2J0BGQrbL7XMks5rTmIEgaJpZM4LmBxS>\n> .\n>\n",
      "created_at" : "2017-01-18T23:46:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273638503",
      "id" : 273638503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-18T23:46:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273638503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@pstratem Maybe I'm misunderstanding, but I would expect the only way for transactions to enter the node's mempool is for transactions to be relayed *from* peers. That can't happen if blocksonly is set, unless that peer is violating the relay field in our version message.\r\n\r\nOf course, we can send transactions *to* peers. That's true without a mempool, and is unaffected by this PR.\r\n\r\nYou seem to understand this better than me - can you explain where I'm wrong.",
      "created_at" : "2017-01-19T00:20:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273644406",
      "id" : 273644406,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-19T00:20:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273644406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Somewhat unrelated to the discussion here, but I've been meaning to get rid of the fRelayTxes global for a while. I just hacked this up, and I think it makes reasoning about this much easier: https://github.com/theuni/bitcoin/commit/f1966109d17035b814a03599e5f222825056457a .\r\n\r\nIt was done quickly and probably isn't quite right, but I'll clean it up and PR separately if the approach is agreed upon.",
      "created_at" : "2017-01-19T01:39:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273657351",
      "id" : 273657351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-19T01:39:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273657351",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni I agree that we should get rid of the global to make reasoning easier. I also think we need additional documentation here to make the intended behaviour more explicit (ie that blocksonly doesn't mean only blocks if you have some other setting!).\r\n\r\nPlease tag me when you have a PR for the relay/accept transactions split so I can review it. I've had a look at https://github.com/theuni/bitcoin/commit/f1966109d17035b814a03599e5f222825056457a and the approach looks generally good.",
      "created_at" : "2017-01-19T15:05:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273799536",
      "id" : 273799536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-19T15:05:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/273799536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Nodes in blocks only mode will accept transactions sent to them.\n\nNodes which have whitelisted a blocks only peer will send them transactions.\n\nThe only way to achieve what you want is to dynamically resize the cache\nbased on available memory.\n\nOn Jan 18, 2017 5:20 PM, \"John Newbery\" <notifications@github.com> wrote:\n\n> @pstratem <https://github.com/pstratem> Maybe I'm misunderstanding, but I\n> would expect the only way for transactions to enter the node's mempool is\n> for transactions to be relayed *from* peers. That can't happen if\n> blocksonly is set, unless that peer is violating the relay field in our\n> version message.\n>\n> Of course, we can send transactions *to* peers. That's true without a\n> mempool, and is unaffected by this PR.\n>\n> You seem to understand this better than me - can you explain where I'm\n> wrong.\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273644406>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAl4Q1VKp8FTHJof-6PIhoCxB5JZlROxks5rTqxagaJpZM4LmBxS>\n> .\n>\n",
      "created_at" : "2017-01-21T20:38:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-274286761",
      "id" : 274286761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-21T20:38:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274286761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "> Nodes which have whitelisted a blocks only peer will send them transactions.\r\n\r\nI don't think this is true. When a blocksonly node connects to a peer, it sends the version header with the relay field set to false:\r\n\r\n```\r\n   connman.PushMessage(pnode, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::VERSION, PROTOCOL_VERSION, (uint64_t)nLocalNodeServices, nTime, addrYou, addrMe,\r\n            nonce, strSubVersion, nNodeStartingHeight, ::fRelayTxes));\r\n```\r\n(https://github.com/bitcoin/bitcoin/blob/727a79836035b02e82e31a3c941396146eabc207/src/net_processing.cpp#L258-L259)\r\n\r\nThe peer receives that version message and sets fRelayTxes to false for that CNode. Any whitelist settings are not considered here:\r\n\r\n```\r\n            if (!vRecv.empty())\r\n                vRecv >> pfrom->fRelayTxes; // set to true after we get the first filter* message\r\n```\r\n(https://github.com/bitcoin/bitcoin/blob/727a79836035b02e82e31a3c941396146eabc207/src/net_processing.cpp#L1242-L1243).\r\n\r\nWhen the peer is sending messages to the blocksonly node, it checks the fRelayTxes field and explicitly clears all txs from its INV messages:\r\n\r\n```\r\n    if (!pto->fRelayTxes) pto->setInventoryTxToSend.clear();\r\n```\r\n(https://github.com/bitcoin/bitcoin/blob/727a79836035b02e82e31a3c941396146eabc207/src/net_processing.cpp#L3017)\r\n\r\nI've run some tests locally, and they seem to confirm that bitcoin nodes will not send transactions to blocksonly peers, regardless of whitelist settings.\r\n\r\nFurthermore, setting -blocksonly soft sets -walletbroadcast to false, so the blocksonly node won't even broadcast transactions it originates (which is sensible behaviour - nodes that broadcasts just their own transactions are terrible for transaction privacy).\r\n\r\nIt seems to me that the only ways to get transactions into a blocksonly node's mempool are to:\r\n1. connect to it with a non-compliant node which ignores the relay field in the version message; or\r\n2. explicitly set walletbroadcast to true and give up any transaction privacy.",
      "created_at" : "2017-01-23T18:30:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-274575076",
      "id" : 274575076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-23T18:30:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274575076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Maybe it's easier to just not add the unused mempool space to the available dbcache when blocksonly is set?",
      "created_at" : "2017-01-23T18:50:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-274580542",
      "id" : 274580542,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-23T18:50:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274580542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa - it's certainly true that what you're suggesting is possible. It's the approach that I started with, but changed tack later because it was a far smaller, cleaner code change to simply set mempool size to zero.\r\n\r\nI'm happy to revert to my original approach, but at the very least we should understand and document the behaviour that @pstratem is talking about. From my testing and code-reading, it doesn't seem possible that blocksonly nodes would ever have anything in their mempool. I also don't understand the use-case.",
      "created_at" : "2017-01-23T19:17:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-274588067",
      "id" : 274588067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-23T19:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274588067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Pinging @pstratem @gmaxwell . Can you help me understand what the use case here, so we can either:\r\n- document the blocksonly/whitelist behaviour that you're talking about; or\r\n- move forward with this PR.\r\n\r\nThanks!",
      "created_at" : "2017-01-28T00:46:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-275812385",
      "id" : 275812385,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-28T00:46:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/275812385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Whitelisting was originally added so that armory user's mandatory Bitcoin nodes would still be able to reliably relay transactions when the armory software, which ignores frelaytxes, behind them wanted the transactions relayed.  I have been told that other commercial custom wallet code depend on this whitelist always relays behavior (which is too bad, because I dislike it and think we never should have done it that way).\r\n\r\nThe reason for this is because otherwise if your 'wallet' is implemented as [bitcoin core] - [custom stuff]  there is no way for your custom stuff to implement a rebroadcast like functionality similar to that of the integrated wallet.\r\n\r\nBlocksonly isn't even a document option yet, because it has no servicebits significance so nodes could avoid having all their automatic outbound peers be blocks only and ending up unable to relay transactions. It will be at least one BIP and two releases from being a documented option for that reason (unless the thinking changes), so I really don't think it matters how we handle its memory usage vs dbcache for now.\r\n",
      "created_at" : "2017-01-29T02:54:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-275890237",
      "id" : 275890237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-01-29T02:58:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/275890237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Looks like this is stuck/controversial. I think it's a good point that `-blocksonly` is an \"undocumented\" developer-only option, so interaction with other options isn't very important.\r\nShould we close?",
      "created_at" : "2017-06-26T11:53:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-311037918",
      "id" : 311037918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-06-26T11:53:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311037918",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Yes - closing for now. This should be revisited when blocksonly is made a non-debug option.",
      "created_at" : "2017-06-26T20:18:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-311169979",
      "id" : 311169979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9569",
      "updated_at" : "2017-06-26T20:18:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311169979",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
