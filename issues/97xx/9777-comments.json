[
   {
      "body" : "> I've set MAX_MAX_SIG_CACHE_SIZE absurdly high (16GB) for now, so setting maxsigcachesize to anything unreasonably large will still cause a bad_alloc for most users. Input welcomed on what a more reasonable MAX_MAX_SIG_CACHE_SIZE should be, or whether we should leave it out entirely.\r\n\r\nI'd say that is reasonable. We don't want bad_alloc for negative amounts (which you fixed), but if the user specifies a higher value than available memory then it's what you expect. Even better error handling would catch the bad_alloc and print a friendly error message, but that's overdoing it in this particular case.",
      "created_at" : "2017-02-16T16:06:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280374244",
      "id" : 280374244,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T16:06:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280374244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK e6374a0.\r\n\r\nI would say it'd also be fine to restrict to ~512MB (covers at least a full day of maximum sigop blocks) if you want to be more aggressive about it, but 16GB is fine too.",
      "created_at" : "2017-02-16T18:26:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280415504",
      "id" : 280415504,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T18:26:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280415504",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=3",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "body" : "utACK\n",
      "created_at" : "2017-02-16T19:00:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280425324",
      "id" : 280425324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T19:00:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280425324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "utACK e6374a0\r\n",
      "created_at" : "2017-02-16T20:34:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280451398",
      "id" : 280451398,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T20:34:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280451398",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "utACK e6374a0, perhaps some squashing can be done, at least the first 2 commits. Not a big deal though.",
      "created_at" : "2017-02-16T20:53:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280456696",
      "id" : 280456696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T20:53:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280456696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9777#discussion_r101624082"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9777"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/101624082"
         }
      },
      "body" : "Maybe ```((size_t) 1 << 20)``` could be made a constant/macro, not necessarily in this PR. ",
      "commit_id" : "e6374a03b9869362595acd5cc5e5b8994b244af1",
      "created_at" : "2017-02-16T20:55:01Z",
      "diff_hunk" : "@@ -95,7 +95,7 @@ void InitSignatureCache()\n {\n     // nMaxCacheSize is unsigned. If -maxsigcachesize is set to zero,\n     // setup_bytes creates the minimum possible cache (2 elements).\n-    size_t nMaxCacheSize = std::max((int64_t)0, GetArg(\"-maxsigcachesize\", DEFAULT_MAX_SIG_CACHE_SIZE)) * ((size_t) 1 << 20);\n+    size_t nMaxCacheSize = std::min(std::max((int64_t)0, GetArg(\"-maxsigcachesize\", DEFAULT_MAX_SIG_CACHE_SIZE)), MAX_MAX_SIG_CACHE_SIZE) * ((size_t) 1 << 20);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#discussion_r101624082",
      "id" : 101624082,
      "original_commit_id" : "e6374a03b9869362595acd5cc5e5b8994b244af1",
      "original_position" : 5,
      "path" : "src/script/sigcache.cpp",
      "position" : null,
      "pull_request_review_id" : 22359550,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9777",
      "updated_at" : "2017-02-16T20:55:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/101624082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/9777/commits/e6374a03b9869362595acd5cc5e5b8994b244af1\r\n\r\n`-maxsigcachesize=0` does not result in a crash anymore. Max limit applies (=20000 results in 16384).\r\n\r\n+1 for squashing.\r\n",
      "created_at" : "2017-02-16T21:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280460755",
      "id" : 280460755,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-16T21:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280460755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "> I believe the most common case of a large value though is misunderstanding the units (e.g. giving it a limit in bytes).\r\n\r\nOr using a pre-2016 bitcoin.conf when maxsigcachesize was measured in cache entries instead of MiB :(",
      "created_at" : "2017-02-17T03:28:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280539982",
      "id" : 280539982,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-17T03:28:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280539982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "ouch. uh. that is an argument for throwing an error or renaming the argument rather than just claiming to an insane value.",
      "created_at" : "2017-02-17T04:04:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280545127",
      "id" : 280545127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-17T04:04:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280545127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> ouch. uh. that is an argument for throwing an error or renaming the argument rather than just claiming to an insane value.\r\n\r\nYes it also would have been perfectly valid to make `InitSignatureCache()` return an error status, and handle the error upstream by printing a message (hopefully a generalized \"value out of range\" one instead of adding a specific translation message) instead of clamping it here.\r\n\r\nHowever now that we have this, I don't see a point in redesigning it again and going through another review. As you say there are an infinite number of more pressing issues.",
      "created_at" : "2017-02-17T08:00:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280581194",
      "id" : 280581194,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-17T08:00:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280581194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "squashed d72fe44fc1989575ff5de98c882c0010d1de26e7..e6374a03b9869362595acd5cc5e5b8994b244af1 into 55c403b8febe02555c52bac7028cd6b1f006fad1, merged via 8dee8221770893fbf0ec6c19ad385537984ba44f\r\n",
      "created_at" : "2017-02-17T08:07:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9777#issuecomment-280582566",
      "id" : 280582566,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9777",
      "updated_at" : "2017-02-17T08:07:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/280582566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
