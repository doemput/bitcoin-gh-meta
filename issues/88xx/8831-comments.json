[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r84069781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84069781"
         }
      },
      "body" : "I'd say this belongs in wallet.h, not walletdb.h, as it's not used in walletdb anymore?\n",
      "commit_id" : "dc127cac695993223c83a409daeacbe2b4f64d50",
      "created_at" : "2016-10-19T13:31:47Z",
      "diff_hunk" : "@@ -41,6 +41,24 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+class CWalletScanState {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r84069781",
      "id" : 84069781,
      "original_commit_id" : "b671cbba98b0b6d9a79586a45f67202ce48c148b",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_review_id" : 4869632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831",
      "updated_at" : "2017-02-16T11:38:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84069781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r85862146"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85862146"
         }
      },
      "body" : "It's still used in CWalletDB::LoadWallet\n",
      "commit_id" : "dc127cac695993223c83a409daeacbe2b4f64d50",
      "created_at" : "2016-11-01T00:58:00Z",
      "diff_hunk" : "@@ -41,6 +41,24 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+class CWalletScanState {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r85862146",
      "id" : 85862146,
      "original_commit_id" : "b671cbba98b0b6d9a79586a45f67202ce48c148b",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_review_id" : 6552104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831",
      "updated_at" : "2017-02-16T11:38:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85862146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r86888120"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86888120"
         }
      },
      "body" : "Splitting it up across files is pretty ugly in that case. Is there a next step PR in the pipeline to fix that?\n",
      "commit_id" : "dc127cac695993223c83a409daeacbe2b4f64d50",
      "created_at" : "2016-11-07T22:49:52Z",
      "diff_hunk" : "@@ -41,6 +41,24 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+class CWalletScanState {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r86888120",
      "id" : 86888120,
      "original_commit_id" : "b671cbba98b0b6d9a79586a45f67202ce48c148b",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_review_id" : 7523516,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831",
      "updated_at" : "2017-02-16T11:38:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86888120",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r86890472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86890472"
         }
      },
      "body" : "there isn't currently but there will be\n",
      "commit_id" : "dc127cac695993223c83a409daeacbe2b4f64d50",
      "created_at" : "2016-11-07T23:04:37Z",
      "diff_hunk" : "@@ -41,6 +41,24 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+class CWalletScanState {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#discussion_r86890472",
      "id" : 86890472,
      "original_commit_id" : "b671cbba98b0b6d9a79586a45f67202ce48c148b",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_review_id" : 7525758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8831",
      "updated_at" : "2017-02-16T11:38:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86890472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@sipa latest commit completely removes CWalletDB::LoadWallet\r\n\r\nStill cant move CWalletScanState because of CWalletDB::Recover",
      "created_at" : "2016-11-08T01:00:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-259013473",
      "id" : 259013473,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2016-11-08T01:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259013473",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Wouldn't it be possible to create a simple CWalletLoader class in walletdb.h, with only virtual functions, have CWallet implement CWalletLoader and then let CWalletDB::LoadWallet take a CWalletLoader* argument?",
      "created_at" : "2016-11-15T03:31:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-260537762",
      "id" : 260537762,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2016-11-15T03:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260537762",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa I guess, but why?\r\n\r\nCWalletDB really should just be doing serialization",
      "created_at" : "2016-11-15T04:13:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-260542889",
      "id" : 260542889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2016-11-15T04:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260542889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@pstratem Serialization is in wallet.h (by virtue of the SerializationOp methods in the data structure). Walletdb's responsibility is knowing the file format (what keys correspond to what, interacting with BDB, ...). It seems that your pull here is partially moving the knowledge of the file format to CWallet itself.\r\n\r\nBy introducing a CWalletLoader interface, you can just move the knowledge for how to load entries to the wallet itself, while leaving the format definition in walletdb.",
      "created_at" : "2016-11-15T18:20:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-260722514",
      "id" : 260722514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2016-11-15T18:20:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260722514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I agree with @sipa here. The goal is not to move everything related to the wallet and knowledge of everything into CWallet. This appears to be happening lately: part of initialization was moved into CWallet, argument parsing was moved into CWallet, and so on.\r\n\r\nSplitting up a \"god class\" later is quite difficult, so I'd also prefer not going through that and introducing a CWalletLoader which is concerned with the file format.",
      "created_at" : "2017-02-23T10:02:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-281948939",
      "id" : 281948939,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2017-02-23T10:02:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/281948939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Closing this - would need extensive rebasing, and it seems from above discussion that there was no agreement on this approach.\r\nLet me know if it should be re-openened.",
      "created_at" : "2017-06-22T15:43:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8831#issuecomment-310419815",
      "id" : 310419815,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8831",
      "updated_at" : "2017-06-22T15:43:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310419815",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
