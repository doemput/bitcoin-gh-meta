[
   {
      "body" : "So it appears that there is a leak of file descriptors somewhere in the RPC code?\r\n\r\nWhat version of boost?\r\n",
      "created_at" : "2014-03-28T10:53:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-38907485",
      "id" : 38907485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-03-28T10:53:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38907485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "`1.53.0`",
      "created_at" : "2014-03-28T16:22:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-38938231",
      "id" : 38938231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-03-28T16:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38938231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/201777?v=3",
         "events_url" : "https://api.github.com/users/espringe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/espringe/followers",
         "following_url" : "https://api.github.com/users/espringe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/espringe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/espringe",
         "id" : 201777,
         "login" : "espringe",
         "organizations_url" : "https://api.github.com/users/espringe/orgs",
         "received_events_url" : "https://api.github.com/users/espringe/received_events",
         "repos_url" : "https://api.github.com/users/espringe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/espringe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/espringe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/espringe"
      }
   },
   {
      "body" : "Are you using SSL?\r\n",
      "created_at" : "2014-03-31T06:46:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39058013",
      "id" : 39058013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-03-31T06:46:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39058013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Nope",
      "created_at" : "2014-03-31T16:12:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39107541",
      "id" : 39107541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-03-31T16:16:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39107541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/201777?v=3",
         "events_url" : "https://api.github.com/users/espringe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/espringe/followers",
         "following_url" : "https://api.github.com/users/espringe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/espringe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/espringe",
         "id" : 201777,
         "login" : "espringe",
         "organizations_url" : "https://api.github.com/users/espringe/orgs",
         "received_events_url" : "https://api.github.com/users/espringe/received_events",
         "repos_url" : "https://api.github.com/users/espringe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/espringe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/espringe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/espringe"
      }
   },
   {
      "body" : "Maybe doing anything else that may make your RPC usage behaviour different from others?\r\n\r\nWhat do you mean by RPC requests 'getting interrupted'?\r\n",
      "created_at" : "2014-04-01T06:46:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39175445",
      "id" : 39175445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-04-01T06:46:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39175445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "As in if a program crashes, or yje network is disconnected while a client\nis making an RPC call. Only tested for remote connections\nOn Apr 1, 2014 12:47 AM, \"Wladimir J. van der Laan\" <\nnotifications@github.com> wrote:\n\n> Maybe doing anything else that may make your RPC usage behaviour different\n> from others?\n>\n> What do you mean by RPC requests 'getting interrupted'?\n>\n> --\n> Reply to this email directly or view it on GitHub<https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39175445>\n> .\n>",
      "created_at" : "2014-04-01T13:07:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39202572",
      "id" : 39202572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-04-01T13:07:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39202572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/201777?v=3",
         "events_url" : "https://api.github.com/users/espringe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/espringe/followers",
         "following_url" : "https://api.github.com/users/espringe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/espringe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/espringe",
         "id" : 201777,
         "login" : "espringe",
         "organizations_url" : "https://api.github.com/users/espringe/orgs",
         "received_events_url" : "https://api.github.com/users/espringe/received_events",
         "repos_url" : "https://api.github.com/users/espringe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/espringe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/espringe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/espringe"
      }
   },
   {
      "body" : "This would be a good candidate for a regression test in qa/rpc-tests.\r\nYou should be able to reproduce with kill -9 while servicing requests...\r\n",
      "created_at" : "2014-04-01T13:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-39203297",
      "id" : 39203297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-04-01T13:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39203297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Hmm... So I attempted to reproduce this one in 0.9.0 on Linux/x64 with boost 1.53 by writing a script that banged on the RPC server pretty heavily with random SIGKILLs to interrupt the requests.  I got lots of CLOSE_WAITS, but they all seemed to clean themselves up and the server never stopped servicing requests.  However, it would get pretty backed up response time wise when I would bang really hard.  I'm starting to think that perhaps the server is getting wedged in a way that is specific to your chosen RPC requests.\r\n\r\nCan you provide some more detail on what your RPC request activity looks like?  What functions are you calling and with what frequency are you calling them?  Even better, would you be willing to run with \"-debug=rpc\" and attach the debug.log file from the data directory?\r\n\r\nIncidentally, rpctimeout was deprecated in 0.7.0 when multithreaded JSON-RPC was implemented.  The manpage for bitcoind erroneously still mentions it.",
      "created_at" : "2014-05-06T19:03:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-42344742",
      "id" : 42344742,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-05-06T19:03:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42344742",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   },
   {
      "body" : "+1",
      "created_at" : "2014-08-19T07:14:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-52598099",
      "id" : 52598099,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-08-19T07:14:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52598099",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3481789?v=3",
         "events_url" : "https://api.github.com/users/MaDeRkAn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MaDeRkAn/followers",
         "following_url" : "https://api.github.com/users/MaDeRkAn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MaDeRkAn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MaDeRkAn",
         "id" : 3481789,
         "login" : "MaDeRkAn",
         "organizations_url" : "https://api.github.com/users/MaDeRkAn/orgs",
         "received_events_url" : "https://api.github.com/users/MaDeRkAn/received_events",
         "repos_url" : "https://api.github.com/users/MaDeRkAn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MaDeRkAn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MaDeRkAn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MaDeRkAn"
      }
   },
   {
      "body" : "Please do not +1 issues. Only post if you have something substantial to add.\r\n",
      "created_at" : "2014-08-19T07:52:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-52601008",
      "id" : 52601008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2014-08-19T07:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52601008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I was experiencing similar issues, where if hammering the RPC with requests as fast as possible (from a single threaded client process) it would at some point get stuck and hit the client side timeout (60s), after a while it get's unstuck and I can do a big batch of requests again.  \r\n - Client process is PHP CURL (or HHVM, same result)\r\n - Also experienced the same issue when hammering the `0.10` rest interface.  \r\n - Could not see anything suspicious in the `lsof`, so I'm not sure if it's the same issue.  \r\n - Nothing special in the `debug.log`, with `-debug` or `debug=rpc`.  \r\n\r\nI could not reproduce it with a simple `while [ True ]; do bitcoin-cli -testnet getrawtransaction 1030c244faabd45f6750d7c7254fa1aa87158deb900a329ef50a6dcb3aa0228e; done`, nor with `while [ True ]; do curl http://localhost:18332/rest/tx/1030c244faabd45f6750d7c7254fa1aa87158deb900a329ef50a6dcb3aa0228e.hex; done;`\r\n\r\nI managed to fix the issue by adding a `Connection: close` header to the client CURL request, after that I can hammer it for hours without interuptions.  \r\nOr alternatively reuse the connection handler.\r\n\r\n@espringe what are you using to do the requests and can you reproduce the RPC getting stuck by doing an infinite loop for `getrawtransaction 1030c244faabd45f6750d7c7254fa1aa87158deb900a329ef50a6dcb3aa0228e`?  \r\nIf so, can you try adding the `Connection: close` header and see if that fixes it for you?",
      "created_at" : "2015-03-18T18:05:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-83103381",
      "id" : 83103381,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2015-03-18T18:05:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/83103381",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649160?v=3",
         "events_url" : "https://api.github.com/users/rubensayshi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rubensayshi/followers",
         "following_url" : "https://api.github.com/users/rubensayshi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rubensayshi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rubensayshi",
         "id" : 649160,
         "login" : "rubensayshi",
         "organizations_url" : "https://api.github.com/users/rubensayshi/orgs",
         "received_events_url" : "https://api.github.com/users/rubensayshi/received_events",
         "repos_url" : "https://api.github.com/users/rubensayshi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rubensayshi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rubensayshi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rubensayshi"
      }
   },
   {
      "body" : "Since 0.10, rpc keepalive is optional and off by default (in 0.8 and 0.9 it was always on). Does that resolve the issue?",
      "created_at" : "2015-04-11T10:15:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-91820275",
      "id" : 91820275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2015-04-11T10:15:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/91820275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "This is likely the same as #6454 and fixed by #5677 ",
      "created_at" : "2015-10-29T15:05:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3968#issuecomment-152208066",
      "id" : 152208066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3968",
      "updated_at" : "2015-10-29T15:05:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152208066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1746780?v=3",
         "events_url" : "https://api.github.com/users/mcelrath/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mcelrath/followers",
         "following_url" : "https://api.github.com/users/mcelrath/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mcelrath/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mcelrath",
         "id" : 1746780,
         "login" : "mcelrath",
         "organizations_url" : "https://api.github.com/users/mcelrath/orgs",
         "received_events_url" : "https://api.github.com/users/mcelrath/received_events",
         "repos_url" : "https://api.github.com/users/mcelrath/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mcelrath/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mcelrath/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mcelrath"
      }
   }
]
