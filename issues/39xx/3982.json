{
   "assignee" : null,
   "body" : "The current code assumes that if the receive buffer for a version message is not empty after the addrMe field, it must contain the addrFrom field and the nNonce field.  This pull request moves the nNonce read into its own statement after checking if the receive buffer is empty.  This decouples the optionality of the fields so that each can be optional as opposed to both being required when addrFrom is present.\r\n\r\nNote that there is an alternative way to approach this that I was unsure would be preferred, so I chose the approach in the pull request after discussing with @sipa who indicated the each read should be probably be separate.\r\n\r\nThe alternative approach comes from looking at commit 18c0fa97d0408a3ee8e4cb39c08156f7667f99ac which indicates that the three fields of addrFrom, nNonce, and strSubVersion were added in protocol version 106.  In that case, perhaps all three reads should be under a single `if (!vRecv.empty())` check which indicates that all three must be present if the receive buffer is not empty after the addrMe field which already existed in prior protocol versions.  This would more clearly indicate that the fields were added in the same protocol version.\r\n\r\nIn either case, since this code defines the protocol spec, I think the handling should be one of the two approaches versus the current approach where two of the fields that were introduced in protocol version 106 are coupled where the third one is not.\r\n\r\nIf the alternative approach is preferred, I can update the pull request accordingly.",
   "closed_at" : "2014-05-28T14:07:00Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 13,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3982/comments",
   "created_at" : "2014-03-30T19:54:52Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3982/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/3982",
   "id" : 30473224,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3982/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 3982,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/3982.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3982",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/3982.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3982"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Decouple addrFrom and nNonce fields in version message read",
   "updated_at" : "2014-08-28T02:13:02Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3982",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/2115102?v=3",
      "events_url" : "https://api.github.com/users/davecgh/events{/privacy}",
      "followers_url" : "https://api.github.com/users/davecgh/followers",
      "following_url" : "https://api.github.com/users/davecgh/following{/other_user}",
      "gists_url" : "https://api.github.com/users/davecgh/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/davecgh",
      "id" : 2115102,
      "login" : "davecgh",
      "organizations_url" : "https://api.github.com/users/davecgh/orgs",
      "received_events_url" : "https://api.github.com/users/davecgh/received_events",
      "repos_url" : "https://api.github.com/users/davecgh/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/davecgh/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/davecgh/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/davecgh"
   }
}
