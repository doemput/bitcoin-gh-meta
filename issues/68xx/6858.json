{
   "assignee" : null,
   "body" : "`LoadExternalBlockFile` accesses `mapBlockIndex` without holding __cs_main__ (or any other locks).  The `fImporting` flag should prevent a block being processed from the p2p code at the same time the _bitcoin-loadblk_ thread is running, however a submitblock RPC call could cause a block to be processed and change `mapBlockIndex`.\r\n\r\nA related, but somewhat separate issue is that during reindexing it should not be possible to write data to the block files.  The database of which files contain which blocks and where space exists for new blocks to be written is still in the process of being created.  A submitblock RPC call during a reindexing seems like it would cause significant problems. ",
   "closed_at" : "2015-10-19T20:40:33Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
      "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
      "followers_url" : "https://api.github.com/users/morcos/followers",
      "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/morcos",
      "id" : 4360349,
      "login" : "morcos",
      "organizations_url" : "https://api.github.com/users/morcos/orgs",
      "received_events_url" : "https://api.github.com/users/morcos/received_events",
      "repos_url" : "https://api.github.com/users/morcos/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/morcos"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6858/comments",
   "created_at" : "2015-10-19T20:38:32Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6858/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/6858",
   "id" : 112228049,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6858/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 6858,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Locking is missing from LoadExternalBlockFile",
   "updated_at" : "2015-10-19T20:40:33Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6858",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
      "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
      "followers_url" : "https://api.github.com/users/morcos/followers",
      "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/morcos",
      "id" : 4360349,
      "login" : "morcos",
      "organizations_url" : "https://api.github.com/users/morcos/orgs",
      "received_events_url" : "https://api.github.com/users/morcos/received_events",
      "repos_url" : "https://api.github.com/users/morcos/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/morcos"
   }
}
