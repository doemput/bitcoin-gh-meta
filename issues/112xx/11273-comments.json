[
   {
      "author_association" : "OWNER",
      "body" : "Is this just a cleanup or does this result in crashes/misestimations?",
      "created_at" : "2017-09-07T20:39:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#issuecomment-327921266",
      "id" : 327921266,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11273",
      "updated_at" : "2017-09-07T20:39:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327921266",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137663908"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137663908"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This will always evaluate to false, as nVersionThatWrote is currently ==149900",
      "commit_id" : "3a3a9f978ba625d9d1f645810e81ecbc3cfb86ae",
      "created_at" : "2017-09-07T21:48:47Z",
      "diff_hunk" : "@@ -944,32 +944,7 @@ bool CBlockPolicyEstimator::Read(CAutoFile& filein)\n         unsigned int nFileBestSeenHeight;\n         filein >> nFileBestSeenHeight;\n \n-        if (nVersionThatWrote < 149900) {\n-            // Read the old fee estimates file for temporary use, but then discard.  Will start collecting data from scratch.\n-            // decay is stored before buckets in old versions, so pre-read decay and pass into TxConfirmStats constructor\n-            double tempDecay;\n-            filein >> tempDecay;\n-            if (tempDecay <= 0 || tempDecay >= 1)\n-                throw std::runtime_error(\"Corrupt estimates file. Decay must be between 0 and 1 (non-inclusive)\");\n-\n-            std::vector<double> tempBuckets;\n-            filein >> tempBuckets;\n-            size_t tempNum = tempBuckets.size();\n-            if (tempNum <= 1 || tempNum > 1000)\n-                throw std::runtime_error(\"Corrupt estimates file. Must have between 2 and 1000 feerate buckets\");\n-\n-            std::map<double, unsigned int> tempMap;\n-\n-            std::unique_ptr<TxConfirmStats> tempFeeStats(new TxConfirmStats(tempBuckets, tempMap, MED_BLOCK_PERIODS, tempDecay, 1));\n-            tempFeeStats->Read(filein, nVersionThatWrote, tempNum);\n-            // if nVersionThatWrote < 139900 then another TxConfirmStats (for priority) follows but can be ignored.\n-\n-            tempMap.clear();\n-            for (unsigned int i = 0; i < tempBuckets.size(); i++) {\n-                tempMap[tempBuckets[i]] = i;\n-            }\n-        }\n-        else { // nVersionThatWrote >= 149900\n+        if (nVersionThatWrote > 149900) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137663908",
      "id" : 137663908,
      "original_commit_id" : "9b1d851f0fd4c2ca413f1419c73d657f477062fd",
      "original_position" : 30,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 61362399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273",
      "updated_at" : "2017-09-07T22:58:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137663908",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137672601"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137672601"
         }
      },
      "author_association" : "OWNER",
      "body" : "I don't think so - on 0.15.0 it should be `150000` on master it should be `159900`",
      "commit_id" : "3a3a9f978ba625d9d1f645810e81ecbc3cfb86ae",
      "created_at" : "2017-09-07T22:41:00Z",
      "diff_hunk" : "@@ -944,32 +944,7 @@ bool CBlockPolicyEstimator::Read(CAutoFile& filein)\n         unsigned int nFileBestSeenHeight;\n         filein >> nFileBestSeenHeight;\n \n-        if (nVersionThatWrote < 149900) {\n-            // Read the old fee estimates file for temporary use, but then discard.  Will start collecting data from scratch.\n-            // decay is stored before buckets in old versions, so pre-read decay and pass into TxConfirmStats constructor\n-            double tempDecay;\n-            filein >> tempDecay;\n-            if (tempDecay <= 0 || tempDecay >= 1)\n-                throw std::runtime_error(\"Corrupt estimates file. Decay must be between 0 and 1 (non-inclusive)\");\n-\n-            std::vector<double> tempBuckets;\n-            filein >> tempBuckets;\n-            size_t tempNum = tempBuckets.size();\n-            if (tempNum <= 1 || tempNum > 1000)\n-                throw std::runtime_error(\"Corrupt estimates file. Must have between 2 and 1000 feerate buckets\");\n-\n-            std::map<double, unsigned int> tempMap;\n-\n-            std::unique_ptr<TxConfirmStats> tempFeeStats(new TxConfirmStats(tempBuckets, tempMap, MED_BLOCK_PERIODS, tempDecay, 1));\n-            tempFeeStats->Read(filein, nVersionThatWrote, tempNum);\n-            // if nVersionThatWrote < 139900 then another TxConfirmStats (for priority) follows but can be ignored.\n-\n-            tempMap.clear();\n-            for (unsigned int i = 0; i < tempBuckets.size(); i++) {\n-                tempMap[tempBuckets[i]] = i;\n-            }\n-        }\n-        else { // nVersionThatWrote >= 149900\n+        if (nVersionThatWrote > 149900) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137672601",
      "id" : 137672601,
      "in_reply_to_id" : 137663908,
      "original_commit_id" : "9b1d851f0fd4c2ca413f1419c73d657f477062fd",
      "original_position" : 30,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 61371984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273",
      "updated_at" : "2017-09-07T22:58:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137672601",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj This is meant to just be cleanup.  The code to process the old file was left in under the thought we might provide a transition, but then we never did.  Which reminds me, we should mention in the release notes that upgrading starts your estimates over again.",
      "created_at" : "2017-09-09T18:48:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#issuecomment-328296395",
      "id" : 328296395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11273",
      "updated_at" : "2017-09-09T18:48:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/328296395",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137932910"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137932910"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Mixed that up as `nVersionRequired`, sorry.",
      "commit_id" : "3a3a9f978ba625d9d1f645810e81ecbc3cfb86ae",
      "created_at" : "2017-09-09T19:04:07Z",
      "diff_hunk" : "@@ -944,32 +944,7 @@ bool CBlockPolicyEstimator::Read(CAutoFile& filein)\n         unsigned int nFileBestSeenHeight;\n         filein >> nFileBestSeenHeight;\n \n-        if (nVersionThatWrote < 149900) {\n-            // Read the old fee estimates file for temporary use, but then discard.  Will start collecting data from scratch.\n-            // decay is stored before buckets in old versions, so pre-read decay and pass into TxConfirmStats constructor\n-            double tempDecay;\n-            filein >> tempDecay;\n-            if (tempDecay <= 0 || tempDecay >= 1)\n-                throw std::runtime_error(\"Corrupt estimates file. Decay must be between 0 and 1 (non-inclusive)\");\n-\n-            std::vector<double> tempBuckets;\n-            filein >> tempBuckets;\n-            size_t tempNum = tempBuckets.size();\n-            if (tempNum <= 1 || tempNum > 1000)\n-                throw std::runtime_error(\"Corrupt estimates file. Must have between 2 and 1000 feerate buckets\");\n-\n-            std::map<double, unsigned int> tempMap;\n-\n-            std::unique_ptr<TxConfirmStats> tempFeeStats(new TxConfirmStats(tempBuckets, tempMap, MED_BLOCK_PERIODS, tempDecay, 1));\n-            tempFeeStats->Read(filein, nVersionThatWrote, tempNum);\n-            // if nVersionThatWrote < 139900 then another TxConfirmStats (for priority) follows but can be ignored.\n-\n-            tempMap.clear();\n-            for (unsigned int i = 0; i < tempBuckets.size(); i++) {\n-                tempMap[tempBuckets[i]] = i;\n-            }\n-        }\n-        else { // nVersionThatWrote >= 149900\n+        if (nVersionThatWrote > 149900) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#discussion_r137932910",
      "id" : 137932910,
      "in_reply_to_id" : 137663908,
      "original_commit_id" : "9b1d851f0fd4c2ca413f1419c73d657f477062fd",
      "original_position" : 30,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 61668879,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11273",
      "updated_at" : "2017-09-09T19:04:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137932910",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "There are also similar cleanups to be had in TxConfirmStats::Read.",
      "created_at" : "2017-09-11T16:45:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#issuecomment-328588422",
      "id" : 328588422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11273",
      "updated_at" : "2017-09-11T16:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/328588422",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery and I tested this at CDT. It will only refrain from loading estimation files created by the previous version as they are not compatible with the new estimation file.",
      "created_at" : "2017-09-26T04:44:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#issuecomment-332084951",
      "id" : 332084951,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11273",
      "updated_at" : "2017-09-26T04:44:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332084951",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Xekyo care to respond to @TheBlueMatt's comment? There are a couple of if statements in `TxConfirmStats::Read` that are now redundant:https://github.com/bitcoin/bitcoin/blob/67879b7c443144e479c763f64abb9c1ed7e44eaa/src/policy/fees.cpp#L415 and https://github.com/bitcoin/bitcoin/blob/67879b7c443144e479c763f64abb9c1ed7e44eaa/src/policy/fees.cpp#L444\r\nThis PR should also clean up that code.",
      "created_at" : "2017-09-26T13:29:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11273#issuecomment-332198214",
      "id" : 332198214,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11273",
      "updated_at" : "2017-09-26T13:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332198214",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
