[
   {
      "body" : "I'm not sold on passing in the VersionBitsCache (which is the primary difference between this and the version at #10192) - why should ConnectBlock even be aware that there is a fancy cache making GetScriptFlags faster?",
      "created_at" : "2017-06-06T00:52:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306350621",
      "id" : 306350621,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-06T00:52:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306350621",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "> why should ConnectBlock even be aware that there is a fancy cache making GetScriptFlags faster?\r\n\r\nWell, GetScriptFlags is aware of it anyway, so at a minimum, I think not calling IsWitnessEnabled from it is very reasonable.\r\n\r\nRegarding the question, ConnectBlock should is aware of the global versionbitscache because it uses it though GetScriptFlags, whether we chose to make that dependency explicit or not.\r\nBut I guess this comes down to me liking globals being used explicitly instead of hidden when possible (and lower level functions that don't need to use the globals and can use local parameters instead do that instead of using globals they don't need to depend on).\r\nBut from past discussions I think you don't believe there's anything wrong with using globals when you don't need them or anything good with functions declaring all their dependencies explicitly as parameters, so I guess I can't convince you on that.\r\n",
      "created_at" : "2017-06-07T12:43:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306782995",
      "id" : 306782995,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-07T12:43:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306782995",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Guess its all a personal preference thing - make functions more static and pass globals in from higher up the stack, or put a bit more encapsulation in the lower-level functions and keep the globals only for those functions. I tend to prefer the second, myself, but open to other views.",
      "created_at" : "2017-06-07T17:09:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306861693",
      "id" : 306861693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-07T17:09:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306861693",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Thoughts on at least removing the use of IsWitnessEnabled() from your version of the change?\r\nThat's just removing the use of an unnecessary wrapper.",
      "created_at" : "2017-06-07T17:22:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306865367",
      "id" : 306865367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-07T17:22:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306865367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "I dont have any strong feelings, but IsWitnessEnabled is a much clearer expression of whats going on, and also keeps duplication of that check to one place, which is nice (especially given all the folks running around doing crazy 148/149/etc implementations).",
      "created_at" : "2017-06-07T17:52:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306873739",
      "id" : 306873739,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-07T17:52:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306873739",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Whatever, I guess I can do this changes later if I ever get to the point where I can actually use them. Closing.",
      "created_at" : "2017-06-07T21:04:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10427#issuecomment-306924506",
      "id" : 306924506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10427",
      "updated_at" : "2017-06-07T21:04:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306924506",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
