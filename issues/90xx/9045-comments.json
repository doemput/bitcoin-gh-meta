[
   {
      "body" : "utACK. Somehow I thought we were already doing this.",
      "created_at" : "2016-10-30T22:28:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257184364",
      "id" : 257184364,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-30T22:28:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257184364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2016-10-31T06:30:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257222496",
      "id" : 257222496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T06:30:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257222496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@TheBlueMatt Did you time how long the hashing was taking on a typical full block?",
      "created_at" : "2016-10-31T08:50:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257241369",
      "id" : 257241369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T08:50:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257241369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad This is about P2P messages and their checksums...",
      "created_at" : "2016-10-31T12:16:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257279125",
      "id" : 257279125,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T12:16:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257279125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/9045/commits/fe1dc62cef88280d2490a619beded052f313c6fc",
      "created_at" : "2016-10-31T12:16:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257279182",
      "id" : 257279182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T12:16:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257279182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "I did not Rome the hashing, though I expect it to be between 3 and 10 ms (we use a particularly slow SHA256 implementation, as we don't incorporate any handcoded asm), but the lower bound is about 3, assuming it's cache-hot.\n\nOn October 31, 2016 4:50:20 AM EDT, R E Broadley <notifications@github.com> wrote:\n>@TheBlueMatt Did you time how long the hashing was taking on a typical\n>full block?\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257241369\n",
      "created_at" : "2016-10-31T12:33:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257282105",
      "id" : 257282105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T12:33:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257282105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "mm, NACK unless there are numbers that show that this is preferable.\r\n\r\n1. This removes our ability to selectively hash. If we're flooded with thousands of messages that we would otherwise drop after the first, we still end up hashing them.\r\n2. Removes the ability to skip hashing for known values. For example, hashing for \"sendheaders\" could be skipped and we could just check against the known-correct value.\r\n3. The socket polling loop needs to be as tight as possible.\r\n4. Message processing could definitely be done multi-threaded, but multi-threaded polling is unlikely.",
      "created_at" : "2016-10-31T20:48:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257416177",
      "id" : 257416177,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T20:48:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257416177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni While hashing is incredibly fast, it can be cause a big hit to latency for time-from-block-receive-to-relay (lower bound on hashing 1MB is around 3ms, whereas total runtime for deserialize and AcceptBlock, not including storage, is something like 15ms), especially if you received the full \"block\" message. Doing it as packets come in off the wire should never be a bottleneck - hashing is, more often than not, going to be able to easily keep up with your wire speed. This means that you can hash the message as it comes off the wire and when you receive the last packet (ie are ready to start processing) you dont have to wait for hashing to complete.\r\n\r\nIndeed, it complicates CConnman somewhat but CNetMessage will likely have to change for protocol encryption anyway, so its not like the logic in the same place isnt gonna have to learn protocol encryption.",
      "created_at" : "2016-10-31T22:46:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-257442811",
      "id" : 257442811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-10-31T22:46:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257442811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt ok, I've come around on this. Thanks to @gmaxwell and @sipa for the discussion over the weekend. utACK https://github.com/bitcoin/bitcoin/pull/9045/commits/fe1dc62cef88280d2490a619beded052f313c6fc.",
      "created_at" : "2016-11-07T19:07:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9045#issuecomment-258931057",
      "id" : 258931057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9045",
      "updated_at" : "2016-11-07T19:07:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258931057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
