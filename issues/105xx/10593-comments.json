[
   {
      "body" : "This seems like a reasonable approach to me; any idea why stop_node in the zapwallettxes test isn't getting a 0 exit code?",
      "created_at" : "2017-06-20T11:39:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-309727124",
      "id" : 309727124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-06-20T11:39:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/309727124",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/127186?v=3",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "body" : "@ajtowns Not sure what you're asking? The tests are passing...",
      "created_at" : "2017-07-04T06:32:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-312792206",
      "id" : 312792206,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-07-04T06:32:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/312792206",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "I guess whatever I saw was a transient error then (or I was just confused)...",
      "created_at" : "2017-07-05T02:56:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-312984750",
      "id" : 312984750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-07-05T02:56:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/312984750",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/127186?v=3",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10593#discussion_r143066000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10593"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143066000"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Use nodestate instead of State(it->second.first)",
      "commit_id" : "ba516526100a22225bd0a35a3e1e11f90c389d5a",
      "created_at" : "2017-10-05T21:49:12Z",
      "diff_hunk" : "@@ -865,10 +889,16 @@ void PeerLogicValidation::BlockChecked(const CBlock& block, const CValidationSta\n     if (state.IsInvalid(nDoS)) {\n         // Don't send reject message with code 0 or an internal reject code.\n         if (it != mapBlockSource.end() && State(it->second.first) && state.GetRejectCode() > 0 && state.GetRejectCode() < REJECT_INTERNAL) {\n+            const NodeId node_id = it->second.first;\n+            CNodeState * const nodestate = State(node_id);\n             CBlockReject reject = {(unsigned char)state.GetRejectCode(), state.GetRejectReason().substr(0, MAX_REJECT_MESSAGE_LENGTH), hash};\n             State(it->second.first)->rejects.push_back(reject);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#discussion_r143066000",
      "id" : 143066000,
      "original_commit_id" : "ba516526100a22225bd0a35a3e1e11f90c389d5a",
      "original_position" : 38,
      "path" : "src/net_processing.cpp",
      "position" : 38,
      "pull_request_review_id" : 67524587,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10593",
      "updated_at" : "2017-10-05T21:49:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143066000",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Have we considered preferring a relatively short-time-period ban instead of purely disconnecting? If the peer is somehow braindead and tries to reconnect immediately we may prefer to keep them gone for 30 minutes or an hour instead of letting them get into some loop of connect-relay-disconnect.",
      "created_at" : "2017-10-05T22:16:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-334607495",
      "id" : 334607495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-10-05T22:16:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334607495",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It seems like this reverts #8305 with no mechanism to replace that functionality. Rationale?  This looks like a regression.",
      "created_at" : "2017-10-06T18:48:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-334839416",
      "id" : 334839416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-10-06T18:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334839416",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It was mentioned during the IRC meeting that this already did what I am planning on doing in #11446. However this doesn't seem to cover the case that I am concerned about: receiving a header for a block we have already marked as invalid. In such a case, `nDos` will be 0 and thus the peer won't be punished for relaying us the duplicate header.",
      "created_at" : "2017-10-07T16:16:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#issuecomment-334946691",
      "id" : 334946691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10593",
      "updated_at" : "2017-10-07T16:16:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334946691",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10593#discussion_r144891403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10593"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144891403"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Test passes with the above changes.",
      "commit_id" : "ba516526100a22225bd0a35a3e1e11f90c389d5a",
      "created_at" : "2017-10-16T16:04:03Z",
      "diff_hunk" : "@@ -526,21 +526,6 @@ def run_test(self):\n         # Remove the first two entries (blocks[1] would connect):\n         blocks = blocks[2:]\n \n-        # Now try to see how many unconnecting headers we can send",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10593#discussion_r144891403",
      "id" : 144891403,
      "original_commit_id" : "ba516526100a22225bd0a35a3e1e11f90c389d5a",
      "original_position" : 4,
      "path" : "test/functional/sendheaders.py",
      "position" : 4,
      "pull_request_review_id" : 69611928,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10593",
      "updated_at" : "2017-10-16T16:04:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144891403",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
