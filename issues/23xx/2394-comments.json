[
   {
      "body" : "Interesting find, guess no one ever thought about such a corner case then.",
      "created_at" : "2013-03-20T21:20:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-15204305",
      "id" : 15204305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-03-20T21:20:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15204305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I meet the same bug. \r\n\r\nBitcoin version v0.8.1-beta (2013-03-17 15:35:36 -0400)",
      "created_at" : "2013-07-16T09:20:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-21030410",
      "id" : 21030410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-07-16T09:20:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21030410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1657519?v=3",
         "events_url" : "https://api.github.com/users/simon-liu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/simon-liu/followers",
         "following_url" : "https://api.github.com/users/simon-liu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/simon-liu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/simon-liu",
         "id" : 1657519,
         "login" : "simon-liu",
         "organizations_url" : "https://api.github.com/users/simon-liu/orgs",
         "received_events_url" : "https://api.github.com/users/simon-liu/received_events",
         "repos_url" : "https://api.github.com/users/simon-liu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/simon-liu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/simon-liu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/simon-liu"
      }
   },
   {
      "body" : "FWIW, I also saw this on my 2aa462e-based next-test, after about 800 keys (targetting 10,000 keys).\r\nInitially, I assumed it was relayed to the wallet closing timeout, so when I restarted, I put an effectively-infinite timeout on it; it crashed again after about 800 keys.\r\nThe third try completed successfully.\r\n(Obviously next-test isn't going to be a very good report for this kind of bug, but considering others have similar problems I thought it might be useful info to add)",
      "created_at" : "2013-07-16T17:39:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-21059348",
      "id" : 21059348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-07-16T17:39:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21059348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "After upgrade to v0.8.3-beta, the bug still exists.",
      "created_at" : "2013-07-17T01:28:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-21086564",
      "id" : 21086564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-07-17T01:28:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21086564",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4977914?v=3",
         "events_url" : "https://api.github.com/users/bitnews/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bitnews/followers",
         "following_url" : "https://api.github.com/users/bitnews/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bitnews/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bitnews",
         "id" : 4977914,
         "login" : "bitnews",
         "organizations_url" : "https://api.github.com/users/bitnews/orgs",
         "received_events_url" : "https://api.github.com/users/bitnews/received_events",
         "repos_url" : "https://api.github.com/users/bitnews/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bitnews/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bitnews/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bitnews"
      }
   },
   {
      "body" : "I use gdb debugÃ¯Â¼Â\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  CWallet::GenerateNewKey() : AddKey failed",
      "created_at" : "2013-07-17T02:52:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-21089003",
      "id" : 21089003,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-07-17T02:52:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21089003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1657519?v=3",
         "events_url" : "https://api.github.com/users/simon-liu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/simon-liu/followers",
         "following_url" : "https://api.github.com/users/simon-liu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/simon-liu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/simon-liu",
         "id" : 1657519,
         "login" : "simon-liu",
         "organizations_url" : "https://api.github.com/users/simon-liu/orgs",
         "received_events_url" : "https://api.github.com/users/simon-liu/received_events",
         "repos_url" : "https://api.github.com/users/simon-liu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/simon-liu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/simon-liu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/simon-liu"
      }
   },
   {
      "body" : "Can you try again with current master?\r\n\r\nI tried keypoolrefill 10000 and used walletpassphrase pass 10, which resulted in:\r\n\r\nOutput in debug window - RPC console (Bitcoin-Qt):\r\n<pre>\r\n11:52:32 keypoolrefill 10000\r\n11:52:34 CWallet::GenerateNewKey() : AddKey failed (code -1)\r\n</pre>\r\n\r\nNo crash for me!",
      "created_at" : "2013-10-28T10:54:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-27202455",
      "id" : 27202455,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-10-28T10:54:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27202455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I can confirm that this bug still exists on 0.8.5",
      "created_at" : "2013-12-01T01:01:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-29564855",
      "id" : 29564855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2013-12-01T01:01:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29564855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/179920?v=3",
         "events_url" : "https://api.github.com/users/arnuschky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arnuschky/followers",
         "following_url" : "https://api.github.com/users/arnuschky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arnuschky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arnuschky",
         "id" : 179920,
         "login" : "arnuschky",
         "organizations_url" : "https://api.github.com/users/arnuschky/orgs",
         "received_events_url" : "https://api.github.com/users/arnuschky/received_events",
         "repos_url" : "https://api.github.com/users/arnuschky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arnuschky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arnuschky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arnuschky"
      }
   },
   {
      "body" : "Is this still a problem with current master?",
      "created_at" : "2014-01-27T10:30:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-33356355",
      "id" : 33356355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2014-01-27T10:30:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/33356355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I have this issue, on Windows with v0.9.1.0-g026a939-beta (64-bit). Luckily dumpprivkey works but it's still annoying. How can I help?",
      "created_at" : "2014-06-02T07:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-44807587",
      "id" : 44807587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2014-06-02T07:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44807587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/311522?v=3",
         "events_url" : "https://api.github.com/users/bobjansen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bobjansen/followers",
         "following_url" : "https://api.github.com/users/bobjansen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bobjansen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bobjansen",
         "id" : 311522,
         "login" : "bobjansen",
         "organizations_url" : "https://api.github.com/users/bobjansen/orgs",
         "received_events_url" : "https://api.github.com/users/bobjansen/received_events",
         "repos_url" : "https://api.github.com/users/bobjansen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bobjansen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bobjansen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bobjansen"
      }
   },
   {
      "body" : "This wallet was on an installation I seldom use and therefore very simple (1 transaction, 1 bitcoin core upgrade). I still have the old wallet, can I help with some diagnostics?",
      "created_at" : "2014-06-09T11:57:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-45483846",
      "id" : 45483846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2014-06-09T11:57:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/45483846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/311522?v=3",
         "events_url" : "https://api.github.com/users/bobjansen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bobjansen/followers",
         "following_url" : "https://api.github.com/users/bobjansen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bobjansen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bobjansen",
         "id" : 311522,
         "login" : "bobjansen",
         "organizations_url" : "https://api.github.com/users/bobjansen/orgs",
         "received_events_url" : "https://api.github.com/users/bobjansen/received_events",
         "repos_url" : "https://api.github.com/users/bobjansen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bobjansen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bobjansen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bobjansen"
      }
   },
   {
      "body" : "@bobjansen so can you reproduce this arbitrarily? how do you do that? does it depend on the specific wallet?",
      "created_at" : "2014-06-09T12:07:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-45484447",
      "id" : 45484447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2014-06-09T12:07:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/45484447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj It seems to depend on this specific wallet. I'm not sure how it got in this state. This is what happens when I use the faulty wallet:\r\n\r\n1. Put it in AppData/Roaming/Bitcoin\r\n2. Start the GUI\r\n3. Wait for it to sync\r\n4. Select the Receive tab \r\n5. Request a payment\r\n6. This happens:\r\n\r\n![screenshot 2014-06-09 21 17 14](https://cloud.githubusercontent.com/assets/311522/3221408/eafe6cf6-f00a-11e3-8742-3bb4ba883cd8.png)\r\nAlternatively, I can do steps 1 to 3 and run keypoolrefill 100 from the console. This gives an error but at least doesn't crash:\r\n\r\n![screenshot 2014-06-09 21 21 13](https://cloud.githubusercontent.com/assets/311522/3221592/cecfb592-f00c-11e3-8362-1b3d3c50a2d4.png)\r\n\r\nClosing also gives the same problem and an extra error message which might be useful:\r\n\r\n![screenshot 2014-06-09 21 28 51](https://cloud.githubusercontent.com/assets/311522/3221552/784bfcb2-f00c-11e3-9566-3d8077cf1c05.png)\r\n\r\nSomething to note: the wallet is not encrypted. As this wallet was only used for this one transaction and I could move the coins elsewhere using my wallet created from the privkey. Therefore I can safely publish the broken wallet for analysis if so desired.",
      "created_at" : "2014-06-09T19:33:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-45533712",
      "id" : 45533712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2014-06-09T19:33:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/45533712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/311522?v=3",
         "events_url" : "https://api.github.com/users/bobjansen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bobjansen/followers",
         "following_url" : "https://api.github.com/users/bobjansen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bobjansen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bobjansen",
         "id" : 311522,
         "login" : "bobjansen",
         "organizations_url" : "https://api.github.com/users/bobjansen/orgs",
         "received_events_url" : "https://api.github.com/users/bobjansen/received_events",
         "repos_url" : "https://api.github.com/users/bobjansen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bobjansen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bobjansen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bobjansen"
      }
   },
   {
      "body" : "Thanks for the offer, but I don't have time to dive deep into berkeleydb specifics.\r\n\r\nFor anyone else coming to this issue, what may work is to run with the option `-salvagewallet`. This dumps the underlying database structure and rebuilds the wallet. Do make sure that you back up your wallet first, as with any every recovery tool) it may make things worse as well.\r\n",
      "created_at" : "2016-02-09T15:33:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2394#issuecomment-181915987",
      "id" : 181915987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2394",
      "updated_at" : "2016-02-09T15:33:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/181915987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
