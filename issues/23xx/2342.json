{
   "assignee" : null,
   "body" : "Basically AcceptBlock() checks IsFinal() for transactions in a block with nHeight of the block being tested, or essentially nBestHeight+1 however CreateNewBlock() was using just nBestHeight, so transactions were being included into blocks one block later than they could be.\r\n\r\nAdditionally the new IsFinal() test in IsStandard() had the same issue, as well as the UI. (ironically, a fix I wrote a few months ago, lead astray by simply watching to see when transactions got mined on testnet)\r\n\r\nThe bug in CreateNewBlock() is especially nasty for fidelity bond sacrifice transactions, because a miner who knew the trick could collect all the fees for himself, one block before anyone else had a chance. (subject to hash power of course)\r\n\r\nAnyway, I should update the patch with unittests and investigate the issue more carefully; for instance, have there ever been any nLockTime'd transactions ever mined in the main chain at the minimum possible block? Also, can the same logic be fixed for time-locked transactions?",
   "closed_at" : "2014-01-27T09:16:57Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 15,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2342/comments",
   "created_at" : "2013-03-04T10:22:01Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2342/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/2342",
   "id" : 11612840,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2342/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 2342,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/2342.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2342",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/2342.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/2342"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Fix off-by-one errors in the interpretation of IsFinal()",
   "updated_at" : "2014-06-13T20:06:10Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2342",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
      "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
      "followers_url" : "https://api.github.com/users/petertodd/followers",
      "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/petertodd",
      "id" : 7042,
      "login" : "petertodd",
      "organizations_url" : "https://api.github.com/users/petertodd/orgs",
      "received_events_url" : "https://api.github.com/users/petertodd/received_events",
      "repos_url" : "https://api.github.com/users/petertodd/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/petertodd"
   }
}
