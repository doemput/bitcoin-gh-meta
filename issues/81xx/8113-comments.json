[
   {
      "body" : "This is a more invasive change than #8097, but concept ACK.\r\n\r\n> Untested.\r\n\r\nLooks like we don't have any RPC tests for `getaddednodeinfo`, nor `addnode` besides `onetry` mode.",
      "created_at" : "2016-05-30T11:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222472213",
      "id" : 222472213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-05-30T11:26:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222472213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Basic testing for getaddednodeinfo/addnode should certainly be added, but the specific case being changed here would be very hard to test without beind able to mock out name resolving...",
      "created_at" : "2016-05-30T12:39:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222483981",
      "id" : 222483981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-05-30T12:39:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222483981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes, agreed. Maybe that's a future possibility after the net refactor. IMO the most important privacy invariant for DNS changes is that we don't ever do DNS queries when `-dns=0` is set. Would be nice to have an auto test of some kind for that.\r\n\r\nIn any case that's a tangent. I think #8097 was nice in that it was only a local change to an (apparently rarely used) RPC call. This involves some regression risk for code outside that as well. On the other hand this is a more thorough solution, and at least one person (@thebluematt) cares about the functionality it seems better to do that.\r\n\r\n@theuni can you take a look?\r\n",
      "created_at" : "2016-05-31T13:15:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222684582",
      "id" : 222684582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-05-31T13:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222684582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Concept ACK. Thanks, @sipa!\r\n\r\nWill review in detail.",
      "created_at" : "2016-05-31T15:39:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222728761",
      "id" : 222728761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-05-31T15:39:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222728761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "\r\nThis looks great. A few notes:\r\n- GetAddedNodeInfo() doesn't check for pnode->fDisconnect. I'm not sure if it needs to bother (probably not).\r\n- ConnectSocketByName() only tries 1 of the resolved results, which seems to conflict with the PR description. Unless I'm reading incorrectly, adding \"foo.com\" which resolves to 10 ips will mean 2 min between tries for its ips, with random collisions mixed in.\r\n- It looks like this will mean up to a 2min lag from addnode rpc to attempted first connection. We can introduce a condvar after https://github.com/bitcoin/bitcoin/pull/8085/commits/fc2561f7803e9b354c152bd4bd92678bd941fcb0 in lieu of the hard-coded wait.\r\n\r\nI'll work on some real testing. Yes, I have planned (for later, not initially) for functionality to spoof resolved results for easier dns testing as part of the net refactor. For now, I'll just spoof system-wide.",
      "created_at" : "2016-06-01T00:21:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222859601",
      "id" : 222859601,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-01T00:21:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222859601",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "> GetAddedNodeInfo() doesn't check for pnode->fDisconnect. I'm not sure if it needs to bother (probably not).\r\n\r\nI don't think that matters. If fDisconnect is set, it tends to be processed quickly.\r\n\r\n> ConnectSocketByName() only tries 1 of the resolved results, which seems to conflict with the PR description. Unless I'm reading incorrectly, adding \"foo.com\" which resolves to 10 ips will mean 2 min between tries for its ips, with random collisions mixed in.\r\n\r\nOnly the random order changed. The old code would consecutively try all IPs from all addnodes, but with an inner loop over the -addnode arguments (with 0.5s delay), and an outer loop (with 120s delay) over the multiple lookup results.\r\n\r\n> It looks like this will mean up to a 2min lag from addnode rpc to attempted first connection. We can introduce a condvar after fc2561f in lieu of the hard-coded wait.\r\n\r\nSounds like a good idea, but that's independent of this PR, right?",
      "created_at" : "2016-06-01T13:44:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-222996363",
      "id" : 222996363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-01T13:44:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222996363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yikes, yet another misreading of this code on my part. I misunderstood the connection logic post-resolve. So nevermind the ConnectSocketByName comment.\r\n\r\nYes, the condvar can come later.",
      "created_at" : "2016-06-01T16:24:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-223047415",
      "id" : 223047415,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-01T16:24:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223047415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@sipa This needs https://github.com/theuni/bitcoin/commit/c22dc8eb0a4a598c159559e7a3140bc6af653c56 in order for 'getaddednodeinfo' to properly report the connected ip.\r\n\r\nTested (via RPC, at least) ACK with the fix above. The rest looks sane. Though I suspect @TheBlueMatt will object to the behavioral change here. IMO it's more sane in that it lines up with my expectations of how this would work, but it breaks the \"addnode a dns entry and it will quickly detect a change and create a new connection\" persistence model.\r\n\r\nI'd like to point out that this logic is also much easier to re-implement in the refactored code, as the internal connection handler doesn't need to keep up with application state. Instead, it will just retry a dns connection any time the current one disconnects.",
      "created_at" : "2016-06-04T01:04:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-223726876",
      "id" : 223726876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-04T01:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223726876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8113#discussion_r65795028"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8113"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65795028"
         }
      },
      "body" : "What Release()s this?",
      "commit_id" : "b395c90728b47c132a176a0a4483cfff9b23b7ca",
      "created_at" : "2016-06-04T01:42:32Z",
      "diff_hunk" : "@@ -400,6 +400,26 @@ CNode* ConnectNode(CAddress addrConnect, const char *pszDest)\n             return NULL;\n         }\n \n+        if (pszDest && addrConnect.IsValid()) {\n+            // It is possible that we already have a connection to the IP/port pszDest resolved to.\n+            // In that case, drop the connection that was just created, and return the existing CNode instead.\n+            // Also store the name we used to connect in that CNode, so that future FindNode() calls to that\n+            // name catch this early.\n+            CNode* pnode = FindNode((CService)addrConnect);\n+            if (pnode)\n+            {\n+                pnode->AddRef();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#discussion_r65795028",
      "id" : 65795028,
      "original_commit_id" : "ea5fa8038b8a2242e9b570b082bb5d2aacbb85df",
      "original_position" : 12,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8113",
      "updated_at" : "2016-06-04T01:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65795028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8113#discussion_r65982938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8113"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65982938"
         }
      },
      "body" : "I just copied the behaviour of the \"// Look for existing connection\" logic above. I assume that ConnectNode always returns something with an incremented refcount that the caller is supposed to deal with.",
      "commit_id" : "b395c90728b47c132a176a0a4483cfff9b23b7ca",
      "created_at" : "2016-06-06T22:42:53Z",
      "diff_hunk" : "@@ -400,6 +400,26 @@ CNode* ConnectNode(CAddress addrConnect, const char *pszDest)\n             return NULL;\n         }\n \n+        if (pszDest && addrConnect.IsValid()) {\n+            // It is possible that we already have a connection to the IP/port pszDest resolved to.\n+            // In that case, drop the connection that was just created, and return the existing CNode instead.\n+            // Also store the name we used to connect in that CNode, so that future FindNode() calls to that\n+            // name catch this early.\n+            CNode* pnode = FindNode((CService)addrConnect);\n+            if (pnode)\n+            {\n+                pnode->AddRef();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#discussion_r65982938",
      "id" : 65982938,
      "original_commit_id" : "ea5fa8038b8a2242e9b570b082bb5d2aacbb85df",
      "original_position" : 12,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8113",
      "updated_at" : "2016-06-06T22:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65982938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, and incorporated @theuni's fix to the RPC output.",
      "created_at" : "2016-06-08T12:23:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-224572793",
      "id" : 224572793,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-08T12:23:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/224572793",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@TheBlueMatt can you give your OK on whether this still supports your use case?",
      "created_at" : "2016-06-09T06:32:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-224811365",
      "id" : 224811365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-09T06:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/224811365",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2016-06-13T21:59:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-225721556",
      "id" : 225721556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-13T21:59:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/225721556",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Nit: let's make the `dummy` argument optional.",
      "created_at" : "2016-06-14T10:28:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-225841921",
      "id" : 225841921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-14T10:28:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/225841921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I don't have any luck using it to connect to hostnames. E.g. when trying to add a testnet seed (which I know for fact is returing valid addresses most of the time):\r\n```\r\n13:31:26 getaddednodeinfo false\r\n\r\n13:31:26\r\n[\r\n  {\r\n    \"addednode\": \"testnet-seed.bitcoin.petertodd.org\",\r\n    \"connected\": false,\r\n    \"addresses\": [\r\n    ]\r\n  }\r\n]\r\n```",
      "created_at" : "2016-06-14T11:32:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-225854445",
      "id" : 225854445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-14T11:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/225854445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Got it to work now, after setting up a fake hostname instead of using a seed, and prodding it a bit:\r\n```\r\n  {\r\n    \"addednode\": \"testnettest.com\",\r\n    \"connected\": true,\r\n    \"addresses\": [\r\n      {\r\n        \"address\": \"52.72.156.74:18333\",\r\n        \"connected\": \"outbound\"\r\n      }\r\n    ]\r\n  }\r\n```",
      "created_at" : "2016-06-14T11:46:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-225857197",
      "id" : 225857197,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-14T11:46:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/225857197",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I'm really not a huge fan of not following DNS changes until after the previous connection dies, but it does not effect me, personally. In any case, all of the addnode logic needs to be better documented somewhere.",
      "created_at" : "2016-06-14T19:38:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-225992741",
      "id" : 225992741,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-14T19:38:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/225992741",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "utACK. I think the new behavior is more useful and explicable.",
      "created_at" : "2016-06-15T10:17:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-226146475",
      "id" : 226146475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-15T10:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/226146475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Not sure if related but this was reported on IRC by @jonasschnelli:\r\n\r\n```\r\n2016-06-13 23:42:03 receive version message: /bitcoinj:0.14.1/: version 70001, blocks=0, us=127.0.0.1:8333, peer=12469\r\n2016-06-13 23:42:03 AdvertiseLocal: advertising address [2a01:4f8:172:10da::2]:8333\r\n2016-06-13 23:42:05 receive version message: /bitcoinj:0.14.2/Bitcoin Wallet:4.55/: version 70001, blocks=416193, us=127.0.0.1:8333, peer=12470\r\n2016-06-13 23:42:05 AdvertiseLocal: advertising address 138.201.55.219:8333\r\n2016-06-13 23:42:06 POTENTIAL DEADLOCK DETECTED\r\n2016-06-13 23:42:06 Previous lock order was:\r\n2016-06-13 23:42:06  pnode->cs_vRecvMsg  net.cpp:1731 (TRY)\r\n2016-06-13 23:42:06  cs_main  main.cpp:4441\r\n2016-06-13 23:42:06  (1) pfrom->cs_filter  main.cpp:4497\r\n2016-06-13 23:42:06  (2) cs_vSend  net.cpp:2437\r\n2016-06-13 23:42:06 Current lock order is:\r\n2016-06-13 23:42:06  (2) pnode->cs_vSend  net.cpp:1750 (TRY)\r\n2016-06-13 23:42:06  cs_main  main.cpp:5693 (TRY)\r\n2016-06-13 23:42:06  pto->cs_inventory  main.cpp:5896\r\n2016-06-13 23:42:06  (1) pto->cs_filter  main.cpp:5919\r\n2016-06-17 13:52:54\r\n",
      "created_at" : "2016-06-17T15:03:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8113#issuecomment-226793701",
      "id" : 226793701,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8113",
      "updated_at" : "2016-06-17T15:03:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/226793701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
