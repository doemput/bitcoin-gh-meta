[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, though fForceProcessing/fRequested doesn't do the thing you think it does, see, eg https://github.com/bitcoin/bitcoin/pull/9352#pullrequestreview-13343287.",
      "created_at" : "2017-10-07T00:17:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-334897045",
      "id" : 334897045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-07T00:17:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334897045",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This is only useful if tip chain work is less than minimum chain work, which I think only happens in IBD?\r\n\r\nEdit: ready more carefully the PR description.\r\n\r\nMaybe we should just ignore unrequested blocks if tip chain work < minimum chain work? This way this test could be moved before `AcceptBlockHeader`?",
      "created_at" : "2017-10-07T07:49:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-334917449",
      "id" : 334917449,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-07T07:52:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334917449",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Concept ACK, though fForceProcessing/fRequested doesn't do the thing you think it does, see, eg #9352 (review).\r\n\r\n@TheBlueMatt Is there a mistake here?  I know we use the fForceProcessing/fRequested in a couple ways but I believe this is correct -- for instance the unusual use of it in compact block processing shouldn't be an issue, because we don't try to reconstruct compact blocks when our chain tip is far behind.  Did I miss a case?",
      "created_at" : "2017-10-07T12:31:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-334931922",
      "id" : 334931922,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-07T12:31:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334931922",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2017-10-08T21:17:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-335039215",
      "id" : 335039215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-08T21:17:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335039215",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar Please see https://github.com/promag/bitcoin/commit/41987988ebde53a7d3a7ba8fb6363b40df6c2271.",
      "created_at" : "2017-10-10T01:01:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-335329419",
      "id" : 335329419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-10T01:01:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335329419",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/commit/f0940e462cb435f10ef6f052dae609655202f245 although @promag's alternative sounds slightly more sensible to me too",
      "created_at" : "2017-10-19T21:53:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338048699",
      "id" : 338048699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-19T21:53:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338048699",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar Indeed. You were right, I was confused, but this does leave the logic being added here super brittle to future changes. For those following along at home, the reason compact blocks always passing fRequested as true doesn't break this is that it does a CanDirectFetch first, which only looks at the timestamp of our chainActive.Tip(). Thus, this logic would be broken if there were any way for an attacker to cheaply feed us a single best-chain block which had a timestamp close to today, though there should be no way to do so as other ways to get the block onto disk (and, thus, to become our chainActive.Tip()) without meeting the nMinimumChainWork test in FindNextBlocksToDownload. This anti-DoS-logic-stradling-validation-and-net_processing stuff irritates me endlessly, but I think this is fine for now (and should likely be backported in 0.15.0.2 if we do one as a part of #11531).\r\n\r\nutACK (didn't review test changes, which will conflict with #11531) f0940e462cb435f10ef6f052dae609655202f245",
      "created_at" : "2017-10-19T23:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338062317",
      "id" : 338062317,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-19T23:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338062317",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Also, maybe add a comment about the CanDirectFetch stuff somewhere.",
      "created_at" : "2017-10-19T23:34:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338066385",
      "id" : 338066385,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-19T23:34:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338066385",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needed a rebase due to a conflict in the test.",
      "created_at" : "2017-10-20T00:39:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338075137",
      "id" : 338075137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-20T00:39:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338075137",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt I added a comment.\r\n\r\n@promag Thanks for the patch and for the review, but I (slightly) prefer the code that I've presented already.  Skipping the call to AcceptBlockHeader doesn't do much in the adversarial case (which is the only case we're concerned about here), because an attacker would just separately deliver the header which we would process and store.  And it seems clearer to me to just put this in the same block with the other checks we do when a block is not requested.",
      "created_at" : "2017-10-20T00:59:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338077654",
      "id" : 338077654,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-20T00:59:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338077654",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 01b52ce.\r\n\r\nNit, I would squash the test with the commit adding the feature.",
      "created_at" : "2017-10-20T08:45:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338145640",
      "id" : 338145640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-20T08:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338145640",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK 01b52cedd42f50a93b40981c91af7c12de6e45ce",
      "created_at" : "2017-10-20T11:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338175941",
      "id" : 338175941,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-20T11:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338175941",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 01b52cedd42f50a93b40981c91af7c12de6e45ce, didnt review the test parts.",
      "created_at" : "2017-10-20T17:25:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11458#issuecomment-338270404",
      "id" : 338270404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11458",
      "updated_at" : "2017-10-20T17:25:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/338270404",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   }
]
