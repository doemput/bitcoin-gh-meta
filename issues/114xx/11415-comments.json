[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142243684"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142243684"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can we rename this variable `keys_or_addresses` (and the same in `addmultisigaddress`) so it's clear that these could be keys or addresses.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-02T20:18:36Z",
      "diff_hunk" : "@@ -301,16 +284,37 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142243684",
      "id" : 142243684,
      "original_commit_id" : "eb95b57eb9f7707ae8e112c8a82bae8991eabcb9",
      "original_position" : 140,
      "path" : "src/rpc/misc.cpp",
      "position" : 137,
      "pull_request_review_id" : 66577958,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142243684",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't love the `only_pubkeys` argument in `_createmultisig_getpubkeys()`. \r\n\r\nI don't really either. I was trying to avoid as much code duplication as possible, but I guess that can't really be avoided.\r\n\r\n> I'm also not a huge fan of passing the address/keys in as a UniValue reference. Is it possible to change `_createmultisig_getpubkeys()` and `_createmultisig_getaddr_pubkeys()` to both take a single string and return a single `CPubKey`? You could then do the iteration over the `UniValue keys_in` outside of the function.\r\n\r\nI'll try doing that.\r\n\r\n> but `addmultisigaddress` calls them the other way round. Is there a reason for that?\r\n\r\nNope.\r\n\r\n> it seems a little gratuitous to change the return type of `addmultisigaddress` (especially without hiding it behind a `-deprecatedrpc` argument). What was the reasoning for that? To not break the tests?\r\n\r\nThat was mostly to not break tests and also because I felt that `addmultisigaddress` should be the wallet version mirror of `createmultisig` so they both should have the same output. I suppose the original behavior could be hidden behind a `-deprecatedrpc` argument but I'm not sure how useful that is. The same information (and more) is being returned.",
      "created_at" : "2017-10-02T20:40:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-333658263",
      "id" : 333658263,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-02T20:40:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333658263",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  the original behavior could be hidden behind a -deprecatedrpc argument but I'm not sure how useful that is.\r\n\r\nThe only reason would be to not break clients that are expecting a string and now receive a JSON object when they upgrade to v0.16. Hiding behind the `-deprecatedrpc` argument give them breathing space to upgrade the client.\r\n\r\nI don't know if this would really be a problem for users, but worth considering.",
      "created_at" : "2017-10-02T20:53:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-333661952",
      "id" : 333661952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-02T20:53:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333661952",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The latest commit changes the loop to happen in the RPC call body and changes the two helper functions to take a single pubkey and string instead of vectors and UniValue. I have also put the old `addmultisigaddress` behavior behind `-deprecatedrpc`.",
      "created_at" : "2017-10-02T23:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-333691062",
      "id" : 333691062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-02T23:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333691062",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142283676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142283676"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Put inside a block?\r\n```cpp\r\n    } else {\r\n#else\r\n    {\r\n#endif\r\n        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\r\n    }\r\n```",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-02T23:45:41Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+                return NullUniValue;\n+            }\n+            if (pwallet) {\n+                _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+            }\n+            _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        } else\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142283676",
      "id" : 142283676,
      "original_commit_id" : "a324a928f291883f48399500a9da8d7f98c98d1c",
      "original_position" : 154,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66623298,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142283676",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142514601"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142514601"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This can be made simpler:\r\n\r\n```\r\n    if (IsDeprecatedRPCEnabled(\"addmultisigaddress\")) {\r\n        // Old-style interface: just return the address\r\n        return EncodeDestination(innerID);\r\n    }\r\n\r\n    // return an object containing the address and redeem script\r\n    UniValue result(UniValue::VOBJ);\r\n    result.pushKV(\"address\", EncodeDestination(innerID));\r\n    result.pushKV(\"redeemScript\", HexStr(inner.begin(), inner.end()));\r\n    return result;\r\n```",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:33:25Z",
      "diff_hunk" : "@@ -1141,13 +1167,35 @@ UniValue addmultisigaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         strAccount = AccountFromValue(request.params[2]);\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+        _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + keys[i].get_str());\n+        }\n+    }\n+\n     // Construct using pay-to-script-hash:\n-    CScript inner = _createmultisig_redeemScript(pwallet, request.params);\n+    CScript inner = _createmultisig_redeemScript(required, pubkeys);\n     CScriptID innerID(inner);\n     pwallet->AddCScript(inner);\n \n     pwallet->SetAddressBook(innerID, strAccount, \"send\");\n-    return EncodeDestination(innerID);\n+\n+    UniValue result(UniValue::VOBJ);\n+    if (IsDeprecatedRPCEnabled(\"addmultisigaddress\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142514601",
      "id" : 142514601,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 85,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142514601",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142514964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142514964"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Suggestion: name this variable `keys_or_addresses`",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:34:44Z",
      "diff_hunk" : "@@ -1141,13 +1167,35 @@ UniValue addmultisigaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         strAccount = AccountFromValue(request.params[2]);\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142514964",
      "id" : 142514964,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 64,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142514964",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There's an implicit assumption here that if `ENABLE_WALLET` is true then there will necessarily be a wallet available. That may be broken by dynamic wallet load/unload. If we allow the wallet to be unloaded then this rpc will stop working.\r\n\r\nThe else statement is also unnecessary (once we reach line 302, then both branches converge to calling `_createmultisig_hex_to_pubkey()`).\r\n\r\nHow about:\r\n\r\n```\r\n#ifdef ENABLE_WALLET\r\n        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\r\n        if (IsDeprecatedRPCEnabled(\"createmultisig\") &&\r\n            EnsureWalletIsAvailable(pwallet, request.fHelp) &&\r\n            pwallet) {\r\n            _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\r\n        }\r\n#endif\r\n```",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:42:40Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517063",
      "id" : 142517063,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 145,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517063",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517121"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517121"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the else branch is unnecessary here. See comment above.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:42:56Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+                return NullUniValue;\n+            }\n+            if (pwallet) {\n+                _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+            }\n+            _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        } else\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517121",
      "id" : 142517121,
      "in_reply_to_id" : 142283676,
      "original_commit_id" : "a324a928f291883f48399500a9da8d7f98c98d1c",
      "original_position" : 154,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517121",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517234"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517234"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you replace these errors with better JSON errors?",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:43:22Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);\n         }\n+        pubkey_out = vchPubKey;\n+    }\n+}\n \n-        // Case 2: hex public key\n-        else\n-#endif\n-        if (IsHex(ks))\n-        {\n-            CPubKey vchPubKey(ParseHex(ks));\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n-        }\n-        else\n-        {\n-            throw std::runtime_error(\" Invalid public key: \"+ks);\n-        }\n+CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys)\n+{\n+    // Gather public keys\n+    if (required < 1) {\n+        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517234",
      "id" : 142517234,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 70,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517234",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517851"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps add a note into the error text here: \"Note that from V0.16, createmultisig no longer accepts addresses. Clients must transition to using addmultisigaddress to create multisig addresses with addresses known to the wallet before upgrading to v0.17. To use the deprecated functionality, start bitcoind with -deprecatedrpc=createmultisig\"\r\n\r\nThis is the error that clients will hit if they're relying on old behaviour, so the error message should be delivered here.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-03T20:45:47Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+                return NullUniValue;\n+            }\n+            if (pwallet) {\n+                _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+            }\n+            _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        } else\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + keys[i].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142517851",
      "id" : 142517851,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 156,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66888337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142517851",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. API change, added the \"Needs release notes\" tag.",
      "created_at" : "2017-10-04T05:32:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-334054124",
      "id" : 334054124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-04T05:32:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334054124",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142593513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142593513"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Agree.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-04T07:00:41Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);\n         }\n+        pubkey_out = vchPubKey;\n+    }\n+}\n \n-        // Case 2: hex public key\n-        else\n-#endif\n-        if (IsHex(ks))\n-        {\n-            CPubKey vchPubKey(ParseHex(ks));\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n-        }\n-        else\n-        {\n-            throw std::runtime_error(\" Invalid public key: \"+ks);\n-        }\n+CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys)\n+{\n+    // Gather public keys\n+    if (required < 1) {\n+        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142593513",
      "id" : 142593513,
      "in_reply_to_id" : 142517234,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 70,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66974069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142593513",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142593730"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142593730"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should have tests for these `JSONRPCError`.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-04T07:02:30Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142593730",
      "id" : 142593730,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 46,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 66974309,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142593730",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed the `else` branch.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:03Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+                return NullUniValue;\n+            }\n+            if (pwallet) {\n+                _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+            }\n+            _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        } else\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991034",
      "id" : 142991034,
      "in_reply_to_id" : 142283676,
      "original_commit_id" : "a324a928f291883f48399500a9da8d7f98c98d1c",
      "original_position" : 154,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67437515,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991034",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991074"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Renamed to `keys_or_addrs`",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:12Z",
      "diff_hunk" : "@@ -1141,13 +1167,35 @@ UniValue addmultisigaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         strAccount = AccountFromValue(request.params[2]);\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991074",
      "id" : 142991074,
      "in_reply_to_id" : 142514964,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 64,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 67437559,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991074",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991090"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991090"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:16Z",
      "diff_hunk" : "@@ -1141,13 +1167,35 @@ UniValue addmultisigaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         strAccount = AccountFromValue(request.params[2]);\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+        _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + keys[i].get_str());\n+        }\n+    }\n+\n     // Construct using pay-to-script-hash:\n-    CScript inner = _createmultisig_redeemScript(pwallet, request.params);\n+    CScript inner = _createmultisig_redeemScript(required, pubkeys);\n     CScriptID innerID(inner);\n     pwallet->AddCScript(inner);\n \n     pwallet->SetAddressBook(innerID, strAccount, \"send\");\n-    return EncodeDestination(innerID);\n+\n+    UniValue result(UniValue::VOBJ);\n+    if (IsDeprecatedRPCEnabled(\"addmultisigaddress\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991090",
      "id" : 142991090,
      "in_reply_to_id" : 142514601,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 85,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 67437582,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991090",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991112"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:20Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);\n         }\n+        pubkey_out = vchPubKey;\n+    }\n+}\n \n-        // Case 2: hex public key\n-        else\n-#endif\n-        if (IsHex(ks))\n-        {\n-            CPubKey vchPubKey(ParseHex(ks));\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n-        }\n-        else\n-        {\n-            throw std::runtime_error(\" Invalid public key: \"+ks);\n-        }\n+CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys)\n+{\n+    // Gather public keys\n+    if (required < 1) {\n+        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991112",
      "id" : 142991112,
      "in_reply_to_id" : 142517234,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 70,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67437605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991112",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991136"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991136"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:25Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991136",
      "id" : 142991136,
      "in_reply_to_id" : 142517063,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 145,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67437634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991136",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:36:30Z",
      "diff_hunk" : "@@ -301,16 +275,41 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\")) {\n+            CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+            if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+                return NullUniValue;\n+            }\n+            if (pwallet) {\n+                _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+            }\n+            _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        } else\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + keys[i].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991160",
      "id" : 142991160,
      "in_reply_to_id" : 142517851,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 156,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67437661,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991160",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991327"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991327"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is that really necessary?",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-05T16:37:10Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r142991327",
      "id" : 142991327,
      "in_reply_to_id" : 142593730,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 46,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67437832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142991327",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r143325742"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143325742"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "IMO yes, should always test success and failure cases as this is an interface others use.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-07T08:09:12Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r143325742",
      "id" : 143325742,
      "in_reply_to_id" : 142593730,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 46,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67828222,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143325742",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r143325892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143325892"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Split in two loops:\r\n```cpp\r\n#ifdef ENABLE_WALLET\r\nCWallet* const pwallet = GetWalletForJSONRPCRequest(request);\r\nif (IsDeprecatedRPCEnabled(\"createmultisig\") && EnsureWalletIsAvailable(pwallet, request.fHelp) && pwallet) {\r\n    // call _createmultisig_addr_to_pubkey for each key\r\n}\r\n#endif // ENABLE_WALLET\r\n\r\n// call _createmultisig_hex_to_pubkey for each key\r\n```",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-07T08:18:21Z",
      "diff_hunk" : "@@ -301,16 +275,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r143325892",
      "id" : 143325892,
      "original_commit_id" : "1e7a0ce6554f140ef2bdb6b1de28bcdce476cff3",
      "original_position" : 143,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 67828376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143325892",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144371508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144371508"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why?",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-12T18:24:40Z",
      "diff_hunk" : "@@ -301,16 +275,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144371508",
      "id" : 144371508,
      "in_reply_to_id" : 143325892,
      "original_commit_id" : "1e7a0ce6554f140ef2bdb6b1de28bcdce476cff3",
      "original_position" : 143,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69020109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144371508",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144376550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144376550"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added a test in `rawtransactions.py`",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-12T18:41:52Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n+#endif\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))\n     {\n-        const std::string& ks = keys[i].get_str();\n-#ifdef ENABLE_WALLET\n-        // Case 1: Bitcoin address and we have full public key:\n-        CTxDestination dest = DecodeDestination(ks);\n-        if (pwallet && IsValidDestination(dest)) {\n-            const CKeyID *keyID = boost::get<CKeyID>(&dest);\n-            if (!keyID) {\n-                throw std::runtime_error(strprintf(\"%s does not refer to a key\", ks));\n-            }\n-            CPubKey vchPubKey;\n-            if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n-                throw std::runtime_error(strprintf(\"no full public key for address %s\", ks));\n-            }\n-            if (!vchPubKey.IsFullyValid())\n-                throw std::runtime_error(\" Invalid public key: \"+ks);\n-            pubkeys[i] = vchPubKey;\n+        CPubKey vchPubKey(ParseHex(hex_in));\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + hex_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144376550",
      "id" : 144376550,
      "in_reply_to_id" : 142593730,
      "original_commit_id" : "a169f17434b9d96de478a6641e6a087be97631e8",
      "original_position" : 46,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69025748,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144376550",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144585495"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144585495"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No need for ENABLE_WALLET macro here.\r\n\r\nFollowing would be equivalent:\r\n\r\n```c++\r\nvoid _createmultisig_addr_to_pubkey(class CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\r\n```\r\n\r\nextern keyword also doesn't actually do anything, but maybe it is useful to make the declaration stand out more.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T15:28:06Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144585495",
      "id" : 144585495,
      "original_commit_id" : "a0e0c4b674b1cde4e754ab0071b81eb8ba3df40a",
      "original_position" : 8,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69265291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144585495",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144590639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144590639"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Guessing it was suggested for efficiency, but I think the code is better the way it is (one loop), since it avoids duplication.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T15:48:31Z",
      "diff_hunk" : "@@ -301,16 +275,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144590639",
      "id" : 144590639,
      "in_reply_to_id" : 143325892,
      "original_commit_id" : "1e7a0ce6554f140ef2bdb6b1de28bcdce476cff3",
      "original_position" : 143,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69265291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144590639",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144593492"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144593492"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There is really no reason for this function to live in the wallet. The CWallet* argument could be changed to a CKeyStore argument and this could just be a generic jsonrpc util function without all the weird ifdef and naming and extern declaration stuff.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T15:59:47Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144593492",
      "id" : 144593492,
      "original_commit_id" : "a0e0c4b674b1cde4e754ab0071b81eb8ba3df40a",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 69265291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144593492",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144624582"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144624582"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sure, that could be done, but is it necessary? Where else would you need to use such a function with a CKeyStore instead of CWallet?",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T18:19:55Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144624582",
      "id" : 144624582,
      "in_reply_to_id" : 144593492,
      "original_commit_id" : "a0e0c4b674b1cde4e754ab0071b81eb8ba3df40a",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 69310896,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144624582",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144624927"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144624927"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed the ifdef here. I'm leaving the `extern` for clarity",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T18:21:29Z",
      "diff_hunk" : "@@ -212,85 +212,59 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+#ifdef ENABLE_WALLET",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144624927",
      "id" : 144624927,
      "in_reply_to_id" : 144585495,
      "original_commit_id" : "a0e0c4b674b1cde4e754ab0071b81eb8ba3df40a",
      "original_position" : 8,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69311297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144624927",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased to fix travis.",
      "created_at" : "2017-10-13T18:21:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-336530573",
      "id" : 336530573,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-13T18:21:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/336530573",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144627469"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144627469"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a suggestion to let you define the two functions together in one place. Please ignore if you don't think this is an improvement, or don't think it is worth the effort.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T18:32:13Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144627469",
      "id" : 144627469,
      "in_reply_to_id" : 144593492,
      "original_commit_id" : "a0e0c4b674b1cde4e754ab0071b81eb8ba3df40a",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 69314305,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144627469",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "sorry @achow101 , you'll also need to change https://github.com/bitcoin/bitcoin/pull/11415/files#diff-8f3a598a6e52799596008ae7c19d1333R23 to use `assert_raises_rpc_error()`",
      "created_at" : "2017-10-13T19:06:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-336541284",
      "id" : 336541284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-13T19:06:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/336541284",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Actually fixed travis this time, I think.",
      "created_at" : "2017-10-13T21:29:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-336572174",
      "id" : 336572174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-13T21:29:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/336572174",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144666019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144666019"
         }
      },
      "author_association" : "MEMBER",
      "body" : "minor nit: Future readers of this test may find it clearer if you add a comment saying that createmultisig can only take keys as inputs, but addmultisigaddress can take a mixture of keys and addrs (as long as the wallet owns those addresses)",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T22:03:26Z",
      "diff_hunk" : "@@ -60,7 +60,12 @@ def run_test(self):\n         addr1Obj = self.nodes[2].validateaddress(addr1)\n         addr2Obj = self.nodes[2].validateaddress(addr2)\n \n-        mSigObj = self.nodes[2].addmultisigaddress(2, [addr1Obj['pubkey'], addr2Obj['pubkey']])\n+        # Tests for createmultisig and addmultisigaddress\n+        assert_raises_rpc_error(-5, \"Invalid public key\", self.nodes[0].createmultisig, 1, [\"01020304\"])\n+        self.nodes[0].createmultisig(2, [addr1Obj['pubkey'], addr2Obj['pubkey']])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144666019",
      "id" : 144666019,
      "original_commit_id" : "897b5c0cfbdbe90c032a980e8567ddca7b499281",
      "original_position" : 7,
      "path" : "test/functional/rawtransactions.py",
      "position" : null,
      "pull_request_review_id" : 69361112,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144666019",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144667505"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144667505"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-13T22:14:29Z",
      "diff_hunk" : "@@ -60,7 +60,12 @@ def run_test(self):\n         addr1Obj = self.nodes[2].validateaddress(addr1)\n         addr2Obj = self.nodes[2].validateaddress(addr2)\n \n-        mSigObj = self.nodes[2].addmultisigaddress(2, [addr1Obj['pubkey'], addr2Obj['pubkey']])\n+        # Tests for createmultisig and addmultisigaddress\n+        assert_raises_rpc_error(-5, \"Invalid public key\", self.nodes[0].createmultisig, 1, [\"01020304\"])\n+        self.nodes[0].createmultisig(2, [addr1Obj['pubkey'], addr2Obj['pubkey']])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r144667505",
      "id" : 144667505,
      "in_reply_to_id" : 144666019,
      "original_commit_id" : "897b5c0cfbdbe90c032a980e8567ddca7b499281",
      "original_position" : 7,
      "path" : "test/functional/rawtransactions.py",
      "position" : null,
      "pull_request_review_id" : 69362719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144667505",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested ACK ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "created_at" : "2017-10-13T22:18:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#issuecomment-336580705",
      "id" : 336580705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11415",
      "updated_at" : "2017-10-13T22:18:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/336580705",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145206971"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145206971"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Dangling \")\" at the end of the err string.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-17T17:59:37Z",
      "diff_hunk" : "@@ -301,16 +273,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\") && EnsureWalletIsAvailable(pwallet, request.fHelp) && pwallet) {\n+            _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+        }\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"Invalid public key: %s Note that from v0.16, createmultisig no longer accepts addresses. Clients must transition to using addmultisigaddress to create multisig addresses with addresses known to the wallet before upgrading to v0.17. To use the deprecated functionality, start bitcoind with -deprecatedrpc=createmultisig)\", keys[i].get_str()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145206971",
      "id" : 145206971,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 148,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69973211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145206971",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145208650"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145208650"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I find this API super weird - its confusing as-is that we will throw if the hex represents an invalid pubkey but not if the string represents an empty string or something non-hex, expecting two functions which might each optioanlly populate pubkey_out to be called back-to-back. Can you add the IsHex() check in createmultisig/addmultisigaddress itself before the call so that you switch which function you call there instead? Then you could just throw a JSONRPCError here if !IsHex. ",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-17T18:05:47Z",
      "diff_hunk" : "@@ -212,85 +212,57 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145208650",
      "id" : 145208650,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 24,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69973211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145208650",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145210159"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145210159"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that pretty much all EnsureWalletIsAvailable does is a null-check on pwallet, so the && pwallet part is pretty redundant here.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-17T18:11:05Z",
      "diff_hunk" : "@@ -301,16 +273,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\") && EnsureWalletIsAvailable(pwallet, request.fHelp) && pwallet) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145210159",
      "id" : 145210159,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 142,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 69973211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145210159",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145239090"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239090"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This error message is somewhat confusing (maybe \"%s is not an address\"), but, also, it'd be nice if this also worked for WitnessV0KeyHash as well.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-17T20:00:58Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)\n+{\n+    CTxDestination dest = DecodeDestination(addr_in);\n+    if (IsValidDestination(dest)) {\n+        const CKeyID *keyID = boost::get<CKeyID>(&dest);\n+        if (!keyID) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"%s does not refer to a key\", addr_in));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145239090",
      "id" : 145239090,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 14,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 69973211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239090",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145239347"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239347"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe we could INTERNAL_ERROR here as wallet should never contain invalid pubkeys (and call the error \"Wallet contains invalid pubkey\" instead).",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-17T20:02:05Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)\n+{\n+    CTxDestination dest = DecodeDestination(addr_in);\n+    if (IsValidDestination(dest)) {\n+        const CKeyID *keyID = boost::get<CKeyID>(&dest);\n+        if (!keyID) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"%s does not refer to a key\", addr_in));\n+        }\n+        CPubKey vchPubKey;\n+        if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"no full public key for address %s\", addr_in));\n+        }\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + addr_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145239347",
      "id" : 145239347,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 69973211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239347",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-18T23:30:16Z",
      "diff_hunk" : "@@ -212,85 +212,57 @@ class CWallet;\n /**\n  * Used by addmultisigaddress / createmultisig:\n  */\n-CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params)\n-{\n-    int nRequired = params[0].get_int();\n-    const UniValue& keys = params[1].get_array();\n+extern void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in);\n \n-    // Gather public keys\n-    if (nRequired < 1)\n-        throw std::runtime_error(\"a multisignature address must require at least one key to redeem\");\n-    if ((int)keys.size() < nRequired)\n-        throw std::runtime_error(\n-            strprintf(\"not enough keys supplied \"\n-                      \"(got %u keys, but need at least %d to redeem)\", keys.size(), nRequired));\n-    if (keys.size() > 16)\n-        throw std::runtime_error(\"Number of addresses involved in the multisignature address creation > 16\\nReduce the number\");\n-    std::vector<CPubKey> pubkeys;\n-    pubkeys.resize(keys.size());\n-    for (unsigned int i = 0; i < keys.size(); i++)\n+void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in)\n+{\n+    if (IsHex(hex_in))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569444",
      "id" : 145569444,
      "in_reply_to_id" : 145208650,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 24,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 70389016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569444",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-18T23:30:20Z",
      "diff_hunk" : "@@ -301,16 +273,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\") && EnsureWalletIsAvailable(pwallet, request.fHelp) && pwallet) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569455",
      "id" : 145569455,
      "in_reply_to_id" : 145210159,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 142,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 70389029,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569455",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569725"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-18T23:32:01Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)\n+{\n+    CTxDestination dest = DecodeDestination(addr_in);\n+    if (IsValidDestination(dest)) {\n+        const CKeyID *keyID = boost::get<CKeyID>(&dest);\n+        if (!keyID) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"%s does not refer to a key\", addr_in));\n+        }\n+        CPubKey vchPubKey;\n+        if (!pwallet->GetPubKey(*keyID, vchPubKey)) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"no full public key for address %s\", addr_in));\n+        }\n+        if (!vchPubKey.IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid public key: \" + addr_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569725",
      "id" : 145569725,
      "in_reply_to_id" : 145239347,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 70389337,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569725",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569820"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569820"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-18T23:32:40Z",
      "diff_hunk" : "@@ -301,16 +273,35 @@ UniValue createmultisig(const JSONRPCRequest& request)\n             \"}\\n\"\n \n             \"\\nExamples:\\n\"\n-            \"\\nCreate a multisig address from 2 addresses\\n\"\n-            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\") +\n+            \"\\nCreate a multisig address from 2 public keys\\n\"\n+            + HelpExampleCli(\"createmultisig\", \"2 \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\") +\n             \"\\nAs a json rpc call\\n\"\n-            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"16sSauSf5pF2UkUwvKGq4qjNRzBZYqgEL5\\\\\\\",\\\\\\\"171sgjn4YtPu27adkKGrdDwzRTxnRkBfKV\\\\\\\"]\\\"\")\n+            + HelpExampleRpc(\"createmultisig\", \"2, \\\"[\\\\\\\"03789ed0bb717d88f7d321a368d905e7430207ebbd82bd342cf11ae157a7ace5fd\\\\\\\",\\\\\\\"03dbc6764b8884a92e871274b87583e6d5c2a58819473e17e107ef3f6aa5a61626\\\\\\\"]\\\"\")\n         ;\n         throw std::runtime_error(msg);\n     }\n \n+    int required = request.params[0].get_int();\n+\n+    // Get the public keys\n+    const UniValue& keys = request.params[1].get_array();\n+    std::vector<CPubKey> pubkeys;\n+    pubkeys.resize(keys.size());\n+    for (unsigned int i = 0; i < keys.size(); ++i) {\n+#ifdef ENABLE_WALLET\n+        CWallet* const pwallet = GetWalletForJSONRPCRequest(request);\n+        if (IsDeprecatedRPCEnabled(\"createmultisig\") && EnsureWalletIsAvailable(pwallet, request.fHelp) && pwallet) {\n+            _createmultisig_addr_to_pubkey(pwallet, pubkeys.at(i), keys[i].get_str());\n+        }\n+#endif\n+        _createmultisig_hex_to_pubkey(pubkeys.at(i), keys[i].get_str());\n+        if (!pubkeys.at(i).IsFullyValid()) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"Invalid public key: %s Note that from v0.16, createmultisig no longer accepts addresses. Clients must transition to using addmultisigaddress to create multisig addresses with addresses known to the wallet before upgrading to v0.17. To use the deprecated functionality, start bitcoind with -deprecatedrpc=createmultisig)\", keys[i].get_str()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145569820",
      "id" : 145569820,
      "in_reply_to_id" : 145206971,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 148,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 70389452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:32:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145569820",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145573122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145573122"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure what even causes this error to happen.",
      "commit_id" : "257d4fd6fb0ff0347284980f61c014c179f579d5",
      "created_at" : "2017-10-18T23:58:30Z",
      "diff_hunk" : "@@ -1098,7 +1098,27 @@ UniValue sendmany(const JSONRPCRequest& request)\n }\n \n // Defined in rpc/misc.cpp\n-extern CScript _createmultisig_redeemScript(CWallet * const pwallet, const UniValue& params);\n+extern CScript _createmultisig_redeemScript(const int required, const std::vector<CPubKey>& pubkeys);\n+extern void _createmultisig_hex_to_pubkey(CPubKey& pubkey_out, const std::string& hex_in);\n+\n+void _createmultisig_addr_to_pubkey(CWallet* const pwallet, CPubKey& pubkey_out, const std::string& addr_in)\n+{\n+    CTxDestination dest = DecodeDestination(addr_in);\n+    if (IsValidDestination(dest)) {\n+        const CKeyID *keyID = boost::get<CKeyID>(&dest);\n+        if (!keyID) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"%s does not refer to a key\", addr_in));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11415#discussion_r145573122",
      "id" : 145573122,
      "in_reply_to_id" : 145239090,
      "original_commit_id" : "ac33d788e2d7dbfdf760f3a620c86eeaf7cff3fd",
      "original_position" : 14,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 70393224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11415",
      "updated_at" : "2017-10-18T23:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145573122",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
