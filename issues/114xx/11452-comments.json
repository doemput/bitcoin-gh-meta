[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ping @jnewbery, @ryanofsky and @TheBlueMatt.",
      "created_at" : "2017-10-04T22:38:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-334309961",
      "id" : 334309961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-04T22:38:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334309961",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142842750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142842750"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I found 'subscribe' a bit misleading here, though it could be that I'm thinking too much.\r\nIt's not merely a standard ZeroMQ subscription; the ZMQSubscriber class created tracks sequence. As it's written, my immediate thought was 'why aren't we just doing `self.subscribe(\"\")`' (pre this commit, the four setsockopt calls could have been replaced with just one).\r\nPerhaps 'create_subscriber' or fluffing up the comment a bit.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T03:48:15Z",
      "diff_hunk" : "@@ -33,121 +57,68 @@ def setup_nodes(self):\n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # At the moment all messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.\n+        # Note that the publishing order is not defined in the documentation and\n+        # is subject to change.\n+        self.zmq_context = zmq.Context()\n+        self.socket = self.zmq_context.socket(zmq.SUB)\n+        self.socket.set(zmq.RCVTIMEO, 60000)\n+        self.socket.connect(self.address)\n+\n+        # Subscribe to all available topics.\n+        self.subscribe(\"hashblock\")\n+        self.subscribe(\"hashtx\")\n+        self.subscribe(\"rawblock\")\n+        self.subscribe(\"rawtx\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142842750",
      "id" : 142842750,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 81,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67263302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142842750",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142842981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142842981"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The subscribers don't actually have independent sockets, perhaps just use self.socket?",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T03:51:12Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):\n+        import zmq\n+        self.socket.setsockopt(zmq.SUBSCRIBE, type.encode('latin-1'))\n+        self.subscribers[type] = ZMQSubscriber(self.socket, self.address)\n+\n+    def receive(self, type):\n+        subscriber = self.subscribers[type]\n+        topic, body, seq = subscriber.socket.recv_multipart()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142842981",
      "id" : 142842981,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 33,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67263302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142842981",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142843513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142843513"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: assert_receive? My initial thought was that you're selectively receiving a type (which makes sense if different sockets, but if the sockets are all identical, you get what you're given, as this code tests)",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T03:58:18Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):\n+        import zmq\n+        self.socket.setsockopt(zmq.SUBSCRIBE, type.encode('latin-1'))\n+        self.subscribers[type] = ZMQSubscriber(self.socket, self.address)\n+\n+    def receive(self, type):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142843513",
      "id" : 142843513,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 31,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67263302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142843513",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142843905"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142843905"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Likely a pre-existing issue, on my box this prevents `python zmq_test.py` running in isolation (works through test_runner because the option already exists). If you wrap it e.g. `os.path.abspath(os.path.dirname(__file__))` (as test_runner.py does) it works.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T04:03:39Z",
      "diff_hunk" : "@@ -24,7 +48,7 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n             self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142843905",
      "id" : 142843905,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 51,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67264458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142843905",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Tested ACK db3b646bac37a54cb09f121b048fcfbb6d522808, few nits above.",
      "created_at" : "2017-10-05T04:05:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-334353048",
      "id" : 334353048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-05T04:05:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334353048",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888382"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888382"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It works for me Ã°ÂÂÂ ",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T09:22:58Z",
      "diff_hunk" : "@@ -24,7 +48,7 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n             self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888382",
      "id" : 142888382,
      "in_reply_to_id" : 142843905,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 51,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67315309,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888382",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888442"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I can rename.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T09:23:14Z",
      "diff_hunk" : "@@ -33,121 +57,68 @@ def setup_nodes(self):\n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # At the moment all messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.\n+        # Note that the publishing order is not defined in the documentation and\n+        # is subject to change.\n+        self.zmq_context = zmq.Context()\n+        self.socket = self.zmq_context.socket(zmq.SUB)\n+        self.socket.set(zmq.RCVTIMEO, 60000)\n+        self.socket.connect(self.address)\n+\n+        # Subscribe to all available topics.\n+        self.subscribe(\"hashblock\")\n+        self.subscribe(\"hashtx\")\n+        self.subscribe(\"rawblock\")\n+        self.subscribe(\"rawtx\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888442",
      "id" : 142888442,
      "in_reply_to_id" : 142842750,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 81,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67315371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888442",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888665"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888665"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I would like to leave it this way so in the future we can have more sockets.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T09:24:18Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):\n+        import zmq\n+        self.socket.setsockopt(zmq.SUBSCRIBE, type.encode('latin-1'))\n+        self.subscribers[type] = ZMQSubscriber(self.socket, self.address)\n+\n+    def receive(self, type):\n+        subscriber = self.subscribers[type]\n+        topic, body, seq = subscriber.socket.recv_multipart()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142888665",
      "id" : 142888665,
      "in_reply_to_id" : 142842981,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 33,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67315628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142888665",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142889692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142889692"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Below feels better to read `foo = self.receive(...)`, no need for the `assert_` IMO.\r\n\r\n> but if the sockets are all identical, you get what you're given\r\n\r\nNot really, if below you swap 2 consecutive receives the test will fail. What comes from the socket has a specific order and we must follow it when reading.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T09:29:07Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):\n+        import zmq\n+        self.socket.setsockopt(zmq.SUBSCRIBE, type.encode('latin-1'))\n+        self.subscribers[type] = ZMQSubscriber(self.socket, self.address)\n+\n+    def receive(self, type):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142889692",
      "id" : 142889692,
      "in_reply_to_id" : 142843513,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 31,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67316847,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142889692",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142889747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142889747"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll check with your suggestion.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T09:29:24Z",
      "diff_hunk" : "@@ -24,7 +48,7 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n             self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142889747",
      "id" : 142889747,
      "in_reply_to_id" : 142843905,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 51,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67316913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142889747",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review @esotericnonsense.",
      "created_at" : "2017-10-05T09:29:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-334411403",
      "id" : 334411403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-05T09:29:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334411403",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142908671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142908671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also should use `os.path.join()`",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T11:07:11Z",
      "diff_hunk" : "@@ -24,7 +48,7 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n             self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142908671",
      "id" : 142908671,
      "in_reply_to_id" : 142843905,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 51,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67339303,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142908671",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142950638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142950638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't like adding these assignments to `set_test_params`.\r\n\r\n- `num_blocks` and `subscribers` can be local variables in `run_test()`\r\n- `address` should be a local variable in `setup_nodes()` and passed into the `ZMQSubscriber` constructor. Conceptually, `address` is the address of the ZMQ subscriber, not the test framework.\r\n\r\n`set_test_params()` should be used for overriding the number of nodes, network topology, etc.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T14:17:35Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142950638",
      "id" : 142950638,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 24,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67389455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142950638",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142951570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142951570"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: remove `At the moment`",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T14:20:40Z",
      "diff_hunk" : "@@ -33,121 +57,68 @@ def setup_nodes(self):\n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # At the moment all messages are received in the same socket which means",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142951570",
      "id" : 142951570,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 68,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67389455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142951570",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142952369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142952369"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As in my comment here https://github.com/bitcoin/bitcoin/pull/11439#discussion_r142474301, I think it makes sense for the subscribe and receive logic to be owned by `ZMQSubscriber`",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T14:23:26Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142952369",
      "id" : 142952369,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 26,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67389455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142952369",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142999932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142999932"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-05T17:12:47Z",
      "diff_hunk" : "@@ -24,7 +48,7 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n             self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r142999932",
      "id" : 142999932,
      "in_reply_to_id" : 142843905,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 51,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67447625,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142999932",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143305195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143305195"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-06T22:16:23Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143305195",
      "id" : 143305195,
      "in_reply_to_id" : 142950638,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 24,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 67805796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143305195",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143604805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143604805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-10T00:02:59Z",
      "diff_hunk" : "@@ -13,9 +13,33 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, address):\n+        self.address = address\n+        self.socket = socket\n+        self.sequence = 0\n+\n class ZMQTest (BitcoinTestFramework):\n     def set_test_params(self):\n+        self.address = \"tcp://127.0.0.1:28332\"\n+        self.num_blocks = 5\n         self.num_nodes = 2\n+        self.subscribers = {}\n+\n+    def subscribe(self, type):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143604805",
      "id" : 143604805,
      "in_reply_to_id" : 142952369,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 26,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 68138999,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143604805",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143604809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143604809"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-10T00:03:02Z",
      "diff_hunk" : "@@ -33,121 +57,68 @@ def setup_nodes(self):\n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # At the moment all messages are received in the same socket which means",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143604809",
      "id" : 143604809,
      "in_reply_to_id" : 142951570,
      "original_commit_id" : "db3b646bac37a54cb09f121b048fcfbb6d522808",
      "original_position" : 68,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 68139006,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143604809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and added a commit to address comments.Will squash after reviews.",
      "created_at" : "2017-10-10T00:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-335321698",
      "id" : 335321698,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-10T00:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335321698",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143774127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143774127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "[type is a builtin](https://docs.python.org/3/library/functions.html#type). Perhaps `notification _type` is better?",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-10T15:59:28Z",
      "diff_hunk" : "@@ -13,6 +13,25 @@\n                                  hash256,\n                                 )\n \n+class ZMQSubscriber:\n+    def __init__(self, socket, type):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r143774127",
      "id" : 143774127,
      "original_commit_id" : "480c4526b845f69072306a047a4718d769403cdd",
      "original_position" : 14,
      "path" : "test/functional/zmq_test.py",
      "position" : null,
      "pull_request_review_id" : 68335406,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-10T22:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143774127",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery Thanks, renamed to `topic`. Now squashed.",
      "created_at" : "2017-10-10T22:50:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-335630899",
      "id" : 335630899,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-10T22:50:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335630899",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144096057"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144096057"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The ZMQSubscriber class makes it harder for the test to work if topics are sent in a different order.\r\n\r\nCan you take a look at and consider squashing 3668dcdd5a7a12dea0ce5fd9a1d7d17ade0f7b75, which builds on your change, but gets rid of ZMQSubscriber, shortens the test, and lets it pass regardless of ordering of messages from different topics?",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-11T18:25:21Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144096057",
      "id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 68705364,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-11T18:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144096057",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144220827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144220827"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky Thanks for the time spent on this. For the moment we want this test to fail if the order changes, see https://github.com/bitcoin/bitcoin/pull/11439#issuecomment-334181141.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-12T08:16:23Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144220827",
      "id" : 144220827,
      "in_reply_to_id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 68846159,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-12T08:16:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144220827",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144221025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144221025"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "BTW, if the order changes it's only a matter of changing the order of the `sub.receive()` calls.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-12T08:17:27Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144221025",
      "id" : 144221025,
      "in_reply_to_id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 68846393,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-12T08:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144221025",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144273928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144273928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for the input @ryanofsky . I personally think the `ZMQSubscriber` class is clearer, but it was me who pushed @promag in that direction initially, so we should see what other reviewers think.",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-12T12:29:54Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144273928",
      "id" : 144273928,
      "in_reply_to_id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 68906493,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-12T12:29:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144273928",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144345952"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144345952"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "~~~Comment isn't accurate. Should say \"test hangs\" instead of \"test fails.\"~~~\r\n\r\nEDIT: Actually, this isn't true. I was thinking of the other unnecessarily fragile version of the test that used multiple sockets :)",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-12T16:45:11Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144345952",
      "id" : 144345952,
      "in_reply_to_id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 68990969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-12T16:52:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144345952",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Really? How did you test that?",
      "created_at" : "2017-10-12T16:48:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#issuecomment-336196902",
      "id" : 336196902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11452",
      "updated_at" : "2017-10-12T16:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/336196902",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144670938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144670938"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah right, that one hangs :+1:",
      "commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "created_at" : "2017-10-13T22:41:47Z",
      "diff_hunk" : "@@ -24,130 +43,79 @@ def setup_nodes(self):\n         except ImportError:\n             raise SkipTest(\"python3-zmq module not available.\")\n \n-        # Check that bitcoin has been built with ZMQ enabled\n+        # Check that bitcoin has been built with ZMQ enabled.\n         config = configparser.ConfigParser()\n         if not self.options.configfile:\n-            self.options.configfile = os.path.dirname(__file__) + \"/../config.ini\"\n+            self.options.configfile = os.path.abspath(os.path.join(os.path.dirname(__file__), \"../config.ini\"))\n         config.read_file(open(self.options.configfile))\n \n         if not config[\"components\"].getboolean(\"ENABLE_ZMQ\"):\n             raise SkipTest(\"bitcoind has not been built with zmq enabled.\")\n \n-        self.zmqContext = zmq.Context()\n-        self.zmqSubSocket = self.zmqContext.socket(zmq.SUB)\n-        self.zmqSubSocket.set(zmq.RCVTIMEO, 60000)\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"hashtx\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawblock\")\n-        self.zmqSubSocket.setsockopt(zmq.SUBSCRIBE, b\"rawtx\")\n-        ip_address = \"tcp://127.0.0.1:28332\"\n-        self.zmqSubSocket.connect(ip_address)\n-        self.extra_args = [['-zmqpubhashblock=%s' % ip_address, '-zmqpubhashtx=%s' % ip_address,\n-                       '-zmqpubrawblock=%s' % ip_address, '-zmqpubrawtx=%s' % ip_address], []]\n+        # Initialize ZMQ context and socket.\n+        # All messages are received in the same socket which means\n+        # that this test fails if the publishing order changes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11452#discussion_r144670938",
      "id" : 144670938,
      "in_reply_to_id" : 144096057,
      "original_commit_id" : "cc9ee809ad19a63ca284d2fbc327ac1cbcee31e4",
      "original_position" : 63,
      "path" : "test/functional/zmq_test.py",
      "position" : 63,
      "pull_request_review_id" : 69366645,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11452",
      "updated_at" : "2017-10-13T22:41:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144670938",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
