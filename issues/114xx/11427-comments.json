[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142008315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142008315"
         }
      },
      "author_association" : "MEMBER",
      "body" : "should be `pindex->nHeight < chainparams.GetConsensus().BIP34Height;` ?",
      "commit_id" : "912b1a12c2fabaf384e704076ecb9358377c900b",
      "created_at" : "2017-09-30T15:24:58Z",
      "diff_hunk" : "@@ -1712,10 +1712,7 @@ static bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockInd\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n-    assert(pindex->pprev);\n-    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n-    //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n-    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    fEnforceBIP30 = fEnforceBIP30 && pindex->nHeight > chainparams.GetConsensus().BIP34Height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142008315",
      "id" : 142008315,
      "original_commit_id" : "2d438b3f10f568764671ff227c1fc48de4071c0c",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 66315507,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427",
      "updated_at" : "2017-09-30T18:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142008315",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142011574"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142011574"
         }
      },
      "author_association" : "MEMBER",
      "body" : "oops, yeah it's bip34 that we need to enforce it after BIP34Height but not before, not bip30. bip30b is the opposite. Thanks!",
      "commit_id" : "912b1a12c2fabaf384e704076ecb9358377c900b",
      "created_at" : "2017-09-30T17:53:56Z",
      "diff_hunk" : "@@ -1712,10 +1712,7 @@ static bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockInd\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n-    assert(pindex->pprev);\n-    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n-    //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n-    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    fEnforceBIP30 = fEnforceBIP30 && pindex->nHeight > chainparams.GetConsensus().BIP34Height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142011574",
      "id" : 142011574,
      "in_reply_to_id" : 142008315,
      "original_commit_id" : "2d438b3f10f568764671ff227c1fc48de4071c0c",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 66318775,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427",
      "updated_at" : "2017-09-30T18:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142011574",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142019645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142019645"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we could make this an `if` condition before any BIP30 code, and skip all BIP30 codes after BIP34Height. Therefore, we don't need to compare the block hash of every blocks with the BIP30 special cases",
      "commit_id" : "912b1a12c2fabaf384e704076ecb9358377c900b",
      "created_at" : "2017-10-01T03:14:53Z",
      "diff_hunk" : "@@ -1712,10 +1712,7 @@ static bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockInd\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n-    assert(pindex->pprev);\n-    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n-    //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n-    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    fEnforceBIP30 = fEnforceBIP30 && pindex->nHeight < chainparams.GetConsensus().BIP34Height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#discussion_r142019645",
      "id" : 142019645,
      "original_commit_id" : "912b1a12c2fabaf384e704076ecb9358377c900b",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : 8,
      "pull_request_review_id" : 66326892,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11427",
      "updated_at" : "2017-10-01T03:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142019645",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is incorrect -- on a random chain, we can't disable BIP30 merely because BIP34 has activated.  It's possible to have a chain where there are multiple coinbases with the same txid (mined pre-bip34), where the first bip30 violation would be after the bip34 activation height, because the coinbases didn't overwrite each other.  This in turn could prevent reorging back to the honest chain.  NACK.",
      "created_at" : "2017-10-01T18:30:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333396501",
      "id" : 333396501,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-01T18:30:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333396501",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't follow. In a \"random chain\", let's say testnet where bip34 is\nburied in the past, the situation is similar to bitcoin main. On a newly\ncreated \"random chain\", bip34 (or a hf equivalent) can be validated from\nblock 1.\n\nOn 1 Oct 2017 8:31 pm, \"Suhas Daftuar\" <notifications@github.com> wrote:\n\n> This is incorrect -- on a random chain, we can't disable BIP30 merely\n> because BIP34 has activated. It's possible to have a chain where there are\n> multiple coinbases with the same txid (mined pre-bip34), where the first\n> bip30 violation would be after the bip34 activation height, because the\n> coinbases didn't overwrite each other. This in turn could prevent reorging\n> back to the honest chain. NACK.\n>\n> Ã¢ÂÂ\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333396501>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AA9jSkF5wksLWayT_gw9awHBpyTdZX8fks5sn9qLgaJpZM4PpjbI>\n> .\n>\n",
      "created_at" : "2017-10-02T09:25:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333483647",
      "id" : 333483647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-02T09:25:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333483647",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jtimon , say I start from genesis block. Since BIP34 is not checked before BIP34Height, I could make a pre-BIP34 coinbase transaction that includes a post-BIP34Height value in scriptSig, and is perfectly valid. After BIP34Height, with this PR, BIP30 is disabled, so I could replay the same pre-BIP34 coinbase tx.\r\n\r\n@sdaftuar thanks for pointing out. I missed it.",
      "created_at" : "2017-10-02T10:21:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333495761",
      "id" : 333495761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-02T10:21:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333495761",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> say I start from genesis block\r\n\r\nThe genesis block never needs to be checked.\r\n\r\n> After BIP34Height, with this PR, BIP30 is disabled, so I could replay the same pre-BIP34 coinbase tx.\r\n\r\nNot after this PR, after BIP34Height bip30 is always disabled (assuming no huge reorg, an assumption buried deployments is doing for bip34 already anyway).\r\n\r\n> Since BIP34 is not checked before BIP34Height, I could make a pre-BIP34 coinbase transaction that includes a post-BIP34Height value in scriptSig, and is perfectly valid. \r\n\r\nThis is assuming a huge reorg. Otherwise, how can you do this if all pre-bip34 blocks were mined long ago?\r\n\r\n",
      "created_at" : "2017-10-02T10:46:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333500428",
      "id" : 333500428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-02T10:46:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333500428",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jtimon : I mean I start from block 1. Say I make a new block 1 with a post-BIP34 height written in the coinbase. It is valid. Now with this PR this tx could be replayed after BIP34 height. Of course I need a quantum computer to rewrite the chain. But the point is this PR is redefining the consensus and could create a situation where BIP30 is bypassed.",
      "created_at" : "2017-10-02T10:53:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333501712",
      "id" : 333501712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-02T10:53:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333501712",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Just like bip90 redefines consensus. So we agree: the only problem would be\nwith a big reorg. But we disagree on that being a problem or not.\nUnless I'm missing the point about the \"random chain\".\n\nOn 2 Oct 2017 12:54 pm, \"Johnson Lau\" <notifications@github.com> wrote:\n\n> @jtimon <https://github.com/jtimon> : I mean I start from block 1. Say I\n> make a new block 1 with a post-BIP34 height written in the coinbase. It is\n> valid. Now with this PR this tx could be replayed after BIP34 height. Of\n> course I need a quantum computer to rewrite the chain. But the point is\n> this PR is redefining the consensus and could create a situation where\n> BIP30 is bypassed.\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333501712>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AA9jSs2S8BWKAuCnxQTheMQF2a_n33qvks5soMDTgaJpZM4PpjbI>\n> .\n>\n",
      "created_at" : "2017-10-02T11:42:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333510548",
      "id" : 333510548,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-02T11:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333510548",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jtimon someone can feed you a chain during IBD which will result in you being unable to reorg back to the main chain with this change, ie your node will be permanently stuck and you will have to reindex-chainstate (but there will be no error printed to that effect).",
      "created_at" : "2017-10-03T20:24:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-333967090",
      "id" : 333967090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-03T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333967090",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thank you for trying to explain, but, I'm sorry, I still don't get it.\r\nLet's assume the same attack with this change and without it during IBD.\r\n\r\nIn case A (without this change) you're fed a chain that diverges pre-bip34Height and thus continues to validate bip30 after bip34 is being valdiated too. But that chain has less work than the most-work valid chain, so when you see a most-work chain you change.\r\n\r\nIn case B (with this change) you're fed a chain that diverges pre-bip34Height but after this change bip30 will stop being validated after bip34Height because one is still validating bip34 anyway. But that chain has less work than the most-work valid chain, so when you see a most-work chain you change.\r\n\r\nI'm sorry but I don't see how this changes anything for the IBD attack case either.\r\nWhat am I missing?\r\n\r\n\r\n",
      "created_at" : "2017-10-04T02:25:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334033122",
      "id" : 334033122,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-04T02:25:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334033122",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jtimon (someone correct me if im wrong but this is what I think is the issue): if before BIP34 activation, you mine a block with a post-BIP34 blockheight in coinbase, and then replay it after BIP30 stops being validated, that replay is valid on that chain (like @jl2012 said) and the replay overwrites the original transaction. I believe it's this overwriting which makes the reorg impossible, because you've replaced the original transaction?",
      "created_at" : "2017-10-05T10:23:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334424316",
      "id" : 334424316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-05T10:23:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334424316",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Or, just generally, after this change, I can feed an IBD node a two-block chain: start with the real block 1, then a block 2 which duplicates the block 1 coinbase. Now the node will (eventually) try to reorg to the real chain and find itself with a UTXO set which is missing the block 1 coinbase output!",
      "created_at" : "2017-10-05T21:30:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334597791",
      "id" : 334597791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-05T21:30:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334597791",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt what wouldn't be possible below BIP34Height though because BIP30 is still enforced right? You'd have to feed the bad block in after BIP34Height on the bad chain wouldn't you?",
      "created_at" : "2017-10-05T21:46:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334601229",
      "id" : 334601229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-05T21:46:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334601229",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MeshCollider Oh, indeed, yes, your original description is accurate, not mine.",
      "created_at" : "2017-10-05T22:17:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334607616",
      "id" : 334607616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-05T22:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334607616",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Alright, thanks again for the explanations. I believe I may actually being explained this before but forgot the part about not needing a huge reorg. Sorry for the noise, closing.\r\n",
      "created_at" : "2017-10-06T13:37:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11427#issuecomment-334757254",
      "id" : 334757254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11427",
      "updated_at" : "2017-10-06T13:37:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334757254",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
