[
   {
      "body" : "concept ACK",
      "created_at" : "2015-10-30T04:10:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-152410813",
      "id" : 152410813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-10-30T04:10:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152410813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "Didnt look too closely, but the last commit seems reasonable.",
      "created_at" : "2015-11-05T22:18:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-154213045",
      "id" : 154213045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-05T22:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/154213045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Needs rebase",
      "created_at" : "2015-11-10T20:32:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-155557097",
      "id" : 155557097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-10T20:32:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/155557097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Rebased",
      "created_at" : "2015-11-10T21:42:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-155575940",
      "id" : 155575940,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-10T21:42:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/155575940",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "utACK.\r\n\r\nFor BIP68 transactions maybe it makes sense to replace the spendscoinbase flag with a minimum height/time at which the transaction becomes valid (which also generalized the wanted behaviour for coinbase-spending transactions).",
      "created_at" : "2015-11-11T07:49:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-155695428",
      "id" : 155695428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-11T07:49:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/155695428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa, @sdaftuar and I discussed adding the BIP68 time and locktime at length.\r\nWe were waiting for the code to finalize, and had gotten hung up on the locktime potentially being quite recent and therefore causing a great many transactions to have all 3 heights recalculated on a reorg.  But now I'm realizing it makes a lot of sense to only include BIP68 and coinbase height, and then separately scan for locktime since its so easy!\r\n\r\nIn any case, I think this should be merged and that should be a future improvement.\r\nI will review shortly.",
      "created_at" : "2015-11-12T20:54:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-156231118",
      "id" : 156231118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-12T20:54:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/156231118",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Nits fixed.  ",
      "created_at" : "2015-11-12T21:00:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-156232309",
      "id" : 156232309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-12T21:00:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/156232309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-11-12T22:28:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-156257517",
      "id" : 156257517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-12T22:28:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/156257517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Rebased",
      "created_at" : "2015-11-17T20:34:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-157498490",
      "id" : 157498490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-17T20:34:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157498490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Easiest to read with [`?w=0`](https://github.com/bitcoin/bitcoin/pull/6915/files?w=0) (omits white space changes).",
      "created_at" : "2015-11-18T00:34:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-157555719",
      "id" : 157555719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-18T00:34:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157555719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "once-over utACK",
      "created_at" : "2015-11-18T00:35:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-157556674",
      "id" : 157556674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-18T00:35:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157556674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "I think this needs an update for MTP, as it appears to be using adjusted time. @TheBlueMatt ",
      "created_at" : "2015-11-22T23:27:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-158818096",
      "id" : 158818096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-22T23:27:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/158818096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Oops -- thanks for catching that.  I thought it might make sense to pull `removeForReorg` out of the mempool and into main, so that we can keep policy code more organized and hopefully duplicate less logic.\r\n\r\nIf this approach seems okay, I'll try to go back and clean up the commit history here.\r\n\r\nping @TheBlueMatt ",
      "created_at" : "2015-11-23T16:02:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-158979876",
      "id" : 158979876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-23T16:02:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/158979876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "I'm not a huge fan. This isnt actually policy code, its code who's behavior is derived from consensus rules, so I dont think it belongs in main. I'd much rather pass the MTP spendable-height to CTxMemPool::...() than to do this all in main.",
      "created_at" : "2015-11-23T20:06:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-159048499",
      "id" : 159048499,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-23T20:06:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159048499",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Ok I tried the smaller change of just passing through the MTP into removeForReorg, is this what you had in mind?",
      "created_at" : "2015-11-23T21:07:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-159064423",
      "id" : 159064423,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-23T21:07:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159064423",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : ">18:22 < BlueMatt> anyway, I'd prefer to not duplicate the code....can we pull that out \r\n>                 into a function?\r\n\r\n@TheBlueMatt: Yeah I also didn't want to duplicate that code, but it seemed like the right way to do that would be to reuse the `CheckFinalTx` function, which does very little, here's what it looks like:\r\n\r\n```\r\nbool CheckFinalTx(const CTransaction &tx, int flags)\r\n{\r\n    AssertLockHeld(cs_main);\r\n\r\n    // By convention a negative value for flags indicates that the\r\n    // current network-enforced consensus rules should be used. In\r\n    // a future soft-fork scenario that would mean checking which\r\n    // rules would be enforced for the next block and setting the\r\n    // appropriate flags. At the present time no soft-forks are\r\n    // scheduled, so no flags are set.\r\n    flags = std::max(flags, 0);\r\n\r\n    // CheckFinalTx() uses chainActive.Height()+1 to evaluate\r\n    // nLockTime because when IsFinalTx() is called within\r\n    // CBlock::AcceptBlock(), the height of the block *being*\r\n    // evaluated is what is used. Thus if we want to know if a\r\n    // transaction can be part of the *next* block, we need to call\r\n    // IsFinalTx() with one more than chainActive.Height().\r\n    const int nBlockHeight = chainActive.Height() + 1;\r\n\r\n    // Timestamps on the other hand don't get any special treatment,\r\n    // because we can't know what timestamp the next block will have,\r\n    // and there aren't timestamp applications where it matters.\r\n    // However this changes once median past time-locks are enforced:\r\n    const int64_t nBlockTime = (flags & LOCKTIME_MEDIAN_TIME_PAST)\r\n                             ? chainActive.Tip()->GetMedianTimePast()\r\n                             : GetAdjustedTime();\r\n\r\n    return IsFinalTx(tx, nBlockHeight, nBlockTime);\r\n}\r\n```\r\n\r\nWe're basically duplicating all the code here (except maybe that `std::max(flags, 0)`; I don't really understand what that is) already, so pulling out the one line to avoid duplicating that doesn't seem worth it...  I'd rather find a way to reuse the whole function (which is what I did in my first attempt).\r\n\r\nMy only other idea here would be to change `CTxMemPool::removeForReorg` to take a \"flags\" argument only, and then invoke `CheckFinalTx` instead of `IsFinalTx`.",
      "created_at" : "2015-11-24T13:10:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-159262203",
      "id" : 159262203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-24T13:10:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159262203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "in #6312 IsFinalTx (renamed LockTime) is responsible for calculating the nBlockTime from flags.\r\nLockTime function can be called by removeForReorg with the passed flag, this would prevent code duplication.\r\n\r\n6312 is ready to merge once it get more ACK, this could be rebased on it, would make things simpler.",
      "created_at" : "2015-11-26T06:24:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-159817924",
      "id" : 159817924,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-26T06:26:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159817924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2015-11-28T12:57:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-160292127",
      "id" : 160292127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-28T12:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160292127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, and I changed the last commit to call `CheckFinalTx`.  I don't love this, but it avoids the code duplication of having all the callers separately calculate what time to pass in.\r\n\r\n@NicolasDorier  We'll want to reimplement this function after #6312, since `LockTime` will be a more expensive function to call.  I'm happy to tackle that when the time comes, but I don't want to rebase this on #6312 since this is tagged for 0.12 and fixes a bug.  For now, I think this formulation should be easy to merge into #6312, since I'm now just passing the flags variable through to `CheckFinalTx`.",
      "created_at" : "2015-11-30T19:51:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6915#issuecomment-160739511",
      "id" : 160739511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6915",
      "updated_at" : "2015-11-30T19:51:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160739511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
