[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6925#discussion_r43576830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6925"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43576830"
         }
      },
      "body" : "This isn't C99, and you already redefine `i` below.  Lets prevent the shadowing and just have: `for (int i = 0; i < numOuts; i++) {`?\r\nAlso, spacing.\r\n\r\n**edit:** we really need a linter on tests, for *new* code",
      "commit_id" : "796240c7ed70547b8d416c2c8b3f2bdf59e983a7",
      "created_at" : "2015-10-31T22:23:54Z",
      "diff_hunk" : "@@ -138,6 +140,30 @@ bool CZMQPublishHashTransactionNotifier::NotifyTransaction(const CTransaction &t\n     return rc == 0;\n }\n \n+bool CZMQPublishOwnedHashTransactionNotifier::NotifyTransaction(const CTransaction &transaction)\n+{\n+    int i, numOuts = transaction.vout.size();\n+    bool owned = false;\n+    for(i=0; i<numOuts; i++){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#discussion_r43576830",
      "id" : 43576830,
      "original_commit_id" : "796240c7ed70547b8d416c2c8b3f2bdf59e983a7",
      "original_position" : 17,
      "path" : "src/zmq/zmqpublishnotifier.cpp",
      "position" : 17,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6925",
      "updated_at" : "2015-10-31T22:28:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43576830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6925#discussion_r43576848"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6925"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43576848"
         }
      },
      "body" : "Yeah, I come from C. It works for me, I just thought it is a handy addition.",
      "commit_id" : "796240c7ed70547b8d416c2c8b3f2bdf59e983a7",
      "created_at" : "2015-10-31T22:26:50Z",
      "diff_hunk" : "@@ -138,6 +140,30 @@ bool CZMQPublishHashTransactionNotifier::NotifyTransaction(const CTransaction &t\n     return rc == 0;\n }\n \n+bool CZMQPublishOwnedHashTransactionNotifier::NotifyTransaction(const CTransaction &transaction)\n+{\n+    int i, numOuts = transaction.vout.size();\n+    bool owned = false;\n+    for(i=0; i<numOuts; i++){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#discussion_r43576848",
      "id" : 43576848,
      "original_commit_id" : "796240c7ed70547b8d416c2c8b3f2bdf59e983a7",
      "original_position" : 17,
      "path" : "src/zmq/zmqpublishnotifier.cpp",
      "position" : 17,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6925",
      "updated_at" : "2015-10-31T22:26:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43576848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9748243?v=3",
         "events_url" : "https://api.github.com/users/BTCDDev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BTCDDev/followers",
         "following_url" : "https://api.github.com/users/BTCDDev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BTCDDev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BTCDDev",
         "id" : 9748243,
         "login" : "BTCDDev",
         "organizations_url" : "https://api.github.com/users/BTCDDev/orgs",
         "received_events_url" : "https://api.github.com/users/BTCDDev/received_events",
         "repos_url" : "https://api.github.com/users/BTCDDev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BTCDDev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BTCDDev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BTCDDev"
      }
   },
   {
      "body" : "I'm not sure it's such a good idea to pull in *init.h* and *wallet.h* here; this creates strong dependencies between otherwise fairly modular code.",
      "created_at" : "2015-10-31T22:32:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152778399",
      "id" : 152778399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-10-31T22:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152778399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1492956?v=3",
         "events_url" : "https://api.github.com/users/jmcorgan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jmcorgan/followers",
         "following_url" : "https://api.github.com/users/jmcorgan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jmcorgan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jmcorgan",
         "id" : 1492956,
         "login" : "jmcorgan",
         "organizations_url" : "https://api.github.com/users/jmcorgan/orgs",
         "received_events_url" : "https://api.github.com/users/jmcorgan/received_events",
         "repos_url" : "https://api.github.com/users/jmcorgan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jmcorgan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jmcorgan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jmcorgan"
      }
   },
   {
      "body" : "Also, as can be seen from the Travis failure, the code is not conditionalized for disabling the wallet features in the build.\r\n\r\nOverall, I recommend determining transaction ownership in the calling code outsize of the zmq module and passing it in as a bool to NotifyTransaction().",
      "created_at" : "2015-10-31T22:43:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152778795",
      "id" : 152778795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-10-31T22:43:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152778795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1492956?v=3",
         "events_url" : "https://api.github.com/users/jmcorgan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jmcorgan/followers",
         "following_url" : "https://api.github.com/users/jmcorgan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jmcorgan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jmcorgan",
         "id" : 1492956,
         "login" : "jmcorgan",
         "organizations_url" : "https://api.github.com/users/jmcorgan/orgs",
         "received_events_url" : "https://api.github.com/users/jmcorgan/received_events",
         "repos_url" : "https://api.github.com/users/jmcorgan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jmcorgan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jmcorgan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jmcorgan"
      }
   },
   {
      "body" : "Suggestions:\r\n - move this to a new file `src/zmq/zmqpublishwalletnotifier.cpp` and include in build if wallet is enabled;\r\n - create `src/zmq/zmqpublishwalletnotifier.h` with wallet guard condition;\r\n - rename `pubhashownedtx` to `pubwallethashtx` and `hashownedtx` to `wallethashtx`;\r\n - add `pubwalletrawtx`.",
      "created_at" : "2015-10-31T23:52:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152781538",
      "id" : 152781538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-10-31T23:52:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152781538",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "> Overall, I recommend determining transaction ownership in the calling code outsize of the zmq module and passing it in as a bool to NotifyTransaction().\r\n\r\n~~Agreed, NACK~~",
      "created_at" : "2015-11-01T00:39:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152783530",
      "id" : 152783530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-01T01:33:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152783530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "> > Overall, I recommend determining transaction ownership in the calling code outsize of the zmq module and passing it in as a bool to NotifyTransaction().\r\n\r\n> Agreed, NACK\r\n\r\nDon't agree, that makes `NotifyTransaction()` signature aware of wallet.\r\n\r\nI think this follows the ZeroMQ notifier concept, however it should not be a *core* notifier, but a *wallet* notifier, hence my suggestion to move to a new file.",
      "created_at" : "2015-11-01T01:27:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152785418",
      "id" : 152785418,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-01T01:27:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152785418",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@promag, sorry, you made me realised I misinterpreted @jmcorgan's position.\r\nI meant to say, NACK, I think this should be detected by whatever is listening to the `txpubhash` notifications.  Not in the core code itself.\r\n\r\nIf it must be added, then I absolutely agree the two should be separate, so as to not pollute the separation of concerns RE wallet integration.",
      "created_at" : "2015-11-01T01:33:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152785565",
      "id" : 152785565,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-01T01:34:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152785565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "Making the zmq notification code depend on the wallet moves this in the opposite direction than we're trying to go - loosening the bonds between the core and (any specific) wallet implementation.\r\nSo NACK, IMO.\r\n",
      "created_at" : "2015-11-01T09:01:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152808117",
      "id" : 152808117,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-01T09:01:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152808117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@dcousens you mean `pubhashtx`. I agree with that despite the fact that doing that would lead to lots of RPC calls.",
      "created_at" : "2015-11-01T09:18:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152810898",
      "id" : 152810898,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-01T09:56:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152810898",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "Closing this, as I don't think this is the right way to tackle this. \r\n\r\nOne solution that would be acceptable is for the wallet itself to do zmq notifications, separately from the core e.g. as replacement of `-walletnotify`.\r\n\r\n> I think this follows the ZeroMQ notifier concept, however it should not be a core notifier, but a wallet notifier, hence my suggestion to move to a new file.\r\n\r\nYes.\r\n",
      "created_at" : "2015-11-02T03:25:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6925#issuecomment-152902174",
      "id" : 152902174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6925",
      "updated_at" : "2015-11-02T03:25:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152902174",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
