{
   "assignee" : null,
   "body" : "The check at [txn_doublespend.py, line 113](https://github.com/bitcoin/bitcoin/blob/master/qa/rpc-tests/txn_doublespend.py#L113) passes, but should not.\r\n\r\nTransaction ``doublespend`` is created using ``gather_inputs`` and does not debit account ``foo``.  However, in the course of the test, account metadata is synced to ``doublespend`` from introduced-then-conflicted ``tx1``, causing the test to pass.\r\n\r\nThe old test [txnmall.sh](https://github.com/bitcoin/bitcoin/blob/b5d1b1092998bc95313856d535c632ea5a8f9104/qa/rpc-tests/txnmall.sh) checked that ``SyncMetaData`` protected accounts from the effects of clones that had been received and possibly confirmed, by syncing metadata from the first-seen spend of an input, to all spends of that input.\r\n\r\nThe new test does not introduce a clone, but rather a true (non-clone) double-spend.  ``SyncMetaData`` does not define a clean mapping of accounts for conflicting transactions in general, and no such mapping is really possible.   A conflict may respend several inputs, each of which had a different account in its first-spend.\r\n\r\nI can commit an ``IsEquivalentTo`` check to ``SyncMetaData``, so that only true clones have their metadata synced.  This will cause the test to fail.  The question is, how should the test be updated?  What do we actually want to test regarding double-spends and accounts?\r\n\r\nPing @gavinandresen\r\n",
   "closed_at" : "2015-03-12T05:21:31Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
      "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dgenr8/followers",
      "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dgenr8",
      "id" : 4284124,
      "login" : "dgenr8",
      "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
      "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
      "repos_url" : "https://api.github.com/users/dgenr8/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dgenr8"
   },
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5550/comments",
   "created_at" : "2014-12-27T18:26:11Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5550/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/5550",
   "id" : 52962746,
   "labels" : [
      {
         "color" : "02d7e1",
         "name" : "Wallet",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5550/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 5550,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Test txn_doublespend.py passes, but should not",
   "updated_at" : "2015-03-12T05:21:31Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5550",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
      "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dgenr8/followers",
      "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dgenr8",
      "id" : 4284124,
      "login" : "dgenr8",
      "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
      "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
      "repos_url" : "https://api.github.com/users/dgenr8/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dgenr8"
   }
}
