{
   "assignee" : null,
   "body" : "As discussed a few times in the past, this introduces the notion of a detached OSX signature for release binaries. This produces a final dmg with a signature spliced in. I believe this is as close to determinism as we can get while still signing with a protected key. It also removes almost all margin for error in the build process, since the only variable (the signature) is obviously verifiable. \r\n\r\nFrom the updated readme:\r\nAs of OSX Mavericks (10.9), using an Apple-blessed key to sign binaries is a\r\nrequirement in order to satisfy the new Gatekeeper requirements. Because this\r\nprivate key cannot be shared, we'll have to be a bit creative in order for the\r\nbuild process to remain somewhat deterministic. Here's how it works:\r\n - Builders use gitian to create an unsigned release. This outputs an unsigned\r\n   dmg which users may choose to bless and run. It also outputs an unsigned app\r\n   structure in the form of a tarball, which also contains all of the tools\r\n   that have been previously (deterministically) built in order to create a\r\n   final dmg.\r\n - The Apple keyholder uses this unsigned app to create a detached signature,\r\n   using the script that is also included there.\r\n - Builders feed the unsigned app + detached signature back into gitian. It\r\n   uses the pre-built tools to recombine the pieces into a deterministic dmg.\r\n\r\n@gavinandresen has tested and verified that the output dmg's have valid signatures, and run on OSX 10.0.1.\r\n\r\nThe process to create the key is easy to follow, as is the auditing of the reattachment. It relies on the tools \"pagestuff\" and \"codesign_allocate\" which are built from source as part of our standard build process. These tools pad and update the binary as necessary in preparation for the signature. Then, a dumb \"dd\" is invoked to patch it in.\r\n\r\nI've changed the release-process to reflect a possible workflow using this detached signature. I suspect we'll probably have to run a real (beta) release to see where the kinks are and what could be improved.",
   "closed_at" : "2014-11-26T10:29:38Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 4,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5363/comments",
   "created_at" : "2014-11-25T05:02:45Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5363/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/5363",
   "id" : 49977127,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5363/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 5363,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/5363.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5363",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/5363.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5363"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Osx detached sign",
   "updated_at" : "2014-12-08T20:19:59Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5363",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
      "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theuni/followers",
      "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theuni",
      "id" : 417043,
      "login" : "theuni",
      "organizations_url" : "https://api.github.com/users/theuni/orgs",
      "received_events_url" : "https://api.github.com/users/theuni/received_events",
      "repos_url" : "https://api.github.com/users/theuni/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theuni"
   }
}
