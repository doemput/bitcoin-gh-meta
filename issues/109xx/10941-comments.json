[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Without sleep sometimes the file doesn't have all blocks because `runCommand()` is aync. Any idea to avoid the sleep without pooling or blocking reads?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T11:13:13Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 5 blocks\n+        blocks = self.nodes[0].generate(5)\n+        sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005",
      "id" : 129814005,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 32,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52624772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Replace with `import os`. `os.close` and `os.remove` is used below :-)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T11:57:14Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628",
      "id" : 129821628,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove `assert_raises_jsonrpc`. Not used :-)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T11:57:31Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681",
      "id" : 129821681,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 12,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633180,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: `fd, path = mkstemp(text=True)` will do :-)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T11:58:18Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828",
      "id" : 129821828,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 21,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Concept ACK :-)",
      "created_at" : "2017-07-27T11:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-318341525",
      "id" : 318341525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-27T11:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/318341525",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Lol yes. What do you guys prefer? Import module or symbols?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T12:00:02Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139",
      "id" : 129822139,
      "in_reply_to_id" : 129821628,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We have a winner:\r\n\r\n```\r\n$ git grep -E \"(import os|from os)\" -- \"*.py\" | cut -f2 -d: | sort | uniq -c\r\n     25 import os\r\n      2 import os.path\r\n```",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-27T12:10:21Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979",
      "id" : 129823979,
      "in_reply_to_id" : 129821628,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52635789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@practicalswift thanks for the review. Added a few comments and fixed the nits.",
      "created_at" : "2017-07-27T21:35:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-318493215",
      "id" : 318493215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-27T21:35:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/318493215",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046354"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please use `self.options.tmpdir`, so that files are contained in a single tree for each test.\r\n\r\nAlso nit: Please no whitespace for named args. (`text=True`)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-28T09:13:55Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046354",
      "id" : 130046354,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 24,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52881207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046354",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046878"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please no fixed sleeps. This might be too much time on a fast system or too less time on a slow io system.\r\n\r\nYou could wrap it into a while loop with timeout on failure and break on success. Alternatively there should be some helper function `wait_until` if I am not mistaken.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-28T09:16:37Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+        # the command will append the block hash to file\n+        self.extra_args = [['-blocknotify=echo -n %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 3 blocks\n+        blocks = self.nodes[0].generate(3)\n+\n+        # wait while the command runs asynchronously\n+        time.sleep(3)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046878",
      "id" : 130046878,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 39,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52881207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046878",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130048943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130048943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: whitespace.\r\n\r\nConsider using a linter to catch nits.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-28T09:26:51Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+        # the command will append the block hash to file\n+        self.extra_args = [['-blocknotify=echo -n %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 3 blocks\n+        blocks = self.nodes[0].generate(3)\n+\n+        # wait while the command runs asynchronously\n+        time.sleep(3)\n+\n+        # file content should equal the generated blocks hashes\n+        with open(self.path, 'r') as f:\n+            assert_equal(''.join(blocks), f.read())\n+        ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130048943",
      "id" : 130048943,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 44,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52884053,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130048943",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130049444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130049444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "can assign `self.path` above rather than assign to a local variable `path`",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-28T09:29:15Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130049444",
      "id" : 130049444,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 27,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52884053,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130049444",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130057474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130057474"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`self.options` is not defined at this point.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-07-28T10:13:12Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130057474",
      "id" : 130057474,
      "in_reply_to_id" : 130046354,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 24,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52893737,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130057474",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@MarcoFalke done. However can't get tmpdir in the constructor. Any other suggestion?",
      "created_at" : "2017-07-31T20:05:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319180756",
      "id" : 319180756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:05:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319180756",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "You could try to overwrite setup_network:\n\n```py\ndef setup_network():\n    self.extra_args = [bla]\n    super().setup_network()\n```\n\nOn Mon, Jul 31, 2017 at 10:06 PM, JoÃÂ£o Barbosa <notifications@github.com>\nwrote:\n\n> @MarcoFalke <https://github.com/marcofalke> done. However can't get\n> tmpdir in the constructor. Any other suggestion?\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319180756>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AGGmv0EceWaRTPKc4AFnANOaqKf4O_Jqks5sTjOogaJpZM4OlIuV>\n> .\n>\n",
      "created_at" : "2017-07-31T20:15:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319183328",
      "id" : 319183328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:15:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319183328",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke ty, all comments addressed.",
      "created_at" : "2017-07-31T20:54:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319193521",
      "id" : 319193521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:54:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319193521",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "utACK d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-08-01T04:51:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319267063",
      "id" : 319267063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-01T04:51:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319267063",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130944628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130944628"
         }
      },
      "author_association" : "MEMBER",
      "body" : "A few comments on this loop:\r\n\r\n- I'd make the sleep longer (say 0.1 seconds). I'm also not sure you need the back-off. Just a `time.sleep(0.1)` should be fine.\r\n- The total time allowed for the file to be written is 0.45 seconds. That needs to be longer (up to 10 seconds) since Travis can block i/o for many seconds at a time. See #10072.\r\n- Please make the comment clear about the total time allowed for the loop.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-08-02T17:37:59Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait for expected data length",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130944628",
      "id" : 130944628,
      "original_commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "original_position" : 36,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 53875475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130944628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "@jnewbery done. Also rebased.",
      "created_at" : "2017-08-12T02:03:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-321950628",
      "id" : 321950628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-12T02:03:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321950628",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "Needs rebase",
      "created_at" : "2017-08-12T11:29:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-321975439",
      "id" : 321975439,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-12T11:29:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321975439",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke done.",
      "created_at" : "2017-08-12T13:56:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-321982717",
      "id" : 321982717,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-12T13:56:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321982717",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r132819059"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132819059"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe wait until the file is created? I'd really suggest using some sort of wrapper, like the `wait_until` from `mininode`.\r\n\r\n```py\r\nwait_until(lambda: os.path.isfile(self.path), timeout=1)\r\nwait_until(lambda: os.stat(self.path).st_size >= (block_count * 65), timeout=10)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-08-12T14:25:45Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait at most 10 seconds for expected file size before reading the content\n+        attempts = 0\n+        while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r132819059",
      "id" : 132819059,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 38,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 55944802,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132819059",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "I still believe that this test should be merged with #10966 and the `forknotify.py` test. They're testing very similar functionality and there's a lot of shared code between the three tests.",
      "created_at" : "2017-08-14T17:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-322253225",
      "id" : 322253225,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-14T17:24:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322253225",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r133216090"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133216090"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just to make sure, that this is causing failures on my machine:\r\n\r\n```py\r\n  File \"./test/functional/blocknotify.py\", line 38, in run_test\r\n    while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:\r\nFileNotFoundError: [Errno 2] No such file or directory: '/tmp/bitcoin_test_runner_20170815_171120/blocknotify_621/blocks.txt'\r\n",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-08-15T15:13:27Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait at most 10 seconds for expected file size before reading the content\n+        attempts = 0\n+        while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r133216090",
      "id" : 133216090,
      "in_reply_to_id" : 132819059,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 38,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 56370933,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133216090",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142225936"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142225936"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ping @promag: Are you still working on this?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-02T18:59:25Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait at most 10 seconds for expected file size before reading the content\n+        attempts = 0\n+        while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142225936",
      "id" : 142225936,
      "in_reply_to_id" : 132819059,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 38,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 66557002,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142225936",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142398289"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142398289"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe escape path with `shlex.quote(self.path)`",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-03T13:21:09Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142398289",
      "id" : 142398289,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 29,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 66752655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142398289",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142400104"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142400104"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> ping @promag: Are you still working on this?\r\n\r\nI'm not seeing any errors when I run the test, but this is probably caused by a race between the start of this loop and the first notification. Could be fixed by adding a `not os.path.exists(self.path)` check here, or adding `with open(self.path, \"w\"): pass` to `setup_network`.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-03T13:27:13Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait at most 10 seconds for expected file size before reading the content\n+        attempts = 0\n+        while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142400104",
      "id" : 142400104,
      "in_reply_to_id" : 132819059,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 38,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 66752655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142400104",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142439250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142439250"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indeed. The code I posted a few comments above fixed it for me.\r\n\r\nc.f.\r\n\r\n```py\r\nwait_until(lambda: os.path.isfile(self.path), timeout=1)\r\nwait_until(lambda: os.stat(self.path).st_size >= (block_count * 65), timeout=10)",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-03T15:38:37Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait at most 10 seconds for expected file size before reading the content\n+        attempts = 0\n+        while os.stat(self.path).st_size < (block_count * 65) and attempts < 100:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142439250",
      "id" : 142439250,
      "in_reply_to_id" : 132819059,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 38,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 66800347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142439250",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "As suggested I'll merge the test and use `wait_until`.",
      "created_at" : "2017-10-04T06:59:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-334066565",
      "id" : 334066565,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-04T10:06:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334066565",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142681792"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142681792"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`tmpdir` is used elsewhere (should be secure) and `blocks.txt` doesn't need to be quoted. Is there a strong argument for it?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-04T14:12:49Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142681792",
      "id" : 142681792,
      "in_reply_to_id" : 142398289,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 29,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 67077598,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142681792",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and updated as per suggestions. Still in a separate test file because IMO that should go to a different PR since `forknotify.py` needs to be changed.",
      "created_at" : "2017-10-04T14:14:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-334169226",
      "id" : 334169226,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-04T14:14:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334169226",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142683108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142683108"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Of you mean to quote the command `echo %%s >> %s`?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-04T14:16:54Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142683108",
      "id" : 142683108,
      "in_reply_to_id" : 142398289,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 29,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 67079173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142683108",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142693364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142693364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Quoting the entire command would be incorrect because it is passed literally to [system(3)](http://man7.org/linux/man-pages/man3/system.3.html). Quoting the path is correct because it is being passed as a shell token. Anyway just suggested this in case you wanted the code to be more correct. There are no practical implications (security or otherwise) either way.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-04T14:50:23Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142693364",
      "id" : 142693364,
      "in_reply_to_id" : 142398289,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 29,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 67091716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142693364",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142694324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142694324"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, otherwise it wouldn't work Ã°ÂÂÂ I'm going for simplicity if you don't mind.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-04T14:53:26Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r142694324",
      "id" : 142694324,
      "in_reply_to_id" : 142398289,
      "original_commit_id" : "2b03bc1fb844980ffc67c6eaa52b034e978a9826",
      "original_position" : 29,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 67092878,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142694324",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Please see https://github.com/jnewbery/bitcoin/tree/fork_notify. This adds blocknotify and walletnotify to the existint fork_notify.py test script.",
      "created_at" : "2017-10-04T15:33:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-334195990",
      "id" : 334195990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-04T15:33:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334195990",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143559521"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143559521"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm. I don't think boost::thread guarantees that the thread run in the order they are constructed. Am I wrong?\r\n\r\nThe arrays should have the same content, but a different order.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-09T19:41:20Z",
      "diff_hunk" : "@@ -0,0 +1,40 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, wait_until\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        wait_until(lambda: os.path.isfile(self.path), timeout=1)\n+        # wait at most 10 seconds for expected file size before reading the content\n+        wait_until(lambda: os.stat(self.path).st_size >= (block_count * 65), timeout=10)\n+\n+        # file content should equal the generated blocks hashes\n+        with open(self.path, 'r') as f:\n+            assert_equal(blocks, f.read().splitlines())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143559521",
      "id" : 143559521,
      "original_commit_id" : "e7408a44477f100519ab27283b6838810c8d65eb",
      "original_position" : 37,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 68087752,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143559521",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143606819"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143606819"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Correct, in `-walletnotify` (#10966) there's:\r\n```cpp\r\n            # txids are sorted because there is no order guarantee in notifications\r\n            assert_equal(sorted(txids_rpc), sorted(txids_file))\r\n```\r\nSo I'll do the same here for correctness.",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-10T00:20:08Z",
      "diff_hunk" : "@@ -0,0 +1,40 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, wait_until\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        wait_until(lambda: os.path.isfile(self.path), timeout=1)\n+        # wait at most 10 seconds for expected file size before reading the content\n+        wait_until(lambda: os.stat(self.path).st_size >= (block_count * 65), timeout=10)\n+\n+        # file content should equal the generated blocks hashes\n+        with open(self.path, 'r') as f:\n+            assert_equal(blocks, f.read().splitlines())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143606819",
      "id" : 143606819,
      "in_reply_to_id" : 143559521,
      "original_commit_id" : "e7408a44477f100519ab27283b6838810c8d65eb",
      "original_position" : 37,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 68141197,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143606819",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery Picked your branch and added a commit that adds `-rescan` to `node[1]` (needs squash).\r\n\r\n@MarcoFalke the block sort was already on the @jnewbery branch.",
      "created_at" : "2017-10-10T00:37:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335326121",
      "id" : 335326121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T00:42:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335326121",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested ACK 6d9c1593497e9f295b5f335c7c7a0df7966d7590. As you've pointed out, should be squashed prior to merge.",
      "created_at" : "2017-10-10T16:51:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335537770",
      "id" : 335537770,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T16:51:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335537770",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery Done.",
      "created_at" : "2017-10-10T22:39:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335628997",
      "id" : 335628997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T22:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335628997",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143872241"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143872241"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You are also testing -walletnotify, could you please update the comment?",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-10T22:42:16Z",
      "diff_hunk" : "@@ -0,0 +1,86 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the -alertnotify and -blocknotify options.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143872241",
      "id" : 143872241,
      "original_commit_id" : "22a3487e22804ae915e22b7269712845ec100e45",
      "original_position" : 5,
      "path" : "test/functional/notifications.py",
      "position" : null,
      "pull_request_review_id" : 68448227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143872241",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/226170?v=4",
         "events_url" : "https://api.github.com/users/mess110/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mess110/followers",
         "following_url" : "https://api.github.com/users/mess110/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mess110/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mess110",
         "id" : 226170,
         "login" : "mess110",
         "organizations_url" : "https://api.github.com/users/mess110/orgs",
         "received_events_url" : "https://api.github.com/users/mess110/received_events",
         "repos_url" : "https://api.github.com/users/mess110/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mess110/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mess110/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mess110"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143872357"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143872357"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is the class name still correct? I think it should be something like `NotificationsTest`",
      "commit_id" : "857b32b4b280f13997cf2fa471802ad6a27075fb",
      "created_at" : "2017-10-10T22:42:54Z",
      "diff_hunk" : "@@ -0,0 +1,86 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the -alertnotify and -blocknotify options.\"\"\"\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, wait_until, connect_nodes_bi\n+\n+class ForkNotifyTest(BitcoinTestFramework):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r143872357",
      "id" : 143872357,
      "original_commit_id" : "22a3487e22804ae915e22b7269712845ec100e45",
      "original_position" : 11,
      "path" : "test/functional/notifications.py",
      "position" : null,
      "pull_request_review_id" : 68448227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-10-10T22:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143872357",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/226170?v=4",
         "events_url" : "https://api.github.com/users/mess110/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mess110/followers",
         "following_url" : "https://api.github.com/users/mess110/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mess110/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mess110",
         "id" : 226170,
         "login" : "mess110",
         "organizations_url" : "https://api.github.com/users/mess110/orgs",
         "received_events_url" : "https://api.github.com/users/mess110/received_events",
         "repos_url" : "https://api.github.com/users/mess110/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mess110/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mess110/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mess110"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@mess110 Done, thank you.",
      "created_at" : "2017-10-10T22:45:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335630068",
      "id" : 335630068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T22:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335630068",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/10941/commits/857b32b4b280f13997cf2fa471802ad6a27075fb\r\n\r\n(or the squashed version of this)",
      "created_at" : "2017-10-10T22:49:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335630812",
      "id" : 335630812,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T22:49:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335630812",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/226170?v=4",
         "events_url" : "https://api.github.com/users/mess110/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mess110/followers",
         "following_url" : "https://api.github.com/users/mess110/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mess110/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mess110",
         "id" : 226170,
         "login" : "mess110",
         "organizations_url" : "https://api.github.com/users/mess110/orgs",
         "received_events_url" : "https://api.github.com/users/mess110/received_events",
         "repos_url" : "https://api.github.com/users/mess110/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mess110/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mess110/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mess110"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think makes sense to have individual commits.",
      "created_at" : "2017-10-10T22:52:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335631238",
      "id" : 335631238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-10T22:52:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335631238",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> I think makes sense to have individual commits.\r\n\r\nCertainly if multiple authors are involved. And the different commits concern different aspects.\r\n\r\nWhat we want to avoid with squashing is sequential commits like \"fix the previous commit\" which are internal to the author's working and are only confusing when reading the history. But that's not the case here.\r\n\r\nutACK 857b32b",
      "created_at" : "2017-10-11T09:24:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-335750516",
      "id" : 335750516,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-10-11T09:26:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335750516",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
