[
   {
      "body" : "I think you missed something. There are three directories that matter:\r\n* $DATADIR/blocks (raw blocks)\r\n* $DATADIR/blocks/index (LevelDB database with information about raw blocks)\r\n* $DATADIR/chainstate (LevelDB database that holds the UTXO set)\r\n\r\nThe first is high-bandwidth, low IO. The second has hardly any activity at all. The third is where all activity happens, and is critical for performance.\r\n\r\nYou should not separate the blocks from the blocks/index directory, as things may get ugly if they're out of sync. You can however put the chainstate on a faster/smaller device.",
      "created_at" : "2017-07-25T00:53:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-317596359",
      "id" : 317596359,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10922",
      "updated_at" : "2017-07-25T00:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317596359",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Hi @sipa, thank you very much for the prompt follow up.  Per your feedback, I have updated the doc to explicitly call out that chainstate folder must also stay on a fast (internal) disk.  The \"file-partition.md\" notes I made should describe:\r\n\r\n- Installing $datadir to local internal disk (so \"chainstate\" will never need to move).\r\n- Start/stop bitcoind (though maybe this isn't necessary).\r\n- Move the \"index\" files up one folder level. \r\n- Move the \"blocks\" folder off the internal disk.\r\n- Go to the new external \"blocks\" folder and soft-link back to the new \"index\" location.\r\n- Go to the original internal drive \"data\" location and link the now external \"blocks\" folder.\r\n\r\nAgain, the \"chainstate\" folder remains on the internal disk and never needs to move.\r\n\r\nAgain these \"file-partition.md\" notes are not the direct route I took, but (if correct) might save _the next person_ considerable delay in initial blockchain synchronization.\r\n\r\nTo your point even though these low-capacity/high-IOfrequency LevelDb and high-capacity/low-IOfrequency blockchain files are physically separated on separate disks, _they are kept in sync via the soft links_ created.\r\n\r\n_Maybe ultimately a more natural configuration of these files would be to have the \"index\" folder up a level to start with._  That's what makes moving these folders confusing in my opinion.\r\n\r\nThank you again very much for the prompt feedback, very flattering, thanks.",
      "created_at" : "2017-07-25T01:14:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-317599566",
      "id" : 317599566,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10922",
      "updated_at" : "2017-07-25T15:42:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317599566",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/29764807?v=4",
         "events_url" : "https://api.github.com/users/jimhashhq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimhashhq/followers",
         "following_url" : "https://api.github.com/users/jimhashhq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimhashhq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimhashhq",
         "id" : 29764807,
         "login" : "jimhashhq",
         "organizations_url" : "https://api.github.com/users/jimhashhq/orgs",
         "received_events_url" : "https://api.github.com/users/jimhashhq/received_events",
         "repos_url" : "https://api.github.com/users/jimhashhq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimhashhq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimhashhq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimhashhq"
      }
   },
   {
      "body" : "\"file-partition.md\"has been updated to highlight the need to keep \"chainstate\" folder on a fast (internal) drive in addition to \"index\" files as per @sipa.  Thanks @fanquake for adding the label.   This issue seems also related to \"installation\" and/or \"configuration\"; I did not see either of these as bitcoin project label categories, was thinking they might prove useful as well.  Thank you both for your guidance.",
      "created_at" : "2017-07-25T15:57:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-317784348",
      "id" : 317784348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10922",
      "updated_at" : "2017-07-25T15:57:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317784348",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/29764807?v=4",
         "events_url" : "https://api.github.com/users/jimhashhq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimhashhq/followers",
         "following_url" : "https://api.github.com/users/jimhashhq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimhashhq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimhashhq",
         "id" : 29764807,
         "login" : "jimhashhq",
         "organizations_url" : "https://api.github.com/users/jimhashhq/orgs",
         "received_events_url" : "https://api.github.com/users/jimhashhq/received_events",
         "repos_url" : "https://api.github.com/users/jimhashhq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimhashhq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimhashhq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimhashhq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130450125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130450125"
         }
      },
      "body" : "Instead of killing the process, you should use `bitcoin-cli stop`. ",
      "commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "created_at" : "2017-07-31T20:16:47Z",
      "diff_hunk" : "@@ -0,0 +1,53 @@\n+# File Partition:\n+Since the blockchain is around ~140GB, storage of large files on an external drive is convenient.  If this is not done properly, the external drive will also contain high i/o-frequency LevelDB index files, protracting time for initial blockchain synchronization. This document describes how partition datadir files between the high-frequency/low-capacity \"index\" files and the low-frequency/high-capacity \"blocks\" files. Examples are given for macOS, but Linux / Windows should be similar. These instructions result in the following physical folder rearrangement:\n+\n+| Original Location       | New Location | Capacity Needs | i/o Frequency  |\n+| ----------------------- | ------------ | -------------- | -------------- |\n+| ${datadir}/blocks/index | ${datadir}   | low            | high           |\n+| ${datadir}/blocks       | ${EXTERAL}   | high           | low            |\n+| ${datadir}/chainstate   | n/a          | low            | high           |\n+\n+Note: the chainstate folder will not move if these instructions are followed closely.  Like the index folder, chainstate contains very high frequency LevelDB files and must remain on a fast (internal) disk if reasonable syncronization time is to be expected.\n+\n+Change \"coinadm\" in the following as appropriate for your Bitcoin administrative account.\n+\n+1) Start bitcoind with --datadir pointing to your internal drive:\n+\n+        bitcoind -daemon -conf=macos-bitcoin.conf -datadir=/Users/coinadm/local/bitcoin/data\n+\n+Let it run for a few minutes, or long enough that it has started syncho-\n+   nizing.  Either tail the debug.log, or watch the blocks folder:\n+   \n+        ls -l /Users/coinadm/local/bitcoin/data/blocks/blk00000.dat\n+        -rw-------  1 coinadm  staff  134191893 Jul 27 11:31 /Users/coinadm/local/data/blocks/blk00000.dat\n+\n+2) Stop bitcoind, so that we can rearrange some datadir folders:\n+\n+       kill -QUIT `cat /Volumes/WD-Passport-Mac/bitcoin/data/bitcoind.pid`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130450125",
      "id" : 130450125,
      "original_commit_id" : "3c0377db483c50c5a9aecfc4684d6329951a1c7c",
      "original_position" : 26,
      "path" : "doc/file-partition.md",
      "position" : null,
      "pull_request_review_id" : 53327684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922",
      "updated_at" : "2017-08-02T19:24:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130450125",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130450219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130450219"
         }
      },
      "body" : "What's with the muptiple languages here?",
      "commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "created_at" : "2017-07-31T20:17:11Z",
      "diff_hunk" : "@@ -0,0 +1,53 @@\n+# File Partition:\n+Since the blockchain is around ~140GB, storage of large files on an external drive is convenient.  If this is not done properly, the external drive will also contain high i/o-frequency LevelDB index files, protracting time for initial blockchain synchronization. This document describes how partition datadir files between the high-frequency/low-capacity \"index\" files and the low-frequency/high-capacity \"blocks\" files. Examples are given for macOS, but Linux / Windows should be similar. These instructions result in the following physical folder rearrangement:\n+\n+| Original Location       | New Location | Capacity Needs | i/o Frequency  |\n+| ----------------------- | ------------ | -------------- | -------------- |\n+| ${datadir}/blocks/index | ${datadir}   | low            | high           |\n+| ${datadir}/blocks       | ${EXTERAL}   | high           | low            |\n+| ${datadir}/chainstate   | n/a          | low            | high           |\n+\n+Note: the chainstate folder will not move if these instructions are followed closely.  Like the index folder, chainstate contains very high frequency LevelDB files and must remain on a fast (internal) disk if reasonable syncronization time is to be expected.\n+\n+Change \"coinadm\" in the following as appropriate for your Bitcoin administrative account.\n+\n+1) Start bitcoind with --datadir pointing to your internal drive:\n+\n+        bitcoind -daemon -conf=macos-bitcoin.conf -datadir=/Users/coinadm/local/bitcoin/data\n+\n+Let it run for a few minutes, or long enough that it has started syncho-\n+   nizing.  Either tail the debug.log, or watch the blocks folder:\n+   \n+        ls -l /Users/coinadm/local/bitcoin/data/blocks/blk00000.dat\n+        -rw-------  1 coinadm  staff  134191893 Jul 27 11:31 /Users/coinadm/local/data/blocks/blk00000.dat\n+\n+2) Stop bitcoind, so that we can rearrange some datadir folders:\n+\n+       kill -QUIT `cat /Volumes/WD-Passport-Mac/bitcoin/data/bitcoind.pid`\n+\n+3) Move the \"index\" folder up one level (so that it may remain on the internal drive). Like the \n+      \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks/index /Users/coinadm/local/bitcoin/data/\n+\n+4) Next, move the Bitcoin blockchain blocks folder off the internal drive:\n+   \n+          mkdir /Volumes/WD-Passport-Mac/bitcoin \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks /Volumes/WD-Passport-Mac/bitcoin \n+\n+Finally, set up soft links to restore the original folder structure:\n+   \n+| Folder Name              | Link Name           |\n+| ------------------------ | ------------------- |\n+| ${EXTERNAL}/blocks/index | ${datadir}/../index |\n+| ${datadir}/blocks        | ${EXTERAL}/blocks   |\n+\n+5) Replace the original index folder location with a soft link:\n+      \n+          ln -s /Users/coinadm/local/bitcoin/index /Volumes/WD-Passport-Mac/bitcoin/blocks/index \n+\n+6) Replace the original index folder location with a soft link:\n+      \n+          ln -s /Volumes/WD-Passport-Mac/bitcoin/blocks /Users/coinadm/local/bitcoin/data/blocks\n+\n+ Ã¦Â³Â¨Ã¦ÂÂ - Nota - Note - Ã Â¤Â§Ã Â¥ÂÃ Â¤Â¯Ã Â¤Â¾Ã Â¤Â¨ Ã Â¤Â¦Ã Â¥ÂÃ Â¤Â - Ã¯Â»Â¢Ã¯Â»Â Ã¯ÂºÂ£Ã¯Â»Â®Ã¯Â»ÂÃ¯ÂºÂ - ÃÂ¼ÃÂµÃÂÃÂºÃÂ° ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130450219",
      "id" : 130450219,
      "original_commit_id" : "3c0377db483c50c5a9aecfc4684d6329951a1c7c",
      "original_position" : 52,
      "path" : "doc/file-partition.md",
      "position" : 52,
      "pull_request_review_id" : 53327684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922",
      "updated_at" : "2017-08-02T19:24:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130450219",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130980902"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130980902"
         }
      },
      "body" : "Again, good question, thank you.  To me, the \"key finding\" here (if any, really) is simply that the \"index\" folder by default is nested *within* the \"blocks\" folder, unlike the \"chainstate\" folder which is a sibling folder of \"blocks\".  This *slightly* complicates moving the \"blocks\" folder off of the internal disk to an external disk; my apologies for repeating the obvious.  Database administrators out there (me included) might argue that this nested folder configuration is less desirable as it complicates physical separation of high-capacity/low-frequency block files from the lower-capacity/higher-frequency index (and chainstate) LevelDB files.\r\nWhen I open the hood to my car there are warnings labels on the radiator cap, etc., etc.., and these labels are in multiple languages to point out appropriate cautions to naive vehicle operators who may have never looked under the hood or checked a radiator.  I'm taking inspiration from this and wanted to (hopefully) say \"Note\" in 1/2 dozen or so most common languages by usage.  Also, I want to be especially friendly in this day and age; I feel like we could all use it.\r\nIn closing, I hope it doesn't sound like I am trying to \"make a mountain out of a molehill\" here, it's not that at all; I just wanted to share my personal experiences in hopes of further facilitating ease of use of the system.  Overall I find the system to be very easy to work with and well thought out.",
      "commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "created_at" : "2017-08-02T20:02:45Z",
      "diff_hunk" : "@@ -0,0 +1,53 @@\n+# File Partition:\n+Since the blockchain is around ~140GB, storage of large files on an external drive is convenient.  If this is not done properly, the external drive will also contain high i/o-frequency LevelDB index files, protracting time for initial blockchain synchronization. This document describes how partition datadir files between the high-frequency/low-capacity \"index\" files and the low-frequency/high-capacity \"blocks\" files. Examples are given for macOS, but Linux / Windows should be similar. These instructions result in the following physical folder rearrangement:\n+\n+| Original Location       | New Location | Capacity Needs | i/o Frequency  |\n+| ----------------------- | ------------ | -------------- | -------------- |\n+| ${datadir}/blocks/index | ${datadir}   | low            | high           |\n+| ${datadir}/blocks       | ${EXTERAL}   | high           | low            |\n+| ${datadir}/chainstate   | n/a          | low            | high           |\n+\n+Note: the chainstate folder will not move if these instructions are followed closely.  Like the index folder, chainstate contains very high frequency LevelDB files and must remain on a fast (internal) disk if reasonable syncronization time is to be expected.\n+\n+Change \"coinadm\" in the following as appropriate for your Bitcoin administrative account.\n+\n+1) Start bitcoind with --datadir pointing to your internal drive:\n+\n+        bitcoind -daemon -conf=macos-bitcoin.conf -datadir=/Users/coinadm/local/bitcoin/data\n+\n+Let it run for a few minutes, or long enough that it has started syncho-\n+   nizing.  Either tail the debug.log, or watch the blocks folder:\n+   \n+        ls -l /Users/coinadm/local/bitcoin/data/blocks/blk00000.dat\n+        -rw-------  1 coinadm  staff  134191893 Jul 27 11:31 /Users/coinadm/local/data/blocks/blk00000.dat\n+\n+2) Stop bitcoind, so that we can rearrange some datadir folders:\n+\n+       kill -QUIT `cat /Volumes/WD-Passport-Mac/bitcoin/data/bitcoind.pid`\n+\n+3) Move the \"index\" folder up one level (so that it may remain on the internal drive). Like the \n+      \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks/index /Users/coinadm/local/bitcoin/data/\n+\n+4) Next, move the Bitcoin blockchain blocks folder off the internal drive:\n+   \n+          mkdir /Volumes/WD-Passport-Mac/bitcoin \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks /Volumes/WD-Passport-Mac/bitcoin \n+\n+Finally, set up soft links to restore the original folder structure:\n+   \n+| Folder Name              | Link Name           |\n+| ------------------------ | ------------------- |\n+| ${EXTERNAL}/blocks/index | ${datadir}/../index |\n+| ${datadir}/blocks        | ${EXTERAL}/blocks   |\n+\n+5) Replace the original index folder location with a soft link:\n+      \n+          ln -s /Users/coinadm/local/bitcoin/index /Volumes/WD-Passport-Mac/bitcoin/blocks/index \n+\n+6) Replace the original index folder location with a soft link:\n+      \n+          ln -s /Volumes/WD-Passport-Mac/bitcoin/blocks /Users/coinadm/local/bitcoin/data/blocks\n+\n+ Ã¦Â³Â¨Ã¦ÂÂ - Nota - Note - Ã Â¤Â§Ã Â¥ÂÃ Â¤Â¯Ã Â¤Â¾Ã Â¤Â¨ Ã Â¤Â¦Ã Â¥ÂÃ Â¤Â - Ã¯Â»Â¢Ã¯Â»Â Ã¯ÂºÂ£Ã¯Â»Â®Ã¯Â»ÂÃ¯ÂºÂ - ÃÂ¼ÃÂµÃÂÃÂºÃÂ° ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r130980902",
      "id" : 130980902,
      "original_commit_id" : "3c0377db483c50c5a9aecfc4684d6329951a1c7c",
      "original_position" : 52,
      "path" : "doc/file-partition.md",
      "position" : 52,
      "pull_request_review_id" : 53915433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922",
      "updated_at" : "2017-08-02T20:02:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130980902",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/29764807?v=4",
         "events_url" : "https://api.github.com/users/jimhashhq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimhashhq/followers",
         "following_url" : "https://api.github.com/users/jimhashhq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimhashhq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimhashhq",
         "id" : 29764807,
         "login" : "jimhashhq",
         "organizations_url" : "https://api.github.com/users/jimhashhq/orgs",
         "received_events_url" : "https://api.github.com/users/jimhashhq/received_events",
         "repos_url" : "https://api.github.com/users/jimhashhq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimhashhq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimhashhq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimhashhq"
      }
   },
   {
      "body" : "Your document is still suggesting to split the blocks/ directory from the blocks/index/ directory. Please don't do that; it's dangerous (they need to be in sync), and unnecessary (the blocks/index/ directory hardly sees any I/O). You should just suggest to move the chainstate/ to a faster drive compared to blocks/.",
      "created_at" : "2017-08-02T20:06:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-319783071",
      "id" : 319783071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10922",
      "updated_at" : "2017-08-02T20:06:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319783071",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r131016160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/131016160"
         }
      },
      "body" : "At issue still is the value in the last column of the 1st row above (the index file folder \"i/o Frequency\"; is it high or low).  My experience suggests that the index folder files are indeed high frequency, which is really the impetus for this doc; if they were not high frequency I would not have looked into this re-configuration detail.  I only identified this possible re-configuration pitfall (which I had mistakenly made) via bitcoind file usage reported by the following command:\r\n     lsof -p `cat ${datadir}/bitcoind.pid` | grep ldb\\$\r\nThis motivated me to move the subordinate/child \"index\" folder back onto the internal drive and set up the soft links described here.  I did not yet follow though and verify i/o frequency demands of these index LeveDB files (yet).  \r\nI admit the experience related here is qualitative and currently lacks supporting i/o reporting, but is [i]hopefully[/i] nonetheless correct.  \r\nI first moved the entire blocks folder (including the index subfolder) from $datadir to the external disk for internal capacity reasons (basically to save space because I'm cheap), and it synched very very slowly.  Then I looked at open files using \"lsof\" as described above, and saw LevelDB index folder files open on the external USB 3.0 drive.  Moving them as described here sped things up to the point that performance seemed to match that with the default configuration of everything (including the blocks folder) on the internal drive.  Basically I was just doing a simplistic `du -k .` & `ls -lrt blk*.dat` every so often and watching how fast the blk*.dat files were growing in both cases.  So qualitative, and not quantitative (I apologize).  The responsible thing for me to do at this point is to gather quantitative evidence to support this position.   \r\nI'll maybe look for a blockchain indexing or synchronization test that I can run twice; once with the index files *on* the external drive, and again with the index files *off-of* the external drive, while trying to capture i/o frequency statistics as well as wall clock time?  Note that what I described above with the `du -k .` and long listings while watching the wall clock is really what I did above.\r\n\r\nA possible misperception here is that this doc was meant to be some sort of performance advice.  It is not, rather it's really just meant to be a note to help other developers/analysts who (like me) work on very low end commodity hardware yet perform initial synchronization quickly, and without the large-capacity internal disk space requirements. That said, performance minded would likely benefit from moving any high i/o frequency files to the fastest storage available, similar to how traditional file-based databases are tuned.  \r\n\r\nNeither are these notes meant as instructions to backup the blockchain for portability between bitcoin development instances either; as @sipa points out, the \"blocks\" folder 'needs to be kept in sync with the \"index\" folder', rendering the blocks folder useless by itself for backup/portability purposes.  \r\n\r\nMissing from these notes is the (reasonable?) expectation that bitcoind not be started until the external disk is mounted and likewise that the external disk not be dismounted/ejected until bitcoind is shut down.   To this point, I have not yet tried to see what happens, if after running in the configuration suggested here, the operator/developer accidentally tries to start bitcoin w/o the the external storage plugged in; I would hope that the index folder files are not corrupted if the blocks folder is not accessible.\r\n\r\nAlso, I'm still trying to understand the usage patterns of GitHub, like maybe this would have been better if this were reported as an \"issue\", I was tempted to do that, but don't personally see any issues.  This is really more of a \"pitfalls to avoid\" type of document I was hoping might further adoption. \r\n\r\nI do feel like I am onto something (albeit very minor) here.  I do very much appreciate all of the feedback and consideration -- thank you very much.",
      "commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "created_at" : "2017-08-02T22:45:48Z",
      "diff_hunk" : "@@ -0,0 +1,53 @@\n+# File Partition:\n+Since the blockchain is around ~140GB, storage of large files on an external drive is convenient.  If this is not done properly, the external drive will also contain high i/o-frequency LevelDB index files, protracting time for initial blockchain synchronization. This document describes how partition datadir files between the high-frequency/low-capacity \"index\" files and the low-frequency/high-capacity \"blocks\" files. Examples are given for macOS, but Linux / Windows should be similar. These instructions result in the following physical folder rearrangement:\n+\n+| Original Location       | New Location | Capacity Needs | i/o Frequency  |\n+| ----------------------- | ------------ | -------------- | -------------- |\n+| ${datadir}/blocks/index | ${datadir}   | low            | high           |\n+| ${datadir}/blocks       | ${EXTERAL}   | high           | low            |\n+| ${datadir}/chainstate   | n/a          | low            | high           |\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r131016160",
      "id" : 131016160,
      "original_commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "original_position" : 9,
      "path" : "doc/file-partition.md",
      "position" : 9,
      "pull_request_review_id" : 53954085,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922",
      "updated_at" : "2017-08-03T22:53:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/131016160",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/29764807?v=4",
         "events_url" : "https://api.github.com/users/jimhashhq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimhashhq/followers",
         "following_url" : "https://api.github.com/users/jimhashhq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimhashhq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimhashhq",
         "id" : 29764807,
         "login" : "jimhashhq",
         "organizations_url" : "https://api.github.com/users/jimhashhq/orgs",
         "received_events_url" : "https://api.github.com/users/jimhashhq/received_events",
         "repos_url" : "https://api.github.com/users/jimhashhq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimhashhq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimhashhq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimhashhq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r131519672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/131519672"
         }
      },
      "body" : "typo: `EXTERAL`",
      "commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "created_at" : "2017-08-05T10:32:47Z",
      "diff_hunk" : "@@ -0,0 +1,53 @@\n+# File Partition:\n+Since the blockchain is around ~140GB, storage of large files on an external drive is convenient.  If this is not done properly, the external drive will also contain high i/o-frequency LevelDB index files, protracting time for initial blockchain synchronization. This document describes how partition datadir files between the high-frequency/low-capacity \"index\" files and the low-frequency/high-capacity \"blocks\" files. Examples are given for macOS, but Linux / Windows should be similar. These instructions result in the following physical folder rearrangement:\n+\n+| Original Location       | New Location | Capacity Needs | i/o Frequency  |\n+| ----------------------- | ------------ | -------------- | -------------- |\n+| ${datadir}/blocks/index | ${datadir}   | low            | high           |\n+| ${datadir}/blocks       | ${EXTERAL}   | high           | low            |\n+| ${datadir}/chainstate   | n/a          | low            | high           |\n+\n+Note: the chainstate folder will not move if these instructions are followed closely.  Like the index folder, chainstate contains very high frequency LevelDB files and must remain on a fast (internal) disk if reasonable syncronization time is to be expected.\n+\n+Change \"coinadm\" in the following as appropriate for your Bitcoin administrative account.\n+\n+1) Start bitcoind with --datadir pointing to your internal drive:\n+\n+        bitcoind -daemon -conf=macos-bitcoin.conf -datadir=/Users/coinadm/local/bitcoin/data\n+\n+Let it run for a few minutes, or long enough that it has started syncho-\n+   nizing.  Either tail the debug.log, or watch the blocks folder:\n+   \n+        ls -l /Users/coinadm/local/bitcoin/data/blocks/blk00000.dat\n+        -rw-------  1 coinadm  staff  134191893 Jul 27 11:31 /Users/coinadm/local/data/blocks/blk00000.dat\n+\n+2) Stop bitcoind, so that we can rearrange some datadir folders:\n+\n+       bitcoin-cli stop\n+\n+3) Move the \"index\" folder up one level (so that it may remain on the internal drive). Like the \n+      \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks/index /Users/coinadm/local/bitcoin/data/\n+\n+4) Next, move the Bitcoin blockchain blocks folder off the internal drive:\n+   \n+          mkdir /Volumes/WD-Passport-Mac/bitcoin \n+          mv -f /Users/coinadm/local/bitcoin/data/blocks /Volumes/WD-Passport-Mac/bitcoin \n+\n+Finally, set up soft links to restore the original folder structure:\n+   \n+| Folder Name              | Link Name           |\n+| ------------------------ | ------------------- |\n+| ${EXTERNAL}/blocks/index | ${datadir}/../index |\n+| ${datadir}/blocks        | ${EXTERAL}/blocks   |",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#discussion_r131519672",
      "id" : 131519672,
      "original_commit_id" : "281b1b25cc25c82b16d92ffa9c311b44aa47b41e",
      "original_position" : 42,
      "path" : "doc/file-partition.md",
      "position" : 42,
      "pull_request_review_id" : 54513046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10922",
      "updated_at" : "2017-08-05T10:32:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/131519672",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/425166?v=4",
         "events_url" : "https://api.github.com/users/flack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/flack/followers",
         "following_url" : "https://api.github.com/users/flack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/flack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/flack",
         "id" : 425166,
         "login" : "flack",
         "organizations_url" : "https://api.github.com/users/flack/orgs",
         "received_events_url" : "https://api.github.com/users/flack/received_events",
         "repos_url" : "https://api.github.com/users/flack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/flack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/flack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/flack"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> (the blocks/index/ directory hardly sees any I/O). \r\n\r\nExcept with `-txindex` I guess :(",
      "created_at" : "2017-10-04T12:47:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-334143848",
      "id" : 334143848,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10922",
      "updated_at" : "2017-10-04T12:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334143848",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
