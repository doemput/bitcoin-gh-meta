[
   {
      "body" : "Concept ACK, but I'm not sure setting onion proxy to 127.0.0.1:9051 by default is a good idea. \r\nEven if no tor is present it will try and try and keep trying to connect to onions.\r\n\r\nMaybe a better approach would be to have torcontrol set -onion proxy automatically, when it manages to negotiate with tor?\r\n(possibly it could even ask tor what its port it)\r\n",
      "created_at" : "2015-11-24T14:54:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159292023",
      "id" : 159292023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T14:58:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159292023",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "So, the disadvantage with that idea is support for the HS control thing is actually pretty recent, while connecting to 127.0.0.1:9050 works with any Tor version. OTOH, come to think of it there's a valid argument that we want the # of nodes connecting to HS's to grow in line with the number of nodes making them available.",
      "created_at" : "2015-11-24T14:59:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159293195",
      "id" : 159293195,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T14:59:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159293195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "In principle the tor control port authentication/communication works with older versions. It's just the HS creation itself that is recent. If the control connection is also used for other things it could tolerate that failing.",
      "created_at" : "2015-11-24T15:09:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159296547",
      "id" : 159296547,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T15:09:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159296547",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj How about this?\r\n\r\nI looked into getting the proxy info automatically; doesn't look to be trivial as you have to use the GETCONF command on the control port to read the config file values yourself, and what they actually mean for you is non-trivial. I'm inclined to just use the hardcoded default - pretty rare for that to be setup differently.",
      "created_at" : "2015-11-24T15:30:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159304963",
      "id" : 159304963,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T15:30:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159304963",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "(and yeah, the duplication of code is kinda ugly; open to suggestions)",
      "created_at" : "2015-11-24T15:33:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159305729",
      "id" : 159305729,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T15:33:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159305729",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Agree that this may be the best thing to do for now. This sets `-onion` when tor is there, unless an explicit `-onion` proxy was given, or it was explicitly disabled using `-onion=0`.\r\n\r\n(and you are right, actually getting a proxy port from Tor given just the control port seems to be non-trivial! I thought it was just me)\r\n\r\nMaybe also disable the NET_TOR proxy in `disconnected_cb`, *if* it was enabled by this mechanism?\r\n",
      "created_at" : "2015-11-24T16:27:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159323044",
      "id" : 159323044,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T16:30:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159323044",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Concept ACK.  We should do something like this; otherwise we could get a strange result where listening gets commonly setup but we can't connect out to it!",
      "created_at" : "2015-11-24T22:24:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159425603",
      "id" : 159425603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T22:24:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159425603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Concept ACK\n\nOn November 24, 2015 2:24:50 PM PST, Gregory Maxwell <notifications@github.com> wrote:\n>Concept ACK.  We should do something like this; otherwise we could get\n>a strange result where listening gets commonly setup but we can't\n>connect out to it!\n>\n>---\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159425603\n",
      "created_at" : "2015-11-24T22:36:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159428176",
      "id" : 159428176,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-24T22:36:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159428176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "~~@petertodd Not saying it has to be done in this pull, but requesting the proxy port(s) seems easy enough, after experimenting a bit:~~\r\n```\r\n$ nc 127.0.0.1 9051\r\nAUTHENTICATE <hexify(control_auth_cookie)>\r\n250 OK\r\nGETCONF SocksPort\r\n250 SocksPort=9050\r\n```\r\n(see posts below for better option)\r\n",
      "created_at" : "2015-11-25T08:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159536994",
      "id" : 159536994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T10:40:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159536994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj The problem is SocksPort can be in many different formats depending on the local configuration, not to mention multiple lines of SocksPort's. \r\n\r\nRe: disconnected_cb, I'm inclined to just leave the behavior the same as what -onion would do anyway for simplicity.\r\n\r\nRemoved the first two reverted commits; ready for merging.",
      "created_at" : "2015-11-25T17:52:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159686928",
      "id" : 159686928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-25T17:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159686928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "utACK.",
      "created_at" : "2015-11-26T00:47:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159768264",
      "id" : 159768264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T00:47:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159768264",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@petertodd OK, yeah, the option itself is reasonable complicated\r\n```\r\nSOCKSPort [address:]port|unix:path|auto [flags] [isolation flags]\r\n```\r\nIt even has **Set it to \"auto\" to have Tor pick a port for you**. This makes querying this option a no-go. I wonder what the way is to find out what the port is in that case.\r\nHm https://trac.torproject.org/projects/tor/ticket/3076\r\nApparently the official way is:\r\n```\r\nGETINFO net/listeners/socks\r\n250-net/listeners/socks=\"127.0.0.1:9050\"\r\n250 OK\r\n```\r\n",
      "created_at" : "2015-11-26T08:04:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159841772",
      "id" : 159841772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T08:04:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159841772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7090#discussion_r45961689"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7090"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/45961689"
         }
      },
      "body" : "Nit: Probably, proxyRandomize should be always true if we know this is Tor. The option exists because people may want to disable it for non-tor SOCKS5 proxies, there's not really a reason to disable it for Tor.",
      "commit_id" : "cde857f2d977fbe3f96c093f6ca3c9810494191d",
      "created_at" : "2015-11-26T10:07:33Z",
      "diff_hunk" : "@@ -449,6 +449,16 @@ void TorController::auth_cb(TorControlConnection& conn, const TorControlReply& r\n {\n     if (reply.code == 250) {\n         LogPrint(\"tor\", \"tor: Authentication succesful\\n\");\n+\n+        // Now that we know Tor is running setup the proxy for onion addresses\n+        // if -onion isn't set to something else.\n+        if (GetArg(\"-onion\", \"\") == \"\") {\n+            bool proxyRandomize = GetBoolArg(\"-proxyrandomize\", true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#discussion_r45961689",
      "id" : 45961689,
      "original_commit_id" : "d4df5079b05248d0b5ecf80e58ba3912bc486f8d",
      "original_position" : 8,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7090",
      "updated_at" : "2015-11-26T10:14:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/45961689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Tested ACK. `getnetworkinfo` when starting bitcoind with Tor running:\r\n```\r\n    {\r\n      \"name\": \"onion\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"127.0.0.1:9050\",\r\n      \"proxy_randomize_credentials\": true\r\n    }\r\n```\r\nStarting it without Tor running:\r\n```\r\n    {\r\n      \"name\": \"onion\",\r\n      \"limited\": false,\r\n      \"reachable\": false,\r\n      \"proxy\": \"\",\r\n      \"proxy_randomize_credentials\": false\r\n    }\r\n```\r\n",
      "created_at" : "2015-11-26T10:11:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159867258",
      "id" : 159867258,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T10:11:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159867258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7090#discussion_r45962367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7090"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/45962367"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "cde857f2d977fbe3f96c093f6ca3c9810494191d",
      "created_at" : "2015-11-26T10:15:04Z",
      "diff_hunk" : "@@ -449,6 +449,16 @@ void TorController::auth_cb(TorControlConnection& conn, const TorControlReply& r\n {\n     if (reply.code == 250) {\n         LogPrint(\"tor\", \"tor: Authentication succesful\\n\");\n+\n+        // Now that we know Tor is running setup the proxy for onion addresses\n+        // if -onion isn't set to something else.\n+        if (GetArg(\"-onion\", \"\") == \"\") {\n+            bool proxyRandomize = GetBoolArg(\"-proxyrandomize\", true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#discussion_r45962367",
      "id" : 45962367,
      "original_commit_id" : "d4df5079b05248d0b5ecf80e58ba3912bc486f8d",
      "original_position" : 8,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7090",
      "updated_at" : "2015-11-26T10:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/45962367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@isislovecruft See above - can you confirm that this GETINFO thing what we're supposed to be doing?",
      "created_at" : "2015-11-26T10:16:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159868080",
      "id" : 159868080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T10:16:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159868080",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2015-11-26T20:51:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-159992839",
      "id" : 159992839,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-26T20:51:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/159992839",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Two thoughts:\r\n\r\n1. Many (most?) desktop users will have tor installed via Tor Browser Bundle, which has its SOCKS listener on port 9150 rather than 9050 (which the \"system tor\", eg tor installed via apt-get, does). Some applications that want to use Tor will automatically try both ports, for instance: https://github.com/agl/pond/blob/master/client/client.go#L686\r\n\r\n2. Using Tor opportunistically by default will cause many users who want to use Tor to take no action to configure it since it appears to already be doing what they want it to by default. But, if at some point in the future their Tor process is not running, they will unwittingly fail open!\r\n\r\nSo, I'd recommend **not** using tor automatically when it is found. It would be better to probe for tor (on both port 9050 and 9150, in that order) and if it is found prompt the user \"We noticed you have Tor running. Do you want to connect using it? [Just Once] [Never] [Always (default)]\"\r\n\r\nWhen \"Always\" is selected, a configuration option should be set which causes it to fail closed if tor is not running in the future.",
      "created_at" : "2015-11-28T11:34:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160280388",
      "id" : 160280388,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T11:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160280388",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22132?v=3",
         "events_url" : "https://api.github.com/users/leif/events{/privacy}",
         "followers_url" : "https://api.github.com/users/leif/followers",
         "following_url" : "https://api.github.com/users/leif/following{/other_user}",
         "gists_url" : "https://api.github.com/users/leif/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/leif",
         "id" : 22132,
         "login" : "leif",
         "organizations_url" : "https://api.github.com/users/leif/orgs",
         "received_events_url" : "https://api.github.com/users/leif/received_events",
         "repos_url" : "https://api.github.com/users/leif/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/leif/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/leif/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/leif"
      }
   },
   {
      "body" : "To be clear: this will not by default route all Bitcoin traffic over Tor.\nIt will only enable connecting to hidden services (nodes listening on a\nport \"on\" the tor network, so to speak).\n",
      "created_at" : "2015-11-28T11:37:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160281585",
      "id" : 160281585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T11:37:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160281585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "BTW, how do we know that the app listening on the port is tor?",
      "created_at" : "2015-11-28T11:49:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160284403",
      "id" : 160284403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T11:49:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160284403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "Thanks @sipa, i missed that.\r\n\r\nI suppose there are actually four possible tor configurations:\r\n\r\n1. No Tor\r\n2. Tor for Hidden Service connections, but make regular connections without Tor\r\n3. Make all connections via Tor\r\n4. Only connect to Hidden Services\r\n\r\nHopefully (4) can be the default in a future release after there are enough onion nodes running!\r\n\r\nFor nodes advertising both a hidden service and a regular IP address, are their two advertisements linkable?\r\n\r\n@paveljanik you can't really. you could do some checking to see if it seems like tor, but what would your threat model be?",
      "created_at" : "2015-11-28T14:21:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160302792",
      "id" : 160302792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T14:21:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160302792",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22132?v=3",
         "events_url" : "https://api.github.com/users/leif/events{/privacy}",
         "followers_url" : "https://api.github.com/users/leif/followers",
         "following_url" : "https://api.github.com/users/leif/following{/other_user}",
         "gists_url" : "https://api.github.com/users/leif/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/leif",
         "id" : 22132,
         "login" : "leif",
         "organizations_url" : "https://api.github.com/users/leif/orgs",
         "received_events_url" : "https://api.github.com/users/leif/received_events",
         "repos_url" : "https://api.github.com/users/leif/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/leif/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/leif/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/leif"
      }
   },
   {
      "body" : "Well, it could be some other application run by other user of the same system. Of course the user is not supposed to be doing anything important on such system, but anyway...\r\n",
      "created_at" : "2015-11-28T15:25:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160310290",
      "id" : 160310290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T15:25:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160310290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@petertodd I assume this does not work when the user defines no password nor cookie?",
      "created_at" : "2015-11-28T15:39:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160312206",
      "id" : 160312206,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-28T15:39:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160312206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "To avoid the behaviour of this merge one must set something for `onion`, correct? \r\n\r\nCurrently I have nothing set for `onion`, but I am running a hidden service for listening. Will this effect my setup? I have `127.0.0.1:905x` ports setup for tor, **but they're not the ports I use for bitcoin. I have special, isolated ports set up (not locally) for bitcoin and my hidden service.** Is this going to cause drama for me if I don't set `onion`, essentially creating two hidden services?",
      "created_at" : "2015-11-29T03:10:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160362737",
      "id" : 160362737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-29T03:10:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160362737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13171342?v=3",
         "events_url" : "https://api.github.com/users/tailsjoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tailsjoin/followers",
         "following_url" : "https://api.github.com/users/tailsjoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tailsjoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tailsjoin",
         "id" : 13171342,
         "login" : "tailsjoin",
         "organizations_url" : "https://api.github.com/users/tailsjoin/orgs",
         "received_events_url" : "https://api.github.com/users/tailsjoin/received_events",
         "repos_url" : "https://api.github.com/users/tailsjoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tailsjoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tailsjoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tailsjoin"
      }
   },
   {
      "body" : "> To avoid the behaviour of this merge one must set something for onion, correct?\r\n\r\n`listenonion=0` to disable any automatic tor behavior\r\n\r\n",
      "created_at" : "2015-11-30T12:35:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7090#issuecomment-160617549",
      "id" : 160617549,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7090",
      "updated_at" : "2015-11-30T12:35:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/160617549",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
