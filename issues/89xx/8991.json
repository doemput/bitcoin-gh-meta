{
   "assignee" : null,
   "assignees" : [],
   "body" : "Probably I am doing something wrong but the documentation is not very clear (and not very new), or I did not find it, except http://enetium.com/resources/Bitcoin.pdf which probably would deserve to be better referenced\r\n\r\nI am using test transactions 226a8b08dc46a00e9ecec5567a303a0b354bef3c1674476eb5e4b627b2ace493 whose preceding tx is 40872a376e98a1f8b285827c2ad8c5b3eec7d779d752dc3a4adda5d9bb70f3b5, these are probably @petertodd's transactions (226a... is the preceding tx of the recent DPL post from Peter)\r\n\r\nThen if I am correct the result to be computed should be:\r\n\r\n``0100000001b5f370bbd9a5dd4a3adc52d779d7c7eeb3c5d82a7c8285b2f8a1986e372a874000000000232102d5ddb8c9a2bc17624baa51245ef3c07380f90b2e2f38217307a8a1869508ca01feffffff02d75900000000000017a914ea4e30950c2495beba1e75e035bedd55ccfe4c9b874dd51d00000000001976a914676de8484253cd355c37fc51ba34f2e5d62a944088acb69f060001000000``\r\n\r\nBut the public key recovery leads to a public key fd5b0de93dae9f462788459ef96e6331e5b20b515de35e651c369aad20af4966 or 8f4df599d8dddca73d391f495537c9af7b7616b13e91a024fce33fc1fb9af0df for point x and not the expected d5ddb8c9a2bc17624baa51245ef3c07380f90b2e2f38217307a8a1869508ca01\r\n\r\nThe code is simply:\r\n\r\n```javascript\r\nvar signature = new Buffer('3044022057a1234709270325e7215200f982546304cf465971cbd55d54231ead54ef1a7802207a82e93ef2b0f87188abe87bccb67ee9d5c650b1b58948e5b1c80ba1b4c43dc3','hex');\r\nvar message=new Buffer('0100000001b5f370bbd9a5dd4a3adc52d779d7c7eeb3c5d82a7c8285b2f8a1986e372a874000000000232102d5ddb8c9a2bc17624baa51245ef3c07380f90b2e2f38217307a8a1869508ca01feffffff02d75900000000000017a914ea4e30950c2495beba1e75e035bedd55ccfe4c9b874dd51d00000000001976a914676de8484253cd355c37fc51ba34f2e5d62a944088acb69f060001000000','hex');\r\nmessage=crypto.createHash('sha256').update(message).digest();\r\nmessage=crypto.createHash('sha256').update(message).digest();\r\n//<Buffer 2b 6d 20 06 78 4d 92 c4 da 3e 6d a8 6b ce c4 6b 6b 8a 18 9f 72 75 e1 e9 68 71 2b 91 96 7d 44 39>\r\ntry {\r\n\tvar pub=ec.recoverPubKey(message,signature,0);\r\n\tconsole.log(pub);\r\n} catch(ee) {}\r\ntry {\r\n\tpub=ec.recoverPubKey(message,signature,1);\r\n\tconsole.log(pub);\r\n} catch(ee) {}\r\ntry {\r\n\tpub=ec.recoverPubKey(message,signature,2);\r\n\tconsole.log(pub);\r\n} catch(ee) {}\r\ntry {\r\n\tpub=ec.recoverPubKey(message,signature,3);\r\n\tconsole.log(pub);\r\n} catch(ee) {}\r\n```\r\n\r\nSame method used with the example given in https://en.bitcoin.it/wiki/OP_CHECKSIG works",
   "closed_at" : "2016-10-21T17:18:30Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/759202?v=3",
      "events_url" : "https://api.github.com/users/Ayms/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Ayms/followers",
      "following_url" : "https://api.github.com/users/Ayms/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Ayms/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Ayms",
      "id" : 759202,
      "login" : "Ayms",
      "organizations_url" : "https://api.github.com/users/Ayms/orgs",
      "received_events_url" : "https://api.github.com/users/Ayms/received_events",
      "repos_url" : "https://api.github.com/users/Ayms/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Ayms/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Ayms/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Ayms"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8991/comments",
   "created_at" : "2016-10-21T12:58:37Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8991/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/8991",
   "id" : 184478152,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8991/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 8991,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Sighash calculation",
   "updated_at" : "2016-10-21T17:18:30Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8991",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/759202?v=3",
      "events_url" : "https://api.github.com/users/Ayms/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Ayms/followers",
      "following_url" : "https://api.github.com/users/Ayms/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Ayms/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Ayms",
      "id" : 759202,
      "login" : "Ayms",
      "organizations_url" : "https://api.github.com/users/Ayms/orgs",
      "received_events_url" : "https://api.github.com/users/Ayms/received_events",
      "repos_url" : "https://api.github.com/users/Ayms/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Ayms/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Ayms/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Ayms"
   }
}
