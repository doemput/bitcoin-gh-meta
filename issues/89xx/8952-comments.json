[
   {
      "body" : "Concept ACK",
      "created_at" : "2016-10-19T14:12:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-254824807",
      "id" : 254824807,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2016-10-19T14:12:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254824807",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "WDYT of adding new options like `maximumAmount` (which ables to define a range with `minimumAmount`) or maybe `sumAmount` (return unspents until the respective sum is bigger than `sumAmount`) ?",
      "created_at" : "2016-10-19T14:24:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-254828344",
      "id" : 254828344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2016-10-19T14:24:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254828344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "Yes, would make sense. Passing the JSON \"query object\" is a good idea.",
      "created_at" : "2016-10-19T15:39:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-254851868",
      "id" : 254851868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2016-10-19T15:39:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254851868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "~~I'm willing to implement~~ I've also implemented `maximumAmount`, `minimumSumAmount` and `maximumCount` options.\r\n\r\n`minimumAmount` and `maximumAmount` are options to **filter** unspents, but `maximumCount` and `minimumSumAmount` are **grouping** options which returns unspents until satisfies one of these conditions.\r\n",
      "created_at" : "2016-10-19T17:01:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-254875939",
      "id" : 254875939,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2016-11-10T15:53:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254875939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r99279207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/99279207"
         }
      },
      "body" : "Instead of the dual meanings, just say default=unlimited (and make sure 0 doesn't behave in such a manner).",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-02-03T05:31:12Z",
      "diff_hunk" : "@@ -2351,11 +2351,18 @@ UniValue listunspent(const JSONRPCRequest& request)\n             \"\\nArguments:\\n\"\n             \"1. minconf          (numeric, optional, default=1) The minimum confirmations to filter\\n\"\n             \"2. maxconf          (numeric, optional, default=9999999) The maximum confirmations to filter\\n\"\n-            \"3. \\\"addresses\\\"    (string) A json array of bitcoin addresses to filter\\n\"\n+            \"3. \\\"addresses\\\"      (string) A json array of bitcoin addresses to filter\\n\"\n             \"    [\\n\"\n-            \"      \\\"address\\\"   (string) bitcoin address\\n\"\n+            \"      \\\"address\\\"     (string) bitcoin address\\n\"\n             \"      ,...\\n\"\n             \"    ]\\n\"\n+            \"4. query options    (json, optional) JSON with query options\\n\"\n+            \"    {\\n\"\n+            \"      \\\"minimumAmount\\\"    (numeric or string, default=0) Minimum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumAmount\\\"    (numeric or string, default=21000000=unlimited) Maximum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumCount\\\"     (numeric or string, default=0=unlimited) Maximum number of UTXOs\\n\"\n+            \"      \\\"minimumSumAmount\\\" (numeric or string, default=21000000=unlimited) Minimum sum value all UTXOs in \" + CURRENCY_UNIT + \"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r99279207",
      "id" : 99279207,
      "original_commit_id" : "98d0a6fb81b33a2cef429d3d6f9d56dd47508076",
      "original_position" : 25,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 19951071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/99279207",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r99368980"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/99368980"
         }
      },
      "body" : "Ã°ÂÂÂ ",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-02-03T16:16:35Z",
      "diff_hunk" : "@@ -2351,11 +2351,18 @@ UniValue listunspent(const JSONRPCRequest& request)\n             \"\\nArguments:\\n\"\n             \"1. minconf          (numeric, optional, default=1) The minimum confirmations to filter\\n\"\n             \"2. maxconf          (numeric, optional, default=9999999) The maximum confirmations to filter\\n\"\n-            \"3. \\\"addresses\\\"    (string) A json array of bitcoin addresses to filter\\n\"\n+            \"3. \\\"addresses\\\"      (string) A json array of bitcoin addresses to filter\\n\"\n             \"    [\\n\"\n-            \"      \\\"address\\\"   (string) bitcoin address\\n\"\n+            \"      \\\"address\\\"     (string) bitcoin address\\n\"\n             \"      ,...\\n\"\n             \"    ]\\n\"\n+            \"4. query options    (json, optional) JSON with query options\\n\"\n+            \"    {\\n\"\n+            \"      \\\"minimumAmount\\\"    (numeric or string, default=0) Minimum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumAmount\\\"    (numeric or string, default=21000000=unlimited) Maximum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumCount\\\"     (numeric or string, default=0=unlimited) Maximum number of UTXOs\\n\"\n+            \"      \\\"minimumSumAmount\\\" (numeric or string, default=21000000=unlimited) Minimum sum value all UTXOs in \" + CURRENCY_UNIT + \"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r99368980",
      "id" : 99368980,
      "original_commit_id" : "98d0a6fb81b33a2cef429d3d6f9d56dd47508076",
      "original_position" : 25,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 20046578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/99368980",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "@laanwj @luke-jr Is this PR mergeable as is? ",
      "created_at" : "2017-02-07T14:11:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-278010575",
      "id" : 278010575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-02-07T14:11:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278010575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "Looks like it! but as we're past the feature freeze for 0.14 and this is a new feature, merging this will have to wait until 0.14 is branched off.",
      "created_at" : "2017-02-07T14:39:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-278018454",
      "id" : 278018454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-02-07T14:39:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278018454",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "About tests: there aren't any tests specifically for testing `listunspent` options. Should we now create them?",
      "created_at" : "2017-02-07T14:56:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-278023465",
      "id" : 278023465,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-02-07T14:56:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278023465",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "Yes, tests for that would be great. They'd make it possible to automatically detect when something breaks this functionality.",
      "created_at" : "2017-02-07T15:12:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-278028646",
      "id" : 278028646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-02-07T15:12:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278028646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538064"
         }
      },
      "body" : "Maybe I'm misreading, but this (`nMinimumSumAmount`) sounds like a maximum, not a minimum. Esp. since it defaults to `MAX_MONEY` rather than `0`.",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-02-28T19:52:30Z",
      "diff_hunk" : "@@ -2056,15 +2059,46 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed, const\n                 continue;\n             }\n \n+            if (nDepth < nMinDepth || nDepth > nMaxDepth)\n+                continue;\n+\n             for (unsigned int i = 0; i < pcoin->tx->vout.size(); i++) {\n+                if (pcoin->tx->vout[i].nValue < nMinimumAmount || pcoin->tx->vout[i].nValue > nMaximumAmount)\n+                    continue;\n+\n+                if (coinControl && coinControl->HasSelected() && !coinControl->fAllowOtherInputs && !coinControl->IsSelected(COutPoint((*it).first, i)))\n+                    continue;\n+\n+                if (IsLockedCoin((*it).first, i))\n+                    continue;\n+\n+                if (IsSpent(wtxid, i))\n+                    continue;\n+\n                 isminetype mine = IsMine(pcoin->tx->vout[i]);\n-                if (!(IsSpent(wtxid, i)) && mine != ISMINE_NO &&\n-                    !IsLockedCoin((*it).first, i) && (pcoin->tx->vout[i].nValue > 0 || fIncludeZeroValue) &&\n-                    (!coinControl || !coinControl->HasSelected() || coinControl->fAllowOtherInputs || coinControl->IsSelected(COutPoint((*it).first, i))))\n-                        vCoins.push_back(COutput(pcoin, i, nDepth,\n-                                                 ((mine & ISMINE_SPENDABLE) != ISMINE_NO) ||\n-                                                  (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO),\n-                                                 (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO));\n+\n+                if (mine == ISMINE_NO) {\n+                    continue;\n+                }\n+\n+                bool fSpendableIn = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO);\n+                bool fSolvableIn = (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO;\n+\n+                vCoins.push_back(COutput(pcoin, i, nDepth, fSpendableIn, fSolvableIn));\n+\n+                // Checks the sum amount of all UTXO's.\n+                if (nMinimumSumAmount != MAX_MONEY) {\n+                    nTotal += pcoin->tx->vout[i].nValue;\n+\n+                    if (nTotal >= nMinimumSumAmount) {\n+                        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538064",
      "id" : 103538064,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 60,
      "path" : "src/wallet/wallet.cpp",
      "position" : 60,
      "pull_request_review_id" : 24327946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538064",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/250224?v=3",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538282"
         }
      },
      "body" : "Typo: `[...]Minimum sum value of all UTXOs in \"` (missing `of`).",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-02-28T19:53:37Z",
      "diff_hunk" : "@@ -2399,15 +2399,22 @@ UniValue listunspent(const JSONRPCRequest& request)\n             \"\\nArguments:\\n\"\n             \"1. minconf          (numeric, optional, default=1) The minimum confirmations to filter\\n\"\n             \"2. maxconf          (numeric, optional, default=9999999) The maximum confirmations to filter\\n\"\n-            \"3. \\\"addresses\\\"    (string) A json array of bitcoin addresses to filter\\n\"\n+            \"3. \\\"addresses\\\"      (string) A json array of bitcoin addresses to filter\\n\"\n             \"    [\\n\"\n-            \"      \\\"address\\\"   (string) bitcoin address\\n\"\n+            \"      \\\"address\\\"     (string) bitcoin address\\n\"\n             \"      ,...\\n\"\n             \"    ]\\n\"\n             \"4. include_unsafe (bool, optional, default=true) Include outputs that are not safe to spend\\n\"\n             \"                  because they come from unconfirmed untrusted transactions or unconfirmed\\n\"\n             \"                  replacement transactions (cases where we are less sure that a conflicting\\n\"\n             \"                  transaction won't be mined).\\n\"\n+            \"5. query options    (json, optional) JSON with query options\\n\"\n+            \"    {\\n\"\n+            \"      \\\"minimumAmount\\\"    (numeric or string, default=0) Minimum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumAmount\\\"    (numeric or string, default=unlimited) Maximum value of each UTXO in \" + CURRENCY_UNIT + \"\\n\"\n+            \"      \\\"maximumCount\\\"     (numeric or string, default=unlimited) Maximum number of UTXOs\\n\"\n+            \"      \\\"minimumSumAmount\\\" (numeric or string, default=unlimited) Minimum sum value all UTXOs in \" + CURRENCY_UNIT + \"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538282",
      "id" : 103538282,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 20,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 24327946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538282",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/250224?v=3",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538713"
         }
      },
      "body" : "Need to add `options` to the first line, e.g.\r\n```C++\r\n\"listunspent ( minconf maxconf  [\\\"addresses\\\",...] [include_unsafe] [options] )\\n\"\r\n```",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-02-28T19:55:31Z",
      "diff_hunk" : "@@ -2399,15 +2399,22 @@ UniValue listunspent(const JSONRPCRequest& request)\n             \"\\nArguments:\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103538713",
      "id" : 103538713,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 1,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 12,
      "pull_request_review_id" : 24327946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103538713",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/250224?v=3",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103823982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103823982"
         }
      },
      "body" : "I see no issue here since is to be used like it was a _minorant_ set of unspents which satisfies the passed value. If It it was called `maximum` it should not retrieve unspents which sum are greater than the passed value.",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-03-02T00:20:03Z",
      "diff_hunk" : "@@ -2056,15 +2059,46 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed, const\n                 continue;\n             }\n \n+            if (nDepth < nMinDepth || nDepth > nMaxDepth)\n+                continue;\n+\n             for (unsigned int i = 0; i < pcoin->tx->vout.size(); i++) {\n+                if (pcoin->tx->vout[i].nValue < nMinimumAmount || pcoin->tx->vout[i].nValue > nMaximumAmount)\n+                    continue;\n+\n+                if (coinControl && coinControl->HasSelected() && !coinControl->fAllowOtherInputs && !coinControl->IsSelected(COutPoint((*it).first, i)))\n+                    continue;\n+\n+                if (IsLockedCoin((*it).first, i))\n+                    continue;\n+\n+                if (IsSpent(wtxid, i))\n+                    continue;\n+\n                 isminetype mine = IsMine(pcoin->tx->vout[i]);\n-                if (!(IsSpent(wtxid, i)) && mine != ISMINE_NO &&\n-                    !IsLockedCoin((*it).first, i) && (pcoin->tx->vout[i].nValue > 0 || fIncludeZeroValue) &&\n-                    (!coinControl || !coinControl->HasSelected() || coinControl->fAllowOtherInputs || coinControl->IsSelected(COutPoint((*it).first, i))))\n-                        vCoins.push_back(COutput(pcoin, i, nDepth,\n-                                                 ((mine & ISMINE_SPENDABLE) != ISMINE_NO) ||\n-                                                  (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO),\n-                                                 (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO));\n+\n+                if (mine == ISMINE_NO) {\n+                    continue;\n+                }\n+\n+                bool fSpendableIn = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO);\n+                bool fSolvableIn = (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO;\n+\n+                vCoins.push_back(COutput(pcoin, i, nDepth, fSpendableIn, fSolvableIn));\n+\n+                // Checks the sum amount of all UTXO's.\n+                if (nMinimumSumAmount != MAX_MONEY) {\n+                    nTotal += pcoin->tx->vout[i].nValue;\n+\n+                    if (nTotal >= nMinimumSumAmount) {\n+                        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103823982",
      "id" : 103823982,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 60,
      "path" : "src/wallet/wallet.cpp",
      "position" : 60,
      "pull_request_review_id" : 24626297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103823982",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103986036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103986036"
         }
      },
      "body" : "You are collecting the sum of the `nValue` and once the total exceeds the *minimum* you stop. Generally speaking,\r\n\r\n```C++\r\nint minimumSum = 5;\r\nint values[] = {1,2,3,2,3};\r\nint sum = 0;\r\nfor (int i = 0; i < 5; i++) {\r\n  sum += values[i];\r\n  if (sum >= minimumSum) break;\r\n}\r\n```\r\n\r\nThe above looks inverted to me, and will no doubt confuse the user. If you used the word minorant, it might help, but the minorant would be the vout set not the sum, I believe?\r\n\r\nAnyway, if I'm the only one bothered by this feel free to keep as is.",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-03-02T17:46:43Z",
      "diff_hunk" : "@@ -2056,15 +2059,46 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed, const\n                 continue;\n             }\n \n+            if (nDepth < nMinDepth || nDepth > nMaxDepth)\n+                continue;\n+\n             for (unsigned int i = 0; i < pcoin->tx->vout.size(); i++) {\n+                if (pcoin->tx->vout[i].nValue < nMinimumAmount || pcoin->tx->vout[i].nValue > nMaximumAmount)\n+                    continue;\n+\n+                if (coinControl && coinControl->HasSelected() && !coinControl->fAllowOtherInputs && !coinControl->IsSelected(COutPoint((*it).first, i)))\n+                    continue;\n+\n+                if (IsLockedCoin((*it).first, i))\n+                    continue;\n+\n+                if (IsSpent(wtxid, i))\n+                    continue;\n+\n                 isminetype mine = IsMine(pcoin->tx->vout[i]);\n-                if (!(IsSpent(wtxid, i)) && mine != ISMINE_NO &&\n-                    !IsLockedCoin((*it).first, i) && (pcoin->tx->vout[i].nValue > 0 || fIncludeZeroValue) &&\n-                    (!coinControl || !coinControl->HasSelected() || coinControl->fAllowOtherInputs || coinControl->IsSelected(COutPoint((*it).first, i))))\n-                        vCoins.push_back(COutput(pcoin, i, nDepth,\n-                                                 ((mine & ISMINE_SPENDABLE) != ISMINE_NO) ||\n-                                                  (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO),\n-                                                 (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO));\n+\n+                if (mine == ISMINE_NO) {\n+                    continue;\n+                }\n+\n+                bool fSpendableIn = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO);\n+                bool fSolvableIn = (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO;\n+\n+                vCoins.push_back(COutput(pcoin, i, nDepth, fSpendableIn, fSolvableIn));\n+\n+                // Checks the sum amount of all UTXO's.\n+                if (nMinimumSumAmount != MAX_MONEY) {\n+                    nTotal += pcoin->tx->vout[i].nValue;\n+\n+                    if (nTotal >= nMinimumSumAmount) {\n+                        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r103986036",
      "id" : 103986036,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 60,
      "path" : "src/wallet/wallet.cpp",
      "position" : 60,
      "pull_request_review_id" : 24796807,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/103986036",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/250224?v=3",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "> Yes, tests for that would be great. They'd make it possible to automatically detect when something breaks this functionality.\r\n\r\n@laanwj I'm already working on it. Can I submit in another PR?",
      "created_at" : "2017-03-07T18:01:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-284804630",
      "id" : 284804630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-03-07T18:01:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284804630",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r104737185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104737185"
         }
      },
      "body" : "@kallewoof Any suggestions? `nTargetSumAmount`?",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-03-07T18:09:33Z",
      "diff_hunk" : "@@ -2056,15 +2059,46 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed, const\n                 continue;\n             }\n \n+            if (nDepth < nMinDepth || nDepth > nMaxDepth)\n+                continue;\n+\n             for (unsigned int i = 0; i < pcoin->tx->vout.size(); i++) {\n+                if (pcoin->tx->vout[i].nValue < nMinimumAmount || pcoin->tx->vout[i].nValue > nMaximumAmount)\n+                    continue;\n+\n+                if (coinControl && coinControl->HasSelected() && !coinControl->fAllowOtherInputs && !coinControl->IsSelected(COutPoint((*it).first, i)))\n+                    continue;\n+\n+                if (IsLockedCoin((*it).first, i))\n+                    continue;\n+\n+                if (IsSpent(wtxid, i))\n+                    continue;\n+\n                 isminetype mine = IsMine(pcoin->tx->vout[i]);\n-                if (!(IsSpent(wtxid, i)) && mine != ISMINE_NO &&\n-                    !IsLockedCoin((*it).first, i) && (pcoin->tx->vout[i].nValue > 0 || fIncludeZeroValue) &&\n-                    (!coinControl || !coinControl->HasSelected() || coinControl->fAllowOtherInputs || coinControl->IsSelected(COutPoint((*it).first, i))))\n-                        vCoins.push_back(COutput(pcoin, i, nDepth,\n-                                                 ((mine & ISMINE_SPENDABLE) != ISMINE_NO) ||\n-                                                  (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO),\n-                                                 (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO));\n+\n+                if (mine == ISMINE_NO) {\n+                    continue;\n+                }\n+\n+                bool fSpendableIn = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO);\n+                bool fSolvableIn = (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO;\n+\n+                vCoins.push_back(COutput(pcoin, i, nDepth, fSpendableIn, fSolvableIn));\n+\n+                // Checks the sum amount of all UTXO's.\n+                if (nMinimumSumAmount != MAX_MONEY) {\n+                    nTotal += pcoin->tx->vout[i].nValue;\n+\n+                    if (nTotal >= nMinimumSumAmount) {\n+                        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r104737185",
      "id" : 104737185,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 60,
      "path" : "src/wallet/wallet.cpp",
      "position" : 60,
      "pull_request_review_id" : 25587209,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104737185",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r105442791"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105442791"
         }
      },
      "body" : "@pedrobranco I say keep it as it is if no one else complains.",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-03-10T17:13:50Z",
      "diff_hunk" : "@@ -2056,15 +2059,46 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed, const\n                 continue;\n             }\n \n+            if (nDepth < nMinDepth || nDepth > nMaxDepth)\n+                continue;\n+\n             for (unsigned int i = 0; i < pcoin->tx->vout.size(); i++) {\n+                if (pcoin->tx->vout[i].nValue < nMinimumAmount || pcoin->tx->vout[i].nValue > nMaximumAmount)\n+                    continue;\n+\n+                if (coinControl && coinControl->HasSelected() && !coinControl->fAllowOtherInputs && !coinControl->IsSelected(COutPoint((*it).first, i)))\n+                    continue;\n+\n+                if (IsLockedCoin((*it).first, i))\n+                    continue;\n+\n+                if (IsSpent(wtxid, i))\n+                    continue;\n+\n                 isminetype mine = IsMine(pcoin->tx->vout[i]);\n-                if (!(IsSpent(wtxid, i)) && mine != ISMINE_NO &&\n-                    !IsLockedCoin((*it).first, i) && (pcoin->tx->vout[i].nValue > 0 || fIncludeZeroValue) &&\n-                    (!coinControl || !coinControl->HasSelected() || coinControl->fAllowOtherInputs || coinControl->IsSelected(COutPoint((*it).first, i))))\n-                        vCoins.push_back(COutput(pcoin, i, nDepth,\n-                                                 ((mine & ISMINE_SPENDABLE) != ISMINE_NO) ||\n-                                                  (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO),\n-                                                 (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO));\n+\n+                if (mine == ISMINE_NO) {\n+                    continue;\n+                }\n+\n+                bool fSpendableIn = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (coinControl && coinControl->fAllowWatchOnly && (mine & ISMINE_WATCH_SOLVABLE) != ISMINE_NO);\n+                bool fSolvableIn = (mine & (ISMINE_SPENDABLE | ISMINE_WATCH_SOLVABLE)) != ISMINE_NO;\n+\n+                vCoins.push_back(COutput(pcoin, i, nDepth, fSpendableIn, fSolvableIn));\n+\n+                // Checks the sum amount of all UTXO's.\n+                if (nMinimumSumAmount != MAX_MONEY) {\n+                    nTotal += pcoin->tx->vout[i].nValue;\n+\n+                    if (nTotal >= nMinimumSumAmount) {\n+                        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r105442791",
      "id" : 105442791,
      "original_commit_id" : "ae6a0c0e1dd71117576c87be426aca9ada5e4193",
      "original_position" : 60,
      "path" : "src/wallet/wallet.cpp",
      "position" : 60,
      "pull_request_review_id" : 26327574,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-04-05T00:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105442791",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/250224?v=3",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "This needs a rebase. @pedrobranco Tests could be submitted in a follow-up PR.",
      "created_at" : "2017-04-02T07:06:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-290969075",
      "id" : 290969075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-04-02T07:06:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/290969075",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/863730?v=3",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "body" : "Ready.",
      "created_at" : "2017-04-12T13:28:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-293575697",
      "id" : 293575697,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-04-12T13:28:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/293575697",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "Any thoughts if this is going to be merged? /cc @laanwj",
      "created_at" : "2017-05-16T15:28:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-301819173",
      "id" : 301819173,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-05-16T15:28:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301819173",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r116919810"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/116919810"
         }
      },
      "body" : "Not necessary in this pull, but if we keep extending these arguments I think it'd be better to group then into a CoinConstraints structure and pass that in.\r\n\r\nSpeaking of which - isn't CCoinControl pretty much that?\r\n",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-05-17T06:31:40Z",
      "diff_hunk" : "@@ -1954,12 +1954,15 @@ CAmount CWallet::GetImmatureWatchOnlyBalance() const\n     return nTotal;\n }\n \n-void CWallet::AvailableCoins(std::vector<COutput>& vCoins, bool fOnlySafe, const CCoinControl *coinControl, bool fIncludeZeroValue) const\n+void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t &nMaximumCount, const int &nMinDepth, const int &nMaxDepth) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r116919810",
      "id" : 116919810,
      "original_commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 38579586,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-05-17T06:31:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/116919810",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Merged (and rebased) via 9390845",
      "created_at" : "2017-05-17T07:12:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-302005923",
      "id" : 302005923,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-05-17T07:13:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302005923",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Thank you @laanwj Ã°ÂÂÂ ",
      "created_at" : "2017-05-17T13:41:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-302093625",
      "id" : 302093625,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-05-17T13:41:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302093625",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r117008873"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117008873"
         }
      },
      "body" : "@laanwj I agree with creating a structure and grow there.",
      "commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "created_at" : "2017-05-17T14:01:14Z",
      "diff_hunk" : "@@ -1954,12 +1954,15 @@ CAmount CWallet::GetImmatureWatchOnlyBalance() const\n     return nTotal;\n }\n \n-void CWallet::AvailableCoins(std::vector<COutput>& vCoins, bool fOnlySafe, const CCoinControl *coinControl, bool fIncludeZeroValue) const\n+void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t &nMaximumCount, const int &nMinDepth, const int &nMaxDepth) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#discussion_r117008873",
      "id" : 117008873,
      "original_commit_id" : "11ee5ec98da02c4eee69d7e5084fa7fe19c93f3b",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 38676019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8952",
      "updated_at" : "2017-05-17T14:01:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117008873",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@laanwj I suppose you forgot to close after merging?",
      "created_at" : "2017-05-18T00:38:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-302268723",
      "id" : 302268723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-05-18T00:38:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302268723",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes, did'nt automatically happen as I did a rebase locally. Thanks\n\nOn May 18, 2017 2:38 AM, \"Pieter Wuille\" <notifications@github.com> wrote:\n\n> @laanwj <https://github.com/laanwj> I suppose you forgot to close after\n> merging?\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-302268723>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAHutptwk3F7P5M0nGbOo-1CacVVlXtZks5r65L5gaJpZM4KZrh9>\n> .\n>\n",
      "created_at" : "2017-05-18T08:31:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8952#issuecomment-302337552",
      "id" : 302337552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8952",
      "updated_at" : "2017-05-18T08:31:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302337552",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
