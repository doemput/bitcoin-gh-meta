[
   {
      "body" : "OMG, do we really use the similar code somewhere else? Using ternary operator twice on one line and without parens is getting closer to the programmers hell!\r\n",
      "created_at" : "2016-10-18T19:54:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254620148",
      "id" : 254620148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-18T19:54:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254620148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@paveljanik It's similar to 2 * 3 + 1 which, as far as I know, most people don't use brackets for as it's understood what order the numbers are combined.\r\n\r\nRebased.",
      "created_at" : "2016-10-19T00:29:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254677726",
      "id" : 254677726,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-19T00:33:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254677726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "Personally, I'd highly appreciate a constant variable above for readability.",
      "created_at" : "2016-10-19T00:58:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254681714",
      "id" : 254681714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-19T00:58:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254681714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "This won't compile, it's reintroducing a checkpoints dependency (nBlockEstimate) that was recently removed by 0278fb5 in PR #8865  (the whole block is not entered if we're in initial block download, and if we're not... then any block we'd consider would already be past the estimator that it gives us).\r\n\r\nFor future PR's it would be much more helpful to write what a change intends to accomplish (and, especially, WHY) in terms more specific than \"improve\". :)  Hopefully every change is an improvement.",
      "created_at" : "2016-10-19T01:13:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254683697",
      "id" : 254683697,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-19T01:16:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254683697",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Yes, I realise that #8865 broke it. Have now rebased correctly. Apologies for this.\r\n\r\nI also agree that the word improve is entirely redundant if we assume that all PR are intended to improve :) (I tend to avoid assuming to the point of not even making common sense ones!)",
      "created_at" : "2016-10-19T03:29:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254701402",
      "id" : 254701402,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-19T03:31:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254701402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@dcousens Have amended since your comment - it should be more readable now.",
      "created_at" : "2016-10-20T02:25:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-254992618",
      "id" : 254992618,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-20T02:25:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/254992618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "NACK. This is thoroughly busted -- first you need cs_main here to do what you're trying, second you can't skip announcing a block to a peer just because you think it's on a longer (not necessarily more work)  chain than yours!",
      "created_at" : "2016-10-23T13:19:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-255588196",
      "id" : 255588196,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-10-23T13:19:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255588196",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Needs rebase if still relevant.",
      "created_at" : "2016-12-06T18:09:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-265225859",
      "id" : 265225859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-12-06T18:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265225859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@sdaftuar good catch. indeed it could be smarter than this. I will work on making it so. Although, I would also say that what you propose is \"scope creep\" as this is still an improvement over the current code, IMHO.\r\n\r\nWhat I think would take into account the scenario you mention would be to replace `state->pindexBestKnownBlock->nHeight` with `LastCommonAncestor(pindexToAnnounce, state->pindexBestKnownBlock)->nHeight` but currently my C++ sklls aren't quite up to scratch to make this change...",
      "created_at" : "2016-12-11T05:05:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-266263709",
      "id" : 266263709,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-12-11T05:50:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/266263709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@sdaftuar Not sure it's \"thoroughly\" busted but your comment has helped me to notice a mistake in the coding - it should be pindexLastCommonBlock not pindexBestKnownBlock that I am using. Making this change now.",
      "created_at" : "2016-12-11T07:40:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-266268226",
      "id" : 266268226,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2016-12-11T07:40:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/266268226",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad During IBD, nNewHeight is always larger than any pindexLastCommonBlock, so this removes the protection the original code was intended to give.",
      "created_at" : "2017-04-09T15:35:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8958#issuecomment-292793086",
      "id" : 292793086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8958",
      "updated_at" : "2017-04-09T15:35:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/292793086",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
