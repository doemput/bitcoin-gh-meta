[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r112840212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112840212"
         }
      },
      "body" : "nit: As mentioned [here](https://github.com/bitcoin/bitcoin/pull/10224#discussion_r112836531), I don't think it makes sense to blindly apply pep8 to all python code. Also, changing white space in unrelated commits makes them harder to cherry-pick to other branches.",
      "commit_id" : "6d1b1eb77076aef3ff08cb9b46f97f4080e7ae86",
      "created_at" : "2017-04-23T17:43:11Z",
      "diff_hunk" : "@@ -27,74 +29,74 @@ def __init__(self):\n         self.node_args = [[]]\n \n     def setup_network(self):\n-        self.nodes = start_nodes(self.num_nodes, self.options.tmpdir, self.node_args)\n+        self.nodes = start_nodes(self.num_nodes, self.options.tmpdir,\n+                                 self.node_args)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r112840212",
      "id" : 112840212,
      "original_commit_id" : "19e9a262a9c5ef5425d93865d0c4559f36ed5d95",
      "original_position" : 22,
      "path" : "test/functional/wallet-accounts.py",
      "position" : null,
      "pull_request_review_id" : 34185102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255",
      "updated_at" : "2017-04-29T21:45:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112840212",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r112846637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112846637"
         }
      },
      "body" : "understood, reverted most of the whitespace diff.",
      "commit_id" : "6d1b1eb77076aef3ff08cb9b46f97f4080e7ae86",
      "created_at" : "2017-04-23T22:42:57Z",
      "diff_hunk" : "@@ -27,74 +29,74 @@ def __init__(self):\n         self.node_args = [[]]\n \n     def setup_network(self):\n-        self.nodes = start_nodes(self.num_nodes, self.options.tmpdir, self.node_args)\n+        self.nodes = start_nodes(self.num_nodes, self.options.tmpdir,\n+                                 self.node_args)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r112846637",
      "id" : 112846637,
      "original_commit_id" : "19e9a262a9c5ef5425d93865d0c4559f36ed5d95",
      "original_position" : 22,
      "path" : "test/functional/wallet-accounts.py",
      "position" : null,
      "pull_request_review_id" : 34191306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255",
      "updated_at" : "2017-04-29T21:45:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112846637",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "Reverted some of the whitespace diff.",
      "created_at" : "2017-04-25T14:49:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-297054869",
      "id" : 297054869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-25T14:49:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/297054869",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "Hmm, it would be nice to get some more thorough testing of this in. Useful to have tests that \"just call it\", but to really qualify it as \"tests listaddressgroupings\" you might want to also create a few test addresses, create some raw transactions to them, test that addresses shared in the input are grouped which weren't previously, and then test that the groupings are transitive (ie if you have a transaction with inputs from address A & B, and another from addresses B & C, there is now one group with all three grouped, despite it being in separate transactions). If you dont want to bite that much off, still good to have these tests, but maybe dont add it to the list of \"tested RPCs\" at the top, and maybe we should have a blacklist on the coverage meter at the end.",
      "created_at" : "2017-04-26T00:41:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-297205115",
      "id" : 297205115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-26T00:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/297205115",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Thanks for the suggestion. I'm going to have to study a bit more on exactly how addresses group together in the `wallet-accounts.py` test to get a handle on what the groups should be and shouldn't be. I'm fine with removing that this RPC is tested for now or making this task a bigger one with a more thorough test of listaddressgroupings.",
      "created_at" : "2017-04-26T01:30:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-297211793",
      "id" : 297211793,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-26T01:30:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/297211793",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "@jimmysong - I haven't looked at the complete test, so I don't know if this breaks things further down, but I imagine you can do this by:\r\n\r\n- generate 102 blocks instead of 101. That means the node has 2 coinbase rewards of 50BTC, which are unlinkable and so should be in different groupings.\r\n- construct a single transaction which sends 25 BTC from each address to an external address. The two originating addresses are now linkable and so should be in the same grouping.\r\n\r\nIf you make this change, there shouldn't be a change in the balance, so :crossed_fingers: it shouldn't break anything further down in the test.",
      "created_at" : "2017-04-28T21:51:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298115068",
      "id" : 298115068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-28T21:51:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298115068",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "@jnewbery @TheBlueMatt I've changed the test per jnewbery's suggestion. Hopefully, this is enough to test? Note it was kind of tricky because of fees.",
      "created_at" : "2017-04-29T03:36:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298144346",
      "id" : 298144346,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-29T03:36:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298144346",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r114052712"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114052712"
         }
      },
      "body" : "You might want to try if subtractfromfee helps here.\r\n\r\n```py\r\nnode.sendmany(fromaccount=\"\",amounts={ common_address:100},subtractfeefrom=[common_address], minconf=1)",
      "commit_id" : "6d1b1eb77076aef3ff08cb9b46f97f4080e7ae86",
      "created_at" : "2017-04-29T12:38:34Z",
      "diff_hunk" : "@@ -30,16 +31,61 @@ def setup_network(self):\n         self.nodes = start_nodes(self.num_nodes, self.options.tmpdir, self.node_args)\n         self.is_network_split = False\n \n-    def run_test (self):\n+    def run_test(self):\n         node = self.nodes[0]\n         # Check that there's no UTXO on any of the nodes\n         assert_equal(len(node.listunspent()), 0)\n-        \n+\n+        # Note each time we call generate, all generated coins go into\n+        # the same address, so we call twice to get two addresses w/50 each\n+        node.generate(1)\n         node.generate(101)\n-        \n-        assert_equal(node.getbalance(), 50)\n-        \n-        accounts = [\"a\",\"b\",\"c\",\"d\",\"e\"]\n+        assert_equal(node.getbalance(), 100)\n+\n+        # there should be 2 address groups\n+        # each with 1 address with a balance of 50 Bitcoins\n+        address_groups = node.listaddressgroupings()\n+        assert_equal(len(address_groups), 2)\n+        linked_addresses = []\n+        for address_group in address_groups:\n+            assert_equal(len(address_group), 1)\n+            assert_equal(len(address_group[0]), 2)\n+            assert_equal(address_group[0][1], 50)\n+            linked_addresses.append(address_group[0][0])\n+        linked_addresses.sort()\n+\n+        # send 50 from each address to a third address not in this wallet\n+        # fee is 0.0000612, which is why we need to spend 99.9999388\n+        common_address = \"msf4WtN1YQKXvNtvdFYt9JBnUD2FB41kjr\"\n+        node.sendfrom(\"\", common_address, 99.9999388)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r114052712",
      "id" : 114052712,
      "original_commit_id" : "59687cc1cd7c0d4e1f3d11c8b3d8ecbc5ccefa89",
      "original_position" : 44,
      "path" : "test/functional/wallet-accounts.py",
      "position" : null,
      "pull_request_review_id" : 35495780,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255",
      "updated_at" : "2017-04-29T21:45:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114052712",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r114062379"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114062379"
         }
      },
      "body" : "Thanks! That works great!",
      "commit_id" : "6d1b1eb77076aef3ff08cb9b46f97f4080e7ae86",
      "created_at" : "2017-04-29T21:46:02Z",
      "diff_hunk" : "@@ -30,16 +31,61 @@ def setup_network(self):\n         self.nodes = start_nodes(self.num_nodes, self.options.tmpdir, self.node_args)\n         self.is_network_split = False\n \n-    def run_test (self):\n+    def run_test(self):\n         node = self.nodes[0]\n         # Check that there's no UTXO on any of the nodes\n         assert_equal(len(node.listunspent()), 0)\n-        \n+\n+        # Note each time we call generate, all generated coins go into\n+        # the same address, so we call twice to get two addresses w/50 each\n+        node.generate(1)\n         node.generate(101)\n-        \n-        assert_equal(node.getbalance(), 50)\n-        \n-        accounts = [\"a\",\"b\",\"c\",\"d\",\"e\"]\n+        assert_equal(node.getbalance(), 100)\n+\n+        # there should be 2 address groups\n+        # each with 1 address with a balance of 50 Bitcoins\n+        address_groups = node.listaddressgroupings()\n+        assert_equal(len(address_groups), 2)\n+        linked_addresses = []\n+        for address_group in address_groups:\n+            assert_equal(len(address_group), 1)\n+            assert_equal(len(address_group[0]), 2)\n+            assert_equal(address_group[0][1], 50)\n+            linked_addresses.append(address_group[0][0])\n+        linked_addresses.sort()\n+\n+        # send 50 from each address to a third address not in this wallet\n+        # fee is 0.0000612, which is why we need to spend 99.9999388\n+        common_address = \"msf4WtN1YQKXvNtvdFYt9JBnUD2FB41kjr\"\n+        node.sendfrom(\"\", common_address, 99.9999388)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#discussion_r114062379",
      "id" : 114062379,
      "original_commit_id" : "59687cc1cd7c0d4e1f3d11c8b3d8ecbc5ccefa89",
      "original_position" : 44,
      "path" : "test/functional/wallet-accounts.py",
      "position" : null,
      "pull_request_review_id" : 35505167,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10255",
      "updated_at" : "2017-04-29T21:46:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114062379",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "changed so that there's no need to hard-code fees per @MarcoFalke's suggestion.",
      "created_at" : "2017-04-29T21:46:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298196561",
      "id" : 298196561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-04-29T21:46:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298196561",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "Looks good @jimmysong . Thanks for persisting with this.\r\n\r\nI would personally prefer to do the second `listaddressgroupings` before you generate a new block, so the only differences between the first and second calls are:\r\n- in the first call, the addresses are in two separate groupings and in the second call they're in the same grouping\r\n- in the first call, both addresses have balance 50 and in the second call both addresses have balance 0.\r\n\r\nI have an example here that does that: https://github.com/jnewbery/bitcoin/tree/pr10255 . Feel free to take it for this PR.\r\n\r\nAnother suggestion: you may be able to remove the fee entirely by using the {create,fund,send}rawtransaction RPCs instead of sendtomany. I'm not sure if that makes the test more straightforward. Up to you if you want to try that out.",
      "created_at" : "2017-05-01T17:42:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298383986",
      "id" : 298383986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-05-01T17:42:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298383986",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Thanks @jnewbery. I've changed per your suggestions. Of course, I didn't see your tree until I had coded it up, but it's almost exactly the same. Also, rebased and squashed.",
      "created_at" : "2017-05-01T18:14:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298391790",
      "id" : 298391790,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-05-01T18:14:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298391790",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/524761?v=3",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "body" : "Looks great. utACK dadfee38e8fdf2b384d0991253865ebf9fbdb07f",
      "created_at" : "2017-05-02T17:44:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298708558",
      "id" : 298708558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-05-02T17:44:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298708558",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "utACK dadfee38e8fdf2b384d0991253865ebf9fbdb07f",
      "created_at" : "2017-05-02T18:17:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10255#issuecomment-298717622",
      "id" : 298717622,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10255",
      "updated_at" : "2017-05-02T18:17:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298717622",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
