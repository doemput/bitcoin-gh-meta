[
   {
      "body" : "No strong feelings, but this seems reasonable to me. (I was never sure I understood how these flags were supposed to work, so this seems clearer than before.)\r\n\r\nutACK",
      "created_at" : "2016-04-06T15:24:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-206425944",
      "id" : 206425944,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-04-06T15:24:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206425944",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "thank you! \r\nTo be clear, I don't think the second commit should be merged. It would be one thing we could replace with a flag for policy-only segwit or something in the future, just an example. I'll leave it for now, but it's not intended to be merged. Next comment I remove it.",
      "created_at" : "2016-04-06T23:35:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-206620924",
      "id" : 206620924,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-04-06T23:36:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206620924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Should I remove the second commit already or just close the PR for lack of interest?",
      "created_at" : "2016-04-14T14:43:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-209978271",
      "id" : 209978271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-04-14T14:43:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209978271",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "It feels like a layer violation to let the script intepreter define the flags that block-level consensus can use (including things that have no effect on script validation).",
      "created_at" : "2016-04-14T14:51:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-209984424",
      "id" : 209984424,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-04-14T14:51:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209984424",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa Thank you for bringing that up, that's the concern I expected.\r\nIn the same way, when/if we create tx validation flags for say, tx, header, block...\r\nIt will feel like a layer violation that the block validation flags are in the same enum as the tx validation flags, won't it?\r\nSo the real question is, how many different enums do we want for consensus validation flags?\r\n\r\nTo me, the answer is one. The layer we should be most concerned about is the consensus layer.\r\nWould you feel better if all the flags were moved from script/interpreter to consensus/flags.h or something similar? Although it seems the right thing to do, it doesn't feel like useful disruption, the priority is moving consensus code out of the consensus module to the consensus module. Moving things that are already in the consensus module already doesn't seem very helpful at this point.\r\n\r\nAnyway, 1 or not, I need to know what the number will be. With BIP68/BIP112/BIP113 I originally suggested that we at least called them tx validation flags instead of locktime flags, but I got an answer along the lines \"this kind of detailed can be bike-shed later\". I agreed and patiently waited for many months. Well, I'm trying to get an answer again now.\r\n\r\nIt won't be hard (only painful and ugly) to separate the parameter ```flags``` in libconsensus' VerifyTx() ( see https://github.com/jtimon/bitcoin/commit/c90f08f97a0965868dd1ff502e79f22f3ad7e787 ) into 3 different parameters: scriptFlags, lockTimeFlags and txFlags.\r\n\r\nGetConsensusFlags() (see https://github.com/jtimon/bitcoin/commit/d3cf04f547d8d2e6eefc38858dd931a4985955f0 ) can also be easily separated in 3 or more functions (it just becomes the opposite of elegance and stops being practical).\r\n\r\nIf the first commit gets merged as it is, great. If it doesn't, but I get an answer to my question, \"how many types of consensus flags we need if 1 is not enough?\", also great.\r\nI will personally argue in favor of at few as possible.\r\nSo if 1 (this PR ) is nacked, I will argue in favor of scriptFlags and nonScriptConsensusFlags as the next best thing (ie 2).\r\n",
      "created_at" : "2016-04-14T16:55:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-210047290",
      "id" : 210047290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-04-14T16:55:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210047290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@jtimon That's an interesting discussion, and it is related to the question of how the code should be layered a) by (script,tx,block,blockchain) or b) by (primitives,serialization,validation/consensus,signing), as all combinations of these are possible. If we primarily organize by b, then it makes sense to have only one set of consensus flags. But what if we want to extend the usage of scripts beyond transactions? (for example, signing messages with script). It would be very much be a layer violation if the message signing/validation logic needs to be aware of block-level consensus flags like BIP34. ",
      "created_at" : "2016-06-02T14:53:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-223316643",
      "id" : 223316643,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-06-02T14:53:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223316643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Should I close for now, until #8345 gets some review?",
      "created_at" : "2016-07-16T19:34:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-233147114",
      "id" : 233147114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-07-16T19:34:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233147114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "The only short term solution I see to the \"layer violation\" concern I see is moving the flags outside script/interpreter, maybe to consensus/flags.h.",
      "created_at" : "2016-07-16T19:37:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-233147237",
      "id" : 233147237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-07-16T19:37:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233147237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "I think we just need two types of flags: consensus flags and script flags.\r\n\r\nThe consensus logic (above script) computes the script flags to pass down, but they're otherwise independent.",
      "created_at" : "2016-07-16T20:04:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-233148429",
      "id" : 233148429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-07-16T20:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233148429",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "But why? What's so wrong about separating the flags out of interpreter (to say consensus/flags.h)?\r\nWhat's so cool about having the flags separated (in two or more, but as said before I prefer 2 over any greater number, just prefer 1).\r\nThat will mean that (at least) verifyTx will have to take two parameters: scriptFlags, restOfConsensusFlags.\r\nWhy? Really, is there an advantage I am missing?\r\n",
      "created_at" : "2016-07-17T09:16:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-233172846",
      "id" : 233172846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-07-17T09:16:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233172846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "No, VerifyTx would just take consensusflags. These would include things\nlike BIP16, BIP30, BIP34, BIP65, BIP66, CSV, ...\n\nVerifyTx would translate those to the corresponding script verify flags;\nnamely the things that are already script verification flags. Not all\nconsensus flags translate to script verification flags (BIP30 and BIP34 do\nnot for example); some would translate to multiple (standardness could be\nimplemented that way).\n\nThe reason is to keep the script interpreter independent from the rest of\nconsensus. At some point we may want to use it for other things like signed\nmessages.\n",
      "created_at" : "2016-07-17T10:33:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-233175509",
      "id" : 233175509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-07-17T10:33:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233175509",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Replaced by #9271",
      "created_at" : "2016-12-03T12:23:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7779#issuecomment-264636206",
      "id" : 264636206,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7779",
      "updated_at" : "2016-12-03T12:23:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/264636206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
