[
   {
      "author_association" : "OWNER",
      "body" : "Is this necessary? There is no problem with creating a one-past-end pointer; only dereferencing them, which doesn't happen here.",
      "created_at" : "2017-10-18T09:16:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#issuecomment-337518961",
      "id" : 337518961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11516",
      "updated_at" : "2017-10-18T09:16:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337518961",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa Both zero length `memset`:s and creating of one-past-end pointers are legal, so from a language legality sense this change is not needed.\r\n\r\nHowever, I've seen multiple static analyzers flag this line of code as a potential mistake. This small change makes it apparent for both static analyzers and humans what the real intention of the code is.\r\n\r\nMy experience is that code that looks like potential mistakes to static analyzers tend to confuse humans too.  I think there is a good case for helping static analyzers (and perhaps humans too?) in this case. It also has the added benefit of getting rid of an unnecessary `memset` call and getting three additional test cases that cover the key length boundaries.\r\n\r\nIn summary I think this change is worth it :-)",
      "created_at" : "2017-10-18T10:15:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#issuecomment-337539285",
      "id" : 337539285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11516",
      "updated_at" : "2017-10-18T10:17:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337539285",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Pointers to the end of a range are absolutely valid C/C++. This is commonly used for iteration end-exclusive ranges. So is a zero-length memset.\r\n\r\nI tend towards NACK adding unnecessary checks here. I think minor harmless changes to fix static analyzer false-positives are sometimes okay, but at some point it goes too far, we don't write our code to appease static analyzers. This kind of ruffling the code can introduce bugs.\r\n\r\nACK on the tests though.",
      "created_at" : "2017-10-18T13:29:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#issuecomment-337590429",
      "id" : 337590429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11516",
      "updated_at" : "2017-10-18T13:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337590429",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11516#discussion_r145450796"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145450796"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removing this change as requested.",
      "commit_id" : "a3f56578ab79931f3a35a44b6ff43d0da6308602",
      "created_at" : "2017-10-18T15:26:21Z",
      "diff_hunk" : "@@ -11,7 +11,9 @@ CHMAC_SHA256::CHMAC_SHA256(const unsigned char* key, size_t keylen)\n     unsigned char rkey[64];\n     if (keylen <= 64) {\n         memcpy(rkey, key, keylen);\n-        memset(rkey + keylen, 0, 64 - keylen);\n+        if (keylen != 64) {\n+            memset(rkey + keylen, 0, 64 - keylen);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#discussion_r145450796",
      "id" : 145450796,
      "original_commit_id" : "a4a983db745a8b8fb7678b804ac1f74d40b6c416",
      "original_position" : 7,
      "path" : "src/crypto/hmac_sha256.cpp",
      "position" : null,
      "pull_request_review_id" : 70252871,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11516",
      "updated_at" : "2017-10-18T15:27:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145450796",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11516#discussion_r145450875"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145450875"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removing this change as requested.",
      "commit_id" : "a3f56578ab79931f3a35a44b6ff43d0da6308602",
      "created_at" : "2017-10-18T15:26:32Z",
      "diff_hunk" : "@@ -11,7 +11,9 @@ CHMAC_SHA512::CHMAC_SHA512(const unsigned char* key, size_t keylen)\n     unsigned char rkey[128];\n     if (keylen <= 128) {\n         memcpy(rkey, key, keylen);\n-        memset(rkey + keylen, 0, 128 - keylen);\n+        if (keylen != 128) {\n+            memset(rkey + keylen, 0, 128 - keylen);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#discussion_r145450875",
      "id" : 145450875,
      "original_commit_id" : "a4a983db745a8b8fb7678b804ac1f74d40b6c416",
      "original_position" : 7,
      "path" : "src/crypto/hmac_sha512.cpp",
      "position" : null,
      "pull_request_review_id" : 70252959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11516",
      "updated_at" : "2017-10-18T15:27:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145450875",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa @laanwj PR updated - now keeping only the new test cases covering the key length boundaries :-)",
      "created_at" : "2017-10-18T15:30:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11516#issuecomment-337630682",
      "id" : 337630682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11516",
      "updated_at" : "2017-10-18T15:30:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337630682",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
