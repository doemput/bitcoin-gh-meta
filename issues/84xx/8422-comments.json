[
   {
      "body" : "test_big_witness_transaction add significant test duration because of the creation of many signature, I don't feel like removing it as it may still be useful though.",
      "created_at" : "2016-07-29T02:00:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236075849",
      "id" : 236075849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T02:00:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236075849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "travis fail probably unrelated to this PR ",
      "created_at" : "2016-07-29T03:34:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236086719",
      "id" : 236086719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T03:34:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236086719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72787163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72787163"
         }
      },
      "body" : "Might make sense to check if any \"progress\" was made instead to avoid grabbing locks for setting any time the retrieved cachedHashes isn't empty already. ",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T13:01:13Z",
      "diff_hunk" : "@@ -1915,10 +1918,23 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight)\n bool CScriptCheck::operator()() {\n     const CScript &scriptSig = ptxTo->vin[nIn].scriptSig;\n     const CScriptWitness *witness = (nIn < ptxTo->wit.vtxinwit.size()) ? &ptxTo->wit.vtxinwit[nIn].scriptWitness : NULL;\n-    if (!VerifyScript(scriptSig, scriptPubKey, witness, nFlags, CachingTransactionSignatureChecker(ptxTo, nIn, amount, cacheStore), &error)) {\n-        return false;\n+    CachedHashes cachedHashes;\n+    int version;\n+    std::vector<unsigned char> program;\n+    // if the cache map is available, and we get a cache miss, then we'll need to update the cache later\n+    // if the scriptPubKey is not witness program, no need for cachedHashes, so do not read the map (it would acquire the lock needlessly)\n+    bool addCachedHashesToMap = cachedHashesMap != NULL &&\n+                                scriptPubKey.IsWitnessProgram(version, program) &&\n+                                !cachedHashesMap->TryGet(this->ptxTo->GetHash(), &cachedHashes);\n+    addCachedHashesToMap &= !cachedHashes.IsFull();\n+    bool result = VerifyScript(scriptSig, scriptPubKey, witness, nFlags, CachingTransactionSignatureChecker(ptxTo, nIn, amount, cacheStore, cachedHashes), &error);\n+    // do not update the cache if cachedHashes is still empty, it can happen if the evaluation ends before any segwit CheckSig operation could run\n+    addCachedHashesToMap &= !cachedHashes.IsEmpty();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72787163",
      "id" : 72787163,
      "original_commit_id" : "6c52333c6a919e8cd8b44569b44f207d294f0bca",
      "original_position" : 54,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72787163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "@instagibbs I've just updated the PR following your suggestion.",
      "created_at" : "2016-07-29T17:14:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236238422",
      "id" : 236238422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T17:14:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236238422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "You're making script/interpreter depend on sync, which causes a compile failure as libconsensus (which uses script/interpreter) does not link in Boost.\r\n\r\nOne way would be to make CachedHashesMap a virtual class, with only a naive implementation (which does not cache anything). Then elsewhere you can create a derived class which adds the map and the lock.\r\n\r\nEDIT: oh no, I think you just need to stop including cachedhashesmap.h from interpreter.h.\r\nEDIT2: verified, this is what causes the build failure.",
      "created_at" : "2016-07-29T19:06:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236267171",
      "id" : 236267171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T19:43:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236267171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Can you also follow the coding style? Spaces after `if`, and `{` on the same line (except for classes or function bodies).",
      "created_at" : "2016-07-29T19:40:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236274847",
      "id" : 236274847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T19:40:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236274847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa yes, it was a mistake just removed it and fixed coding style.\r\n\r\nI am suprised, that https://travis-ci.org/bitcoin/bitcoin/builds/148371080 and when I compiled myself I did not experienced any build fails because of this mistake.",
      "created_at" : "2016-07-29T19:52:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236277470",
      "id" : 236277470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T19:52:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236277470",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Did you run `make check` ?",
      "created_at" : "2016-07-29T19:54:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236277803",
      "id" : 236277803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T19:54:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236277803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "nop, only make -j4. What does the check do ? I thought it was only running tests.",
      "created_at" : "2016-07-29T19:54:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236277964",
      "id" : 236277964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-29T19:54:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236277964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874539"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874539"
         }
      },
      "body" : "Space after if.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:30:28Z",
      "diff_hunk" : "@@ -1915,10 +1918,24 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight)\n bool CScriptCheck::operator()() {\n     const CScript &scriptSig = ptxTo->vin[nIn].scriptSig;\n     const CScriptWitness *witness = (nIn < ptxTo->wit.vtxinwit.size()) ? &ptxTo->wit.vtxinwit[nIn].scriptWitness : NULL;\n-    if (!VerifyScript(scriptSig, scriptPubKey, witness, nFlags, CachingTransactionSignatureChecker(ptxTo, nIn, amount, cacheStore), &error)) {\n-        return false;\n-    }\n-    return true;\n+    CachedHashes cachedHashes;\n+    int version;\n+    std::vector<unsigned char> program;\n+    // if the cache map is available, and we get a cache miss, then we'll need to update the cache later\n+    // if the scriptPubKey is not witness program, no need for cachedHashes, so do not read the map (it would acquire the lock needlessly)\n+    bool addCachedHashesToMap = cachedHashesMap != NULL &&\n+                                scriptPubKey.IsWitnessProgram(version, program);\n+    if(addCachedHashesToMap) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874539",
      "id" : 72874539,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 52,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874550"
         }
      },
      "body" : "Space after if.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:30:37Z",
      "diff_hunk" : "@@ -1915,10 +1918,24 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight)\n bool CScriptCheck::operator()() {\n     const CScript &scriptSig = ptxTo->vin[nIn].scriptSig;\n     const CScriptWitness *witness = (nIn < ptxTo->wit.vtxinwit.size()) ? &ptxTo->wit.vtxinwit[nIn].scriptWitness : NULL;\n-    if (!VerifyScript(scriptSig, scriptPubKey, witness, nFlags, CachingTransactionSignatureChecker(ptxTo, nIn, amount, cacheStore), &error)) {\n-        return false;\n-    }\n-    return true;\n+    CachedHashes cachedHashes;\n+    int version;\n+    std::vector<unsigned char> program;\n+    // if the cache map is available, and we get a cache miss, then we'll need to update the cache later\n+    // if the scriptPubKey is not witness program, no need for cachedHashes, so do not read the map (it would acquire the lock needlessly)\n+    bool addCachedHashesToMap = cachedHashesMap != NULL &&\n+                                scriptPubKey.IsWitnessProgram(version, program);\n+    if(addCachedHashesToMap) {\n+        cachedHashesMap->TryGet(this->ptxTo->GetHash(), &cachedHashes);\n+    }\n+    CachedHashes originalCachedHashes = cachedHashes;\n+    bool result = VerifyScript(scriptSig, scriptPubKey, witness, nFlags, CachingTransactionSignatureChecker(ptxTo, nIn, amount, cacheStore, cachedHashes), &error);\n+    // do not update the cache if cachedHashes if it has not been updated\n+    addCachedHashesToMap &= !(originalCachedHashes == cachedHashes);\n+    if(addCachedHashesToMap) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874550",
      "id" : 72874550,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 59,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874596"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874596"
         }
      },
      "body" : "Newline at the end of the file.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:31:23Z",
      "diff_hunk" : "@@ -0,0 +1,26 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"cachedhashesmap.h\"\n+\n+bool CachedHashesMap::TryGet(uint256 txId, CachedHashes* hashes)\n+{\n+    LOCK(cs);\n+    auto iter = map.find(txId);\n+    if (iter == map.end())\n+        return false;\n+    *hashes = iter->second;\n+    return true;\n+}\n+\n+void CachedHashesMap::TrySet(uint256 txId, const CachedHashes& hashes)\n+{\n+    LOCK(cs);\n+    auto iter = map.find(txId);\n+    if (iter == map.end())\n+        map.insert(std::pair<uint256, CachedHashes>(txId, hashes));\n+    else\n+        iter->second.Merge(hashes);\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874596",
      "id" : 72874596,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 26,
      "path" : "src/script/cachedhashesmap.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874625"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874625"
         }
      },
      "body" : "This whole method can be written as `LOCK(cs); map[txId].Merge(hashes);`.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:31:53Z",
      "diff_hunk" : "@@ -0,0 +1,26 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"cachedhashesmap.h\"\n+\n+bool CachedHashesMap::TryGet(uint256 txId, CachedHashes* hashes)\n+{\n+    LOCK(cs);\n+    auto iter = map.find(txId);\n+    if (iter == map.end())\n+        return false;\n+    *hashes = iter->second;\n+    return true;\n+}\n+\n+void CachedHashesMap::TrySet(uint256 txId, const CachedHashes& hashes)\n+{\n+    LOCK(cs);\n+    auto iter = map.find(txId);\n+    if (iter == map.end())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874625",
      "id" : 72874625,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 22,
      "path" : "src/script/cachedhashesmap.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874625",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874669"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874669"
         }
      },
      "body" : "Can you pass the uint256 as a const reference to avoid copying it?",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:32:36Z",
      "diff_hunk" : "@@ -0,0 +1,28 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef SRC_CACHEDHASHESMAP_H\n+#define SRC_CACHEDHASHESMAP_H\n+\n+\n+#include \"script/interpreter.h\"\n+#include \"sync.h\"\n+\n+class CachedHashes;\n+/**\n+ * A thread safe map which caches mid state witness signature hash calculation by transaction id\n+ */\n+class CachedHashesMap\n+{\n+private:\n+    std::map<uint256, CachedHashes> map;\n+    CCriticalSection cs;\n+public:\n+    bool TryGet(uint256 txId, CachedHashes* hashes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874669",
      "id" : 72874669,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 23,
      "path" : "src/script/cachedhashesmap.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874703"
         }
      },
      "body" : "Satoshi did not write this.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:33:11Z",
      "diff_hunk" : "@@ -0,0 +1,26 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874703",
      "id" : 72874703,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 1,
      "path" : "src/script/cachedhashesmap.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874772"
         }
      },
      "body" : "You can turn this into a `struct` and drop the `public:` declaration.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:33:45Z",
      "diff_hunk" : "@@ -98,13 +98,33 @@ enum\n \n bool CheckSignatureEncoding(const std::vector<unsigned char> &vchSig, unsigned int flags, ScriptError* serror);\n \n+class CachedHashes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72874772",
      "id" : 72874772,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 4,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72874772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72875845"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72875845"
         }
      },
      "body" : "This mutable isn't needed.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:50:23Z",
      "diff_hunk" : "@@ -133,12 +153,14 @@ class TransactionSignatureChecker : public BaseSignatureChecker\n     const CTransaction* txTo;\n     unsigned int nIn;\n     const CAmount amount;\n+    mutable CachedHashes* cachedHashes;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72875845",
      "id" : 72875845,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 39,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72875845",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72875978"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72875978"
         }
      },
      "body" : "Unused variable.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-29T23:53:27Z",
      "diff_hunk" : "@@ -419,8 +423,89 @@ void ReplaceRedeemScript(CScript& script, const CScript& redeemScript)\n     script = PushAll(stack);\n }\n \n+BOOST_AUTO_TEST_CASE(test_big_witness_transaction) {\n+    CMutableTransaction mtx;\n+    mtx.nVersion = 1;\n+\n+    CKey key;\n+    key.MakeNewKey(false);\n+    CBasicKeyStore keystore;\n+    keystore.AddKeyPubKey(key, key.GetPubKey());\n+    CKeyID hash = key.GetPubKey().GetID();\n+    CScript scriptPubKey = CScript() << OP_0 << std::vector<unsigned char>(hash.begin(), hash.end());\n+\n+    vector<int> sigHashes;\n+    sigHashes.push_back(SIGHASH_NONE | SIGHASH_ANYONECANPAY);\n+    sigHashes.push_back(SIGHASH_SINGLE | SIGHASH_ANYONECANPAY);\n+    sigHashes.push_back(SIGHASH_ALL | SIGHASH_ANYONECANPAY);\n+    sigHashes.push_back(SIGHASH_NONE);\n+    sigHashes.push_back(SIGHASH_SINGLE);\n+    sigHashes.push_back(SIGHASH_ALL);\n+\n+    // create a big transaction of 4500 inputs signed by the same key\n+    for(uint32_t ij = 0; ij < 4500; ij++) {\n+        uint32_t i = mtx.vin.size();\n+        uint256 prevId;\n+        prevId.SetHex(\"0000000000000000000000000000000000000000000000000000000000000100\");\n+        COutPoint outpoint(prevId, i);\n+\n+        mtx.vin.resize(mtx.vin.size() + 1);\n+        mtx.vin[i].prevout = outpoint;\n+        mtx.vin[i].scriptSig = CScript();\n+\n+        mtx.vout.resize(mtx.vout.size() + 1);\n+        mtx.vout[i].nValue = 1000;\n+        mtx.vout[i].scriptPubKey = CScript() << OP_1;\n+    }\n+\n+    // sign all inputs\n+    for(uint32_t i = 0; i < mtx.vin.size(); i++) {\n+        bool hashSigned = SignSignature(keystore, scriptPubKey, mtx, i, 1000, sigHashes.at(i % sigHashes.size()));\n+        assert(hashSigned);\n+    }\n+\n+    CTransaction tx;\n+    CDataStream ssout(SER_NETWORK, PROTOCOL_VERSION);\n+    WithOrVersion(&ssout, 0) << mtx;\n+    WithOrVersion(&ssout, 0) >> tx;\n+\n+    // check all inputs concurrently, with the cache\n+    CachedHashesMap cachedHashesMap;\n+    boost::thread_group threadGroup;\n+    CCheckQueue<CScriptCheck> scriptcheckqueue(128);\n+    CCheckQueueControl<CScriptCheck> control(&scriptcheckqueue);\n+\n+    for (int i=0; i<20; i++)\n+        threadGroup.create_thread(boost::bind(&CCheckQueue<CScriptCheck>::Thread, boost::ref(scriptcheckqueue)));\n+\n+    CCoins coins;\n+    coins.nVersion = 1;\n+    coins.fCoinBase = false;\n+    for(uint32_t i = 0; i < mtx.vin.size(); i++) {\n+        CTxOut txout;\n+        txout.nValue = 1000;\n+        txout.scriptPubKey = scriptPubKey;\n+        coins.vout.push_back(txout);\n+    }\n+\n+    for(uint32_t i = 0; i < mtx.vin.size(); i++) {\n+        std::vector<CScriptCheck> vChecks;\n+        CScriptCheck check(coins, tx, i, SCRIPT_VERIFY_P2SH | SCRIPT_VERIFY_WITNESS, false, &cachedHashesMap);\n+        vChecks.push_back(CScriptCheck());\n+        check.swap(vChecks.back());\n+        control.Add(vChecks);\n+    }\n+\n+    bool controlCheck = control.Wait();\n+    assert(controlCheck);\n+\n+    threadGroup.interrupt_all();\n+    threadGroup.join_all();\n+}\n+\n BOOST_AUTO_TEST_CASE(test_witness)\n {\n+    ScriptError serror;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72875978",
      "id" : 72875978,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 135,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72875978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881516"
         }
      },
      "body" : "it is CachedHashes is modified by SignatureHash",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-30T04:06:09Z",
      "diff_hunk" : "@@ -133,12 +153,14 @@ class TransactionSignatureChecker : public BaseSignatureChecker\n     const CTransaction* txTo;\n     unsigned int nIn;\n     const CAmount amount;\n+    mutable CachedHashes* cachedHashes;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881516",
      "id" : 72881516,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 39,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881516",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881615"
         }
      },
      "body" : "> it is CachedHashes is modified by SignatureHash\n\nI don't think so? cacheHashes is not modified. *cacheHashes is.\n\nIf you have a const TransactionSignatureChecker method, its cacheHashes\nvariable is of type const pointer to non-const CachedHashes. It means the\npointer can't be changed, but the object pointed to can be.\n",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-30T04:15:08Z",
      "diff_hunk" : "@@ -133,12 +153,14 @@ class TransactionSignatureChecker : public BaseSignatureChecker\n     const CTransaction* txTo;\n     unsigned int nIn;\n     const CAmount amount;\n+    mutable CachedHashes* cachedHashes;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881615",
      "id" : 72881615,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 39,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881615",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881635"
         }
      },
      "body" : "oh, it is not needed, by which magic. I remember having to add it because I was modifying it in SignatureHash, why not anymore?",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-07-30T04:17:03Z",
      "diff_hunk" : "@@ -133,12 +153,14 @@ class TransactionSignatureChecker : public BaseSignatureChecker\n     const CTransaction* txTo;\n     unsigned int nIn;\n     const CAmount amount;\n+    mutable CachedHashes* cachedHashes;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r72881635",
      "id" : 72881635,
      "original_commit_id" : "16bc57830037714e2e6000ac1cac1a8af800eabc",
      "original_position" : 39,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-01T15:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/72881635",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "@sipa nits fix",
      "created_at" : "2016-07-30T04:22:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236340830",
      "id" : 236340830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-30T04:22:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236340830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "utACK 5547521c0ae38583e9f0504b3302bba928f5477d\r\nWill test.\r\n",
      "created_at" : "2016-07-30T18:06:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236380272",
      "id" : 236380272,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-07-30T18:06:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236380272",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2016-08-01T14:47:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236602701",
      "id" : 236602701,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-01T14:47:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236602701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, it made the diff smaller as [this commit](https://github.com/bitcoin/bitcoin/commit/a6cc299541fc9df5af010ce63eb1dd34d8c4b6e2) removed a code path where CachedHashesMap was previously needed. (but not used)",
      "created_at" : "2016-08-01T15:11:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-236609730",
      "id" : 236609730,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-01T15:28:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/236609730",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Noting that this requires backport to 0.13 before segwit is activated.",
      "created_at" : "2016-08-02T23:26:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-237080719",
      "id" : 237080719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-02T23:26:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237080719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73450580"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73450580"
         }
      },
      "body" : "You can move this include to the cpp or save the ```class CachedHashes;``` below.",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-08-04T01:32:43Z",
      "diff_hunk" : "@@ -0,0 +1,27 @@\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef SRC_CACHEDHASHESMAP_H\n+#define SRC_CACHEDHASHESMAP_H\n+\n+\n+#include \"script/interpreter.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73450580",
      "id" : 73450580,
      "original_commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "original_position" : 9,
      "path" : "src/script/cachedhashesmap.h",
      "position" : 9,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-04T01:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73450580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73450694"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73450694"
         }
      },
      "body" : "Style: Maybe we want a variable for TransactionSignatureChecker here at some point?",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-08-04T01:34:21Z",
      "diff_hunk" : "@@ -84,8 +84,8 @@ static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptP\n \n         // Regardless of the verification result, the tx did not error.\n         set_error(err, bitcoinconsensus_ERR_OK);\n-\n-        return VerifyScript(tx.vin[nIn].scriptSig, CScript(scriptPubKey, scriptPubKey + scriptPubKeyLen), nIn < tx.wit.vtxinwit.size() ? &tx.wit.vtxinwit[nIn].scriptWitness : NULL, flags, TransactionSignatureChecker(&tx, nIn, amount), NULL);\n+        CachedHashes cachedHashes;\n+        return VerifyScript(tx.vin[nIn].scriptSig, CScript(scriptPubKey, scriptPubKey + scriptPubKeyLen), nIn < tx.wit.vtxinwit.size() ? &tx.wit.vtxinwit[nIn].scriptWitness : NULL, flags, TransactionSignatureChecker(&tx, nIn, amount, cachedHashes), NULL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73450694",
      "id" : 73450694,
      "original_commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "original_position" : 7,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 7,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-04T01:34:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73450694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "utACK 7dbd2e7",
      "created_at" : "2016-08-04T01:54:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-237430348",
      "id" : 237430348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-04T01:54:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237430348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73675429"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73675429"
         }
      },
      "body" : "s/2015/2016/",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-08-05T10:56:09Z",
      "diff_hunk" : "@@ -0,0 +1,21 @@\n+// Copyright (c) 2009-2015 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73675429",
      "id" : 73675429,
      "original_commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "original_position" : 1,
      "path" : "src/script/cachedhashesmap.cpp",
      "position" : 1,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-05T10:56:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73675429",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73675445"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73675445"
         }
      },
      "body" : "s/2015/2016/",
      "commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "created_at" : "2016-08-05T10:56:17Z",
      "diff_hunk" : "@@ -0,0 +1,27 @@\n+// Copyright (c) 2009-2015 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#discussion_r73675445",
      "id" : 73675445,
      "original_commit_id" : "7dbd2e7df51c55724018b58fb7f0777567122633",
      "original_position" : 1,
      "path" : "src/script/cachedhashesmap.h",
      "position" : 1,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8422",
      "updated_at" : "2016-08-05T10:56:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/73675445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "utACK 7dbd2e7\r\n",
      "created_at" : "2016-08-05T10:57:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-237822515",
      "id" : 237822515,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-05T10:57:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237822515",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "@btcdrak updated the file header.",
      "created_at" : "2016-08-05T20:49:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-237962520",
      "id" : 237962520,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-05T20:49:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237962520",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Tested ACK 910e7bb0fc519eacca6aff996dec31e9f0185bc8: I timed the verification in the added test_big_witness_transaction test, and backported it to master (without sighash cache); this PR made it 7.5 times faster.",
      "created_at" : "2016-08-15T17:17:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-239865313",
      "id" : 239865313,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-15T17:17:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/239865313",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Merely listing this for exposure, as I am perfectly fine with merging this PR here as it is:\r\n\r\nI made an altered implementation in https://github.com/sipa/bitcoin/commits/noprecomputecachedhashes that simply precomputes the 3 hashes for each transaction. In the listed benchmark, it is around 1% faster than the PR here. It may be preferable if we want to avoid contention on the sighash cache like in #8464.",
      "created_at" : "2016-08-16T10:18:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-240063171",
      "id" : 240063171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-16T10:34:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/240063171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa actually I did that before (https://github.com/bitcoin/bitcoin/pull/8259)\r\n\r\nEDIT: ah no, it is actually different",
      "created_at" : "2016-08-16T12:29:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-240087205",
      "id" : 240087205,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-16T12:30:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/240087205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "supersede by https://github.com/bitcoin/bitcoin/pull/8524",
      "created_at" : "2016-08-28T12:35:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8422#issuecomment-242972442",
      "id" : 242972442,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8422",
      "updated_at" : "2016-08-28T12:35:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242972442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   }
]
