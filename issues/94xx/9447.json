{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "This is built off of #9375, #9252, and #9400.  I'll properly rebase it when those are merged.\r\n\r\nIt provides special logic to issue a second getdata request for a cmpctblock if there is only 1 request outstanding and we think the announced block would be our new tip.\r\n\r\nIt also changes the cmpctblock processing logic to be first come first served (regardless of in flight block requests) and allow two simultaneous compact block reconstructions.  \r\n\r\nSo in particular, it is now possible to:\r\n- receive headers -> request cmpctblock from peer 1\r\n- receive headers -> request cmpctblock from peer 2\r\n- receive cmpctblock -> request blocktxn from peer 3\r\n- receive cmpctblock -> request blocktxn from peer 4\r\n\r\nUpon receiving a cmpctblock from peers 1 or 2 after this, it will be treated the same as receiving an unsolicited cmpctblock from peer 5 and it will attempt opportunistic reconstruction but not request blocktxn.  It will also remove the block in flight for peer 1 or 2.\r\n\r\nI believe that the multiple requests is an acceptable increase in bandwidth in order to provide robustness against a single peer stalling us at any point in the logic.  The reason to allow a second request for a cmpctblock is to allow LB peers a chance to become HB even if there is a staller who is always announcing first, otherwise, only existing HB peers would have a chance to deliver the block.\r\n\r\n\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 13,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9447/comments",
   "created_at" : "2016-12-30T15:35:45Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9447/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/9447",
   "id" : 198160795,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "id" : 98298007,
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      },
      {
         "color" : "6060aa",
         "default" : false,
         "id" : 118379652,
         "name" : "Validation",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9447/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 9447,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/9447.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9447",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/9447.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9447"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Allow 2 simultaneous block downloads",
   "updated_at" : "2017-09-06T00:46:52Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9447",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
      "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
      "followers_url" : "https://api.github.com/users/morcos/followers",
      "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/morcos",
      "id" : 4360349,
      "login" : "morcos",
      "organizations_url" : "https://api.github.com/users/morcos/orgs",
      "received_events_url" : "https://api.github.com/users/morcos/received_events",
      "repos_url" : "https://api.github.com/users/morcos/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/morcos"
   }
}
