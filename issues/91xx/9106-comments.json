[
   {
      "body" : "@dooglus I originally played around with slightly \"smarter\" fee algorithms that started at the most expensive bucket but looked for the point of no return so to speak where the confirmation percentage dropped below the threshold never to return.  Every permutation I tried seemed susceptible to not being ideal in some particular circumstance or gameable, so it seemed better to err on the side of simpler.\r\n\r\nAs for starting from the cheapest bucket, we can't do that because then the gaming you posited could potentially happen in reverse causing the fee estimates of all targets above some minimum to become useless if a miner was indiscriminately including things in that low fee range.  For instance perhaps these are paid for out of band or were being confirmed by priority or some other mechanism..\r\n\r\nThe change from 85% to 95% was motivated by a desire to respond more quickly to changes in market conditions.  It's quite typical for there to be popular buckets that get tons of data points.  If for instance 97% of transactions in the 40 sat/byte bucket are being confirmed within 2 blocks and all of a sudden the mempool fills up and none get confirmed.  It could take many hours for the confirmation rate to drop below 85% especially because people will adjust quicker and stop giving new failing data points at that fee rate.\r\n\r\nIn general the fee estimation algorithm in Core is meant to be conservative.  It's the fee you should put on your transaction if you really want to be very sure your transaction will confirm in that target.  You can always see how much money you would save by selecting a longer target and realizing that you are likely to be confirmed sometime within that range, not necessarily at the end of it.  I would recommend never ever using 1 as a target.  \r\n\r\nAll that said, it is an art more than a science, and I welcome interest in people trying to improve it.\r\n",
      "created_at" : "2016-11-08T21:36:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-259267172",
      "id" : 259267172,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2016-11-08T21:36:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259267172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "> The change from 85% to 95% was motivated by a desire to respond more quickly to changes in market conditions\r\n\r\nHow about if there were a 2nd, optional parameter to the `estimate*fee` calls giving the percentage. It could default to 95, to give the same behavior as the current code by default, but I could `estimatefee 1 90` to see how much fee I need to include to have a 90% chance of getting into the next block.\r\n\r\nWould just a pull request likely be merged?",
      "created_at" : "2016-11-10T20:17:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-259796016",
      "id" : 259796016,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2016-11-10T20:17:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259796016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "The purpose of estimatesmartfee was to be able to add additional parameters like that.\r\n\r\nI think the only question is how to add that and not lock it in as some sort of positional argument that makes it harder to add other parameters to estimatesmartfee.\r\n\r\nI still wouldn't use it with a target of 1 though.\r\n",
      "created_at" : "2016-11-10T20:52:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-259804012",
      "id" : 259804012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2016-11-10T20:52:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259804012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Just saw #8811, I think once that is merged, then I'd be in favor of such a PR",
      "created_at" : "2016-11-10T20:55:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-259805008",
      "id" : 259805008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2016-11-10T20:55:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259805008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "I think we should probably disable estimate*fee 1 entirely...targeting the next block is bound to fail/be unreliable.",
      "created_at" : "2016-11-11T22:26:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-260070070",
      "id" : 260070070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2016-11-11T22:26:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260070070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Appears closeable given Fee-Rate improvements in .15 -- @dooglus?",
      "created_at" : "2017-09-05T13:10:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-327170110",
      "id" : 327170110,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2017-09-05T13:10:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327170110",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/14876936?v=4",
         "events_url" : "https://api.github.com/users/Leviathn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Leviathn/followers",
         "following_url" : "https://api.github.com/users/Leviathn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Leviathn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Leviathn",
         "id" : 14876936,
         "login" : "Leviathn",
         "organizations_url" : "https://api.github.com/users/Leviathn/orgs",
         "received_events_url" : "https://api.github.com/users/Leviathn/received_events",
         "repos_url" : "https://api.github.com/users/Leviathn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Leviathn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Leviathn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Leviathn"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```\r\nestimatefee\r\nDEPRECATED. Please use estimatesmartfee for more intelligent estimates.",
      "created_at" : "2017-09-05T18:25:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9106#issuecomment-327261791",
      "id" : 327261791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9106",
      "updated_at" : "2017-09-05T18:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327261791",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
