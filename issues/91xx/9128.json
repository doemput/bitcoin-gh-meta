{
   "assignee" : null,
   "assignees" : [],
   "body" : "This contains a more complete version of #9117, as well as the changes promised to @TheBlueMatt in #8708. They're combined here because the PushMessage changes require that the SendVersion is sane. This will be my last time messing with PushMessage, and it's nearing the end of the net changes needed outside of actual net code...\r\n\r\nThe changes here:\r\n- Don't send messages after fDisconnect is set. (feeler connections are a TODO exception).\r\n- Don't use CSerializeData for outgoing data, which incurred a memory_cleanse for each message. Messages aren't secret, and going forward, if they are they'll be encrypted.\r\n- Add a thin, featureless serializer to turn any set of args into a byte vector.\r\n- Add an go-between message maker so that CConnman sees only serialized messages for pushing.\r\n- That means that the caller is now responsible for determining the node's send version. That's a good thing, it can now move to CNodeState as later step.\r\n- CConnman attaches the header and hashes the byte vector. @jonasschnelli: This should be very easy to adapt to bip151. A new flag SERIALIZE_BIP151_ENCRYPTED or so can be added and used similar to SERIALIZE_TRANSACTION_NO_WITNESS.\r\n",
   "closed_at" : "2016-11-25T19:18:55Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
      "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sipa/followers",
      "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sipa",
      "id" : 548488,
      "login" : "sipa",
      "organizations_url" : "https://api.github.com/users/sipa/orgs",
      "received_events_url" : "https://api.github.com/users/sipa/received_events",
      "repos_url" : "https://api.github.com/users/sipa/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sipa"
   },
   "comments" : 20,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9128/comments",
   "created_at" : "2016-11-11T06:28:14Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9128/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/9128",
   "id" : 188693942,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "id" : 98298007,
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9128/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 9128,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/9128.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9128",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/9128.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9128"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "net: Decouple CConnman and message serialization",
   "updated_at" : "2016-11-25T19:18:55Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9128",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
      "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theuni/followers",
      "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theuni",
      "id" : 417043,
      "login" : "theuni",
      "organizations_url" : "https://api.github.com/users/theuni/orgs",
      "received_events_url" : "https://api.github.com/users/theuni/received_events",
      "repos_url" : "https://api.github.com/users/theuni/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theuni"
   }
}
