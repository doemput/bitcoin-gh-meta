{
   "assignee" : null,
   "assignees" : [],
   "body" : "Reported by @roasbeef and @chjj on IRC.\r\n\r\n### Describe the issue\r\n\r\nWhen we receive a transaction with an unknown input, since 0.13.0 we send a getdata for that transaction in response, to quickly learn the dependency. Unfortunately, we always ask for it as MSG_TX instead of MSG_WITNESS_TX.\r\n\r\n### Can you reliably reproduce the issue?\r\n\r\n```\r\n18:20:33 < roasbeef> hmm, chjj and I seem to be encountering some odd behavior with segwit enabled core nodes on testnet: they aren't including witness_tx inv's in their getdata's when\r\n                     fetching transactions, so they fetch witness output spending transactions without the witness data (though the service bit is set). this should cause an immediate\r\n                     rejecvt due to the clean-stack rules, but they keep accepting the txns, sending a delayed reject minutes afterwards\r\n18:26:52 < sipa> roasbeef: they send MSG_TX getdatas instead of MSG_WITNESS_TX ?\r\n18:27:11 < roasbeef> sipa: yeh\r\n```\r\n\r\n### Expected behaviour\r\n\r\nDon't see any MSG_TX getdatas between witness-enabled peers.\r\n\r\n### Actual behaviour\r\n\r\nSee some MSG_TX getdatas.\r\n\r\n### What version of bitcoin-core are you using?\r\n\r\n```\r\n18:28:08 < chjj> sipa: seems to be both 13.0 and 13.1 nodes\r\n```\r\n",
   "closed_at" : "2016-12-17T11:29:40Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
      "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
      "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/MarcoFalke",
      "id" : 6399679,
      "login" : "MarcoFalke",
      "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
      "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
      "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/MarcoFalke"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9182/comments",
   "created_at" : "2016-11-18T02:40:07Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9182/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/9182",
   "id" : 190222067,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "id" : 98298007,
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9182/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 24,
      "created_at" : "2016-10-25T17:47:53Z",
      "creator" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      },
      "description" : null,
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestone/24",
      "id" : 2092952,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/24/labels",
      "number" : 24,
      "open_issues" : 4,
      "state" : "open",
      "title" : "0.13.2",
      "updated_at" : "2016-12-17T11:29:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/24"
   },
   "number" : 9182,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Orphan-triggered tx fetch does not ask for witness data",
   "updated_at" : "2016-12-17T11:29:40Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9182",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
      "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sipa/followers",
      "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sipa",
      "id" : 548488,
      "login" : "sipa",
      "organizations_url" : "https://api.github.com/users/sipa/orgs",
      "received_events_url" : "https://api.github.com/users/sipa/received_events",
      "repos_url" : "https://api.github.com/users/sipa/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sipa"
   }
}
