{
   "assignee" : null,
   "body" : "Running 0.8.2-beta on OSX 10.8.4\r\n\r\nOpened Qt to a corrupted chainstate, and was told to rebuild. Decided to do it later, so chose abort from the popup. \r\n\r\nOpened Qt the next day to no corruption message, and it's just syncing per normal.\r\n\r\nThis debug snippet below is from the shutdown before corruption, opening the corrupted wallet and choosing to not rebuild and finally opening the wallet and having it load successfully.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAdded 1 addresses from 173.197.107.3: 683 tried, 13640 new\r\nreceived getdata for: tx a535a410388497f78b4bb77b9c929242d6174b0d26f396cc10212d9dcfafb95e\r\nCTxMemPool::accept() : accepted e3406befa1868f30485c44a460586ec374186b3ce07e1c287b6afdbb44a8909f (poolsz 1451)\r\nreceived getdata for: tx e3406befa1868f30485c44a460586ec374186b3ce07e1c287b6afdbb44a8909f\r\nreceived getdata for: tx e3406befa1868f30485c44a460586ec374186b3ce07e1c287b6afdbb44a8909f\r\nFlushed 14323 addresses to peers.dat  24ms\r\nAdded 1 addresses from 173.197.107.3: 683 tried, 13640 new\r\nreceived getdata for: tx 8a7b68238126e3a167f8d4369bc1b5c832147e6b3aa5a291b2af462f2a4b51ff\r\ndumpaddr thread stop\r\nmsghand thread interrupt\r\nopencon thread interrupt\r\nnet thread interrupt\r\naddcon thread interrupt\r\nFlush(false)\r\nDBFlush(false) ended               0ms\r\nStopNode()\r\nUPNP_DeletePortMapping() returned : 0\r\nupnp thread interrupt\r\nFlushed 14322 addresses to peers.dat  25ms\r\nCommitting 775 changed transactions to coin database...\r\nFlush(true)\r\nwallet.dat refcount=0\r\nwallet.dat checkpoint\r\nwallet.dat detach\r\nwallet.dat closed\r\nDBFlush(true) ended              67ms\r\n\r\n\r\n\r\n\r\n\r\n\r\nBitcoin version v0.8.2-beta (2013-05-25 08:48:25 -0700)\r\nUsing OpenSSL version OpenSSL 1.0.1c 10 May 2012\r\nStartup time: 2013-06-22 15:18:30\r\nDefault data directory /Users/xxxx/Library/Application Support/Bitcoin\r\nUsing data directory /Users/xxxx/Library/Application Support/Bitcoin\r\nUsing at most 125 connections (2560 file descriptors available)\r\nUsing 8 threads for script verification\r\ninit message: Verifying wallet...\r\ndbenv.open LogDir=/Users/xxxx/Library/Application Support/Bitcoin/database ErrorFile=/Users/xxxx/Library/Application Support/Bitcoin/db.log\r\nBound to [::]:8333\r\nBound to 0.0.0.0:8333\r\ninit message: Loading block index...\r\nOpening LevelDB in /Users/xxxx/Library/Application Support/Bitcoin/blocks/index\r\nOpened LevelDB successfully\r\nOpening LevelDB in /Users/xxxx/Library/Application Support/Bitcoin/chainstate\r\nOpened LevelDB successfully\r\nLoadBlockIndexDB(): last block file = 67\r\nLoadBlockIndexDB(): last block file info: CBlockFileInfo(blocks=175, size=28716039, heights=242380...242554, time=2013-06-20...2013-06-21)\r\nLoadBlockIndexDB(): transaction index disabled\r\nLoadBlockIndexDB(): hashBestChain=00000000000000241476e0d024a206a2e8555a97f0fc0b5ab522d492b5dab34f  height=242554 date=2013-06-21 06:54:39\r\ninit message: Verifying blocks...\r\nVerifying last 288 blocks at level 3\r\nLevelDB read failure: Corruption: block checksum mismatch\r\nFlush(false)\r\nDBFlush(false) ended               0ms\r\nStopNode()\r\nFlushed 0 addresses to peers.dat  1ms\r\nCommitting 8 changed transactions to coin database...\r\nFlush(true)\r\nDBFlush(true) ended               0ms\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBitcoin version v0.8.2-beta (2013-05-25 08:48:25 -0700)\r\nUsing OpenSSL version OpenSSL 1.0.1c 10 May 2012\r\nStartup time: 2013-06-23 04:32:54\r\nDefault data directory /Users/xxxx/Library/Application Support/Bitcoin\r\nUsing data directory /Users/xxxx/Library/Application Support/Bitcoin\r\nUsing at most 125 connections (2560 file descriptors available)\r\nUsing 8 threads for script verification\r\ninit message: Verifying wallet...\r\ndbenv.open LogDir=/Users/xxxx/Library/Application Support/Bitcoin/database ErrorFile=/Users/xxxx/Library/Application Support/Bitcoin/db.log\r\nBound to [::]:8333\r\nBound to 0.0.0.0:8333\r\ninit message: Loading block index...\r\nOpening LevelDB in /Users/xxxx/Library/Application Support/Bitcoin/blocks/index\r\nOpened LevelDB successfully\r\nOpening LevelDB in /Users/xxxx/Library/Application Support/Bitcoin/chainstate\r\nOpened LevelDB successfully\r\nLoadBlockIndexDB(): last block file = 67\r\nLoadBlockIndexDB(): last block file info: CBlockFileInfo(blocks=175, size=28716039, heights=242380...242554, time=2013-06-20...2013-06-21)\r\nLoadBlockIndexDB(): transaction index disabled\r\nLoadBlockIndexDB(): hashBestChain=00000000000000241476e0d024a206a2e8555a97f0fc0b5ab522d492b5dab34f  height=242554 date=2013-06-21 06:54:39\r\ninit message: Verifying blocks...\r\nVerifying last 288 blocks at level 3\r\nNo coin database inconsistencies in last 150 blocks (53329 transactions)\r\n block index           17768ms\r\ninit message: Loading wallet...\r\nnFileVersion = 80202\r\n wallet                 1171ms\r\ninit message: Loading addresses...\r\nLoaded 0 addresses from peers.dat  1ms\r\nmapBlockIndex.size() = 242556\r\nnBestHeight = 242554\r\nsetKeyPool.size() = 100\r\nmapWallet.size() = 19\r\nmapAddressBook.size() = 24\r\ndnsseed thread start\r\nupnp thread start\r\nLoading addresses from DNS seeds (could take a while)\r\nnet thread start\r\naddcon thread start\r\nopencon thread start\r\nmsghand thread start\r\ndumpaddr thread start\r\nFlushed 0 addresses to peers.dat  1ms\r\ninit message: Done loading\r\n ",
   "closed_at" : "2014-01-17T12:28:27Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 11,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2785/comments",
   "created_at" : "2013-06-23T05:02:16Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2785/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/2785",
   "id" : 15893274,
   "labels" : [
      {
         "color" : "FBBAAB",
         "name" : "Bug",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "660000",
         "name" : "MacOSX",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/MacOSX"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2785/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 2785,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "ChainState DB uncorrupted itself",
   "updated_at" : "2015-06-13T12:07:34Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2785",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=3",
      "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/fanquake/followers",
      "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/fanquake",
      "id" : 863730,
      "login" : "fanquake",
      "organizations_url" : "https://api.github.com/users/fanquake/orgs",
      "received_events_url" : "https://api.github.com/users/fanquake/received_events",
      "repos_url" : "https://api.github.com/users/fanquake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/fanquake"
   }
}
