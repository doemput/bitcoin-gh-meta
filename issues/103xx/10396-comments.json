[
   {
      "body" : "Why remove bytes_serialized?",
      "created_at" : "2017-05-14T14:58:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301318509",
      "id" : 301318509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-14T14:58:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301318509",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/666706?v=3",
         "events_url" : "https://api.github.com/users/JohnDolittle/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JohnDolittle/followers",
         "following_url" : "https://api.github.com/users/JohnDolittle/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JohnDolittle/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JohnDolittle",
         "id" : 666706,
         "login" : "JohnDolittle",
         "organizations_url" : "https://api.github.com/users/JohnDolittle/orgs",
         "received_events_url" : "https://api.github.com/users/JohnDolittle/received_events",
         "repos_url" : "https://api.github.com/users/JohnDolittle/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JohnDolittle/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JohnDolittle/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JohnDolittle"
      }
   },
   {
      "body" : "> Why remove bytes_serialized?\r\n\r\nIt has no real meaning. It wasn't an accurate representation of how much space on disk was used, and its definition is very hard to maintain after #10195.",
      "created_at" : "2017-05-14T18:27:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301330627",
      "id" : 301330627,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-14T18:27:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301330627",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Nice idea to add the leveldb size estimate - I had no idea such a thing existed.\r\n\r\nI'm not that happy that `bytes_serialized` is a going away. \r\n\r\nIt provided a fairly neutral way of measuring the UTXO set size (It is not dependent on a specific database implementation and its overhead), I understand leveldb's estimate is better in estimating the actual disk usage, but `bytes_serialized` is useful for comparison against older versions of the same value for statistics and such. \r\n\r\n> It has no real meaning. It wasn't an accurate representation of how much space on disk was used, and its definition is very hard to maintain after #10195.\r\n\r\nIsn't it a necessary by-product of computing `hash_serialized`?\r\nEdit: ah so #10195 changes the meaning of that and renames it, I guess we could do `bytes_serialized_2` instead, to signify that there is a break with the past format?\r\n",
      "created_at" : "2017-05-15T05:11:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301377770",
      "id" : 301377770,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-15T05:37:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301377770",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "The problem is mostly that after #10195, we start relying heavily on LevelDB's prefix compression (whenever two subsequent keys share a prefix, that  repeated part is not encoded). This is needed because multiple outputs from the same txid otherwise will require an extra 32 bytes on disk for every output after the first.\n\nIt is possible to implement a compatibility layer, which processes the outputs in pertxout, re-assembles them into per-tx things, and uses that to compute bytes_serialized and hash_serialized (that's what #10195 currently does, however, it cannot remain exactly the same as now, as the txversion information is dropped from the db).\n\nIt would be much simpler if no such compatibility hack was needed, and bytes_serialized is either dropped entirely (this PR), or replaced with something that has hardly any relation with the disk size anymore. Especially if we ever want to be able to have gettxoutsetinfo not iterate through the whole set anymore...",
      "created_at" : "2017-05-15T05:41:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301381106",
      "id" : 301381106,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-15T05:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301381106",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Updated to no longer remove `hash_serialized`. We can discuss its removal or semantics change independently.",
      "created_at" : "2017-05-15T07:23:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301396511",
      "id" : 301396511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-15T07:23:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301396511",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Compiling this brings a lot of new warnings:\r\n\r\n```\r\n+In file included from test/test_bitcoin_fuzzy.cpp:14:\r\n+./coins.h:342:10: warning: 'GetCoins' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]\r\n+    bool GetCoins(const uint256 &txid, CCoins &coins) const;\r\n+         ^\r\n+./coins.h:310:18: note: overridden virtual function is here\r\n+    virtual bool GetCoins(const uint256 &txid, CCoins &coins) const;\r\n+                 ^\r\n+./coins.h:343:10: warning: 'HaveCoins' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]\r\n+    bool HaveCoins(const uint256 &txid) const;\r\n+         ^\r\n+./coins.h:314:18: note: overridden virtual function is here\r\n+    virtual bool HaveCoins(const uint256 &txid) const;\r\n+                 ^\r\n+./coins.h:344:13: warning: 'GetBestBlock' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]\r\n+    uint256 GetBestBlock() const;\r\n+            ^\r\n+./coins.h:317:21: note: overridden virtual function is here\r\n+    virtual uint256 GetBestBlock() const;\r\n+                    ^\r\n+./coins.h:346:10: warning: 'BatchWrite' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]\r\n+    bool BatchWrite(CCoinsMap &mapCoins, const uint256 &hashBlock);\r\n+         ^\r\n+./coins.h:321:18: note: overridden virtual function is here\r\n+    virtual bool BatchWrite(CCoinsMap &mapCoins, const uint256 &hashBlock);\r\n+                 ^\r\n+./coins.h:347:23: warning: 'Cursor' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]\r\n+    CCoinsViewCursor *Cursor() const;\r\n+                      ^\r\n+./coins.h:324:31: note: overridden virtual function is here\r\n+    virtual CCoinsViewCursor *Cursor() const;\r\n+                              ^\r\n+5 warnings generated.\r\n```",
      "created_at" : "2017-05-15T09:30:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301424372",
      "id" : 301424372,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-15T09:30:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301424372",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@paveljanik Those warnings seem unrelated. #10195 adds the necessary overrides as most of the relevant function signatures and changed there anyway, but I don't think that should happen in this PR.",
      "created_at" : "2017-05-15T22:43:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-301625801",
      "id" : 301625801,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-15T22:43:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/301625801",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "The problem is that if you use `override` in one place in a class, the compiler (at least gcc?) wants you to use it everywhere where it's appropriate. Might be better to leave it out then add it for the whole class later. Warnings in .h files are kind of annoying as they get emitted for every single compilation unit that includes them.\r\n\r\nutACK otherwise",
      "created_at" : "2017-05-22T10:42:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-303064704",
      "id" : 303064704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-22T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/303064704",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Rebased, and removed the `override` for now.",
      "created_at" : "2017-05-30T19:56:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-304990098",
      "id" : 304990098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-05-30T19:56:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/304990098",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10396#discussion_r119679251"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10396"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119679251"
         }
      },
      "body" : "Seems you forgot one, I still get warnings for `override` in this class",
      "commit_id" : "fa0ac9d0256528ef645dc2ef432a806c1c6f7128",
      "created_at" : "2017-06-01T17:30:15Z",
      "diff_hunk" : "@@ -342,6 +345,7 @@ class CCoinsViewBacked : public CCoinsView\n     void SetBackend(CCoinsView &viewIn);\n     bool BatchWrite(CCoinsMap &mapCoins, const uint256 &hashBlock);\n     CCoinsViewCursor *Cursor() const;\n+    size_t EstimateSize() const override;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#discussion_r119679251",
      "id" : 119679251,
      "original_commit_id" : "7086ee08ceea1caca1597c921880cab2a37784ad",
      "original_position" : 14,
      "path" : "src/coins.h",
      "position" : null,
      "pull_request_review_id" : 41581988,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10396",
      "updated_at" : "2017-06-01T22:01:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119679251",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10396#discussion_r119740466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10396"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119740466"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "fa0ac9d0256528ef645dc2ef432a806c1c6f7128",
      "created_at" : "2017-06-01T22:03:00Z",
      "diff_hunk" : "@@ -342,6 +345,7 @@ class CCoinsViewBacked : public CCoinsView\n     void SetBackend(CCoinsView &viewIn);\n     bool BatchWrite(CCoinsMap &mapCoins, const uint256 &hashBlock);\n     CCoinsViewCursor *Cursor() const;\n+    size_t EstimateSize() const override;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#discussion_r119740466",
      "id" : 119740466,
      "original_commit_id" : "7086ee08ceea1caca1597c921880cab2a37784ad",
      "original_position" : 14,
      "path" : "src/coins.h",
      "position" : null,
      "pull_request_review_id" : 41649545,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10396",
      "updated_at" : "2017-06-01T22:03:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119740466",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing because merged as part of #10195.",
      "created_at" : "2017-06-01T23:33:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10396#issuecomment-305648898",
      "id" : 305648898,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10396",
      "updated_at" : "2017-06-01T23:33:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/305648898",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
