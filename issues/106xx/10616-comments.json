[
   {
      "body" : "I think using dynamic libraries would be better *unless* there's a significant performance improvement from LTO...",
      "created_at" : "2017-06-16T22:24:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-309148110",
      "id" : 309148110,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-06-16T22:24:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/309148110",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr this more or less completely orthogonal from dynamic libraries.",
      "created_at" : "2017-06-17T00:26:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-309172155",
      "id" : 309172155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-06-17T00:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/309172155",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I was under the impression LTO was fundamentally incompatible with dynamic libraries, due to its optimisation methods?",
      "created_at" : "2017-06-17T00:50:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-309178966",
      "id" : 309178966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-06-17T00:50:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/309178966",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "LTO code can statically or dynamically link non-LTO code.",
      "created_at" : "2017-06-17T00:52:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-309179093",
      "id" : 309179093,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-06-17T00:52:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/309179093",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Seems like a good idea to me.\r\n\r\nStatic/dynamc linking is orthogonal, although one option would be to build the depends with LTO as well, then with static linking the entire executable can be optimized by the linker, also calls crossing library boundaries. But I\"m not sure this is worth the extra build time - the important dependencies from a performance point of view are secp256k1 and leveldb and those are already internal.",
      "created_at" : "2017-06-29T12:28:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-311951663",
      "id" : 311951663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-06-29T12:28:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311951663",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@theuni Is there anything special in the build scripts that would get in the way of this?",
      "created_at" : "2017-07-06T00:52:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313265500",
      "id" : 313265500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T00:52:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313265500",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell It depends on what the definition of LTO is here. As @laanwj said, taking this as far as possible, the dependencies can also be built with LTO, which ends in one final massive link. There were a few issues with that last I tried, most having to do with ODR violations (bdb and qt, iirc).\r\n\r\nFor just LTO'ing our own builds, I think it should just work if the compiler is capable.\r\n\r\nWe could start by adding an \"--enable-lto\" configure option and letting people take it for a spin.",
      "created_at" : "2017-07-06T17:03:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313457785",
      "id" : 313457785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T17:03:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313457785",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Yes, we really should have a configure option, it would be so much easier than manually overriding all of the various wrappers that we have to do now. Still, I dont think we can enable this for a while, eg debian jessie still fails to build with LTO without manually compiling util.cpp without LTO (something to do with header-defined destructors being lost during link, specifically in boost::filesystem).",
      "created_at" : "2017-07-06T17:12:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313460057",
      "id" : 313460057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T17:12:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313460057",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : ">  Still, I dont think we can enable this for a while, eg debian jessie still fails to build with LTO without manually compiling util.cpp without LTO\r\n\r\nIt should definitely not be enabled by default! Programs usually shouldn't add non-standard compilation flags by default unless necessary.\r\n\r\nAFAIK the only thing being discussed here is whether to enable it for the gitian build, and thus the distributed executables.\r\n",
      "created_at" : "2017-07-06T17:29:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313464529",
      "id" : 313464529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T17:29:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313464529",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Well if we're going to do it for the Gitian builds, we want a trivial way to reproduce that outside of Gitian so that we're not surprised by any odd effects. So I think a configure option (which Gitian and maybe Travis) use, would be the way to go.\r\n\r\n@laanwj I'm unsure from your last comment if you'd be opposed to that?",
      "created_at" : "2017-07-06T20:38:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313512634",
      "id" : 313512634,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T20:38:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313512634",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Yes configure option is a good idea of it is disabled by default like the\nglibc compat option.\n\nOn Jul 6, 2017 10:38 PM, \"Cory Fields\" <notifications@github.com> wrote:\n\n> Well if we're going to do it for the Gitian builds, we want a trivial way\n> to reproduce that outside of Gitian so that we're not surprised by any odd\n> effects. So I think a configure option (which Gitian and maybe Travis) use,\n> would be the way to go.\n>\n> @laanwj <https://github.com/laanwj> I'm unsure from your last comment if\n> you'd be opposed to that?\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313512634>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AAHutib92Mu6LTgOM9wlgKMfbF9wB8TJks5sLUXNgaJpZM4N9Akv>\n> .\n>\n",
      "created_at" : "2017-07-06T21:14:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-313521359",
      "id" : 313521359,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-06T21:14:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313521359",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Benchmarks show that at least for me (gcc 6.3, with otherwise normal build options), -flto significantly slows down IBD.",
      "created_at" : "2017-07-16T21:57:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-315640174",
      "id" : 315640174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-16T21:57:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315640174",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Slower?!? that's curious.",
      "created_at" : "2017-07-20T15:36:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10616#issuecomment-316742420",
      "id" : 316742420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10616",
      "updated_at" : "2017-07-20T15:36:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316742420",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
