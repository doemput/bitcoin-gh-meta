{
   "assignee" : null,
   "body" : "**[only affects bitcoin-cli]**\r\n\r\nAt the moment, errors in bitcoin-cli are sent to stderr as compact json string. Example:\r\n\r\n```\r\njonasschnelli$ ./src/bitcoin-cli -regtest sendtoaddress 276536543\r\nerror: {\"code\":-1,\"message\":\"sendtoaddress \\\"bitcoinaddress\\\" amount ( \\\"comment\\\" \\\"comment-to\\\" \r\nsubtractfeefromamount )\\n\\nSend an amount to a given address. The amount is a real and is rounded to the nearest 0.00000001\\n\\nArguments:\\n1. \\\"bitcoinaddress\\\"  (string, required) The bitcoin address to \r\nsend to.\\n2. \\\"amount\\\"      (numeric, required) The amount in btc to send. eg 0.1\\n3. \\\"comment\\\"     (string, optional) A comment used to store what the transaction is for. \\n                             This is not part \r\nof the transaction, just kept in your wallet.\\n4. \\\"comment-to\\\"  (string, optional) A comment to store the name of the person or organization \\n                             to which you're sending the transaction. This is \r\nnot part of the \\n                             transaction, just kept in your wallet.\\n5. subtractfeefromamount  (boolean, optional, default=false) The fee will be deducted from the amount being sent.\\n                             \r\nThe recipient will receive less bitcoins than you enter in the amount field.\\n\\nResult:\\n\\\"transactionid\\\"  (string) The transaction id.\\n\\nExamples:\\n> bitcoin-cli sendtoaddress \r\n\\\"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\\\" 0.1\\n> bitcoin-cli sendtoaddress \\\"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\\\" 0.1 \\\"donation\\\" \\\"seans outpost\\\"\\n> bitcoin-cli \r\nsendtoaddress \\\"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\\\" 0.1 \\\"\\\" \\\"\\\" true\\n> curl --user myusername --data-binary '{\\\"jsonrpc\\\": \\\"1.0\\\", \\\"id\\\":\\\"curltest\\\", \\\"method\\\": \\\"sendtoaddress\\\", \\\"params\\\": \r\n[\\\"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\\\", 0.1, \\\"donation\\\", \\\"seans outpost\\\"] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/\\n\"}\r\n\r\n```\r\n\r\nThis PR would format the error message and error code so that it's better readable. Example after this PR:\r\n```\r\njonasschnelli$ ./src/bitcoin-cli --regtest sendtoaddress mvDv4Z\r\nerror code: -1\r\nerror message:\r\nsendtoaddress \"bitcoinaddress\" amount ( \"comment\" \"comment-to\" subtractfeefromamount )\r\n\r\nSend an amount to a given address. The amount is a real and is rounded to the nearest 0.00000001\r\n\r\nArguments:\r\n1. \"bitcoinaddress\"  (string, required) The bitcoin address to send to.\r\n2. \"amount\"      (numeric, required) The amount in btc to send. eg 0.1\r\n3. \"comment\"     (string, optional) A comment used to store what the transaction is for. \r\n                             This is not part of the transaction, just kept in your wallet.\r\n4. \"comment-to\"  (string, optional) A comment to store the name of the person or organization \r\n                             to which you're sending the transaction. This is not part of the \r\n                             transaction, just kept in your wallet.\r\n5. subtractfeefromamount  (boolean, optional, default=false) The fee will be deducted from the amount being sent.\r\n                             The recipient will receive less bitcoins than you enter in the amount field.\r\n\r\nResult:\r\n\"transactionid\"  (string) The transaction id.\r\n\r\nExamples:\r\n> bitcoin-cli sendtoaddress \"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\" 0.1\r\n> bitcoin-cli sendtoaddress \"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\" 0.1 \"donation\" \"seans outpost\"\r\n> bitcoin-cli sendtoaddress \"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\" 0.1 \"\" \"\" true\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\":\"curltest\", \"method\": \"sendtoaddress\", \"params\": [\"1M72Sfpbz1BPpXFHz9m3CdqATR44Jvaydd\", 0.1, \"donation\", \"seans outpost\"] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n\r\n```",
   "closed_at" : "2015-07-08T11:40:07Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6387/comments",
   "created_at" : "2015-07-07T10:19:53Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6387/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/6387",
   "id" : 93497042,
   "labels" : [
      {
         "color" : "0052cc",
         "name" : "RPC/REST/ZMQ",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6387/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 6387,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/6387.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6387",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/6387.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6387"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "[bitcoin-cli] improve error output",
   "updated_at" : "2015-07-08T11:40:07Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6387",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
      "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
      "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jonasschnelli",
      "id" : 178464,
      "login" : "jonasschnelli",
      "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
      "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
      "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jonasschnelli"
   }
}
