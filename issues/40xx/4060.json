{
   "assignee" : null,
   "body" : "There are plenty of projects now that listen to bitcoind using its rpc interface and maintain a complementary view of the block-chain in a SQL database, sometimes adding extra information. These applications generally poll bitcoind at regular intervals. \r\nIt's very difficult to audit how these applications respond to changes in the best-chain that involve a block rollback. Many times those application break because they were not tested enough in chain split scenarios. Also when creating another full bitcoin implementation, is good if one can simulate these scenarios by connecting the node in development to bitcoind and commanding bitcoind.\r\n\r\nIs there a way to do this already? If not, then I propose the addition of a new rpc command \"truncate-and-submit-blocks\":\r\ntruncate-and-submit-blocks block-height number-of-blocks-to-submit block1-in-hex ... blockN-in-hex\r\n\r\nThe idea of allowing the submission of multiple blocks is that the additions are done atomically, so other connected applications can be tested for sudden best-chain switches without other unpredictable race conditions.\r\n\r\nAlso it's possible to implement only \"truncate block_hight\" but this requires the testing script to control when the complementary application polls for new data.\r\n\r\nAlso a block-chain locking mechanism could help, allowing something like the following rpc commands:\r\n\r\nlock-block-chain\r\ntruncate 200000\r\nsubmitblock ....\r\nsubmitblock ....\r\nunlock-block-chain\r\n",
   "closed_at" : "2015-05-18T08:36:36Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4060/comments",
   "created_at" : "2014-04-15T19:21:28Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4060/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/4060",
   "id" : 31582626,
   "labels" : [
      {
         "color" : "E6F6D6",
         "name" : "Refactoring",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      },
      {
         "color" : "d4c5f9",
         "name" : "Tests",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4060/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 4060,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Add rpc command to allow block-chain rollbacks and re-submits to simulate splits",
   "updated_at" : "2015-05-18T08:36:36Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4060",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
      "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
      "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
      "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
      "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/SergioDemianLerner",
      "id" : 1752347,
      "login" : "SergioDemianLerner",
      "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
      "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
      "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/SergioDemianLerner"
   }
}
