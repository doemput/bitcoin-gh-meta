[
   {
      "body" : "This could be particularly nasty in some use-cases (especially pre-HD-split) - eg a user might fundrawtransaction, then call getnewaddress, hand out the address for someone to pay them, then sendrawtransaction. This may result in the user thinking they have been paid by their counterparty, even though it was really just their change!\r\n\r\nThis could obviously also result in needless keyreuse.",
      "created_at" : "2017-07-10T18:31:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314194713",
      "id" : 314194713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-10T18:32:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314194713",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "History of fundrawtransaction regarding change-output:\r\nBefore 0.14, the change-output keys was never reserved from the key pool (flaw-ish).\r\nSince 0.14, by default, the key will be reserved but there is an option to not reserve it (keep the old behaviour) done via #9377. The option was added because the assumption was that API consumers relay on this old, flaw-ish, behaviour.\r\n\r\nThis PR would basically remove the option to not reserve the key.\r\n\r\nI think in general we should do that, though I'm not sure if there are any API consumers who expect that one can _avoid_ reserving the CO-key. But indeed, that should stop.\r\n\r\nConcept ACK 6715e782c3049ec43c0c94268f9ad924988e5ddf.\r\nPR should have a short release-notes description.",
      "created_at" : "2017-07-11T08:34:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314373721",
      "id" : 314373721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-11T08:34:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314373721",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Concept ACK, seems extremely sensible",
      "created_at" : "2017-07-11T10:24:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314401809",
      "id" : 314401809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-11T10:24:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314401809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3211283?v=3",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "body" : "Would be nice to get an 0.15 tag on this - I think its quite a serious API flaw (which I commented positively on on #9377 :(. Indeed, will need release notes, but I'll leave that for #9889.",
      "created_at" : "2017-07-11T15:10:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314475792",
      "id" : 314475792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-11T15:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314475792",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "cheers",
      "created_at" : "2017-07-12T20:21:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314885475",
      "id" : 314885475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-12T20:21:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314885475",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/15623546?v=3",
         "events_url" : "https://api.github.com/users/MIGUELWAXX/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MIGUELWAXX/followers",
         "following_url" : "https://api.github.com/users/MIGUELWAXX/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MIGUELWAXX/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MIGUELWAXX",
         "id" : 15623546,
         "login" : "MIGUELWAXX",
         "organizations_url" : "https://api.github.com/users/MIGUELWAXX/orgs",
         "received_events_url" : "https://api.github.com/users/MIGUELWAXX/received_events",
         "repos_url" : "https://api.github.com/users/MIGUELWAXX/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MIGUELWAXX/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MIGUELWAXX/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MIGUELWAXX"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10784#discussion_r127070401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10784"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127070401"
         }
      },
      "body" : "You should keep the bottom half of this test to show we're not getting address reuse",
      "commit_id" : "0b12b4da7aebc8a28b0d124d0f1bb269a20dc04a",
      "created_at" : "2017-07-12T21:00:14Z",
      "diff_hunk" : "@@ -636,32 +636,6 @@ def run_test(self):\n         assert_fee_amount(result2['fee'], count_bytes(result2['hex']), 2 * result_fee_rate)\n         assert_fee_amount(result3['fee'], count_bytes(result3['hex']), 10 * result_fee_rate)\n \n-        #############################\n-        # Test address reuse option #\n-        #############################\n-\n-        result3 = self.nodes[3].fundrawtransaction(rawtx, {\"reserveChangeKey\": False})\n-        res_dec = self.nodes[0].decoderawtransaction(result3[\"hex\"])\n-        changeaddress = \"\"\n-        for out in res_dec['vout']:\n-            if out['value'] > 1.0:\n-                changeaddress += out['scriptPubKey']['addresses'][0]\n-        assert(changeaddress != \"\")\n-        nextaddr = self.nodes[3].getrawchangeaddress()\n-        # frt should not have removed the key from the keypool\n-        assert(changeaddress == nextaddr)\n-\n-        result3 = self.nodes[3].fundrawtransaction(rawtx)\n-        res_dec = self.nodes[0].decoderawtransaction(result3[\"hex\"])\n-        changeaddress = \"\"\n-        for out in res_dec['vout']:\n-            if out['value'] > 1.0:\n-                changeaddress += out['scriptPubKey']['addresses'][0]\n-        assert(changeaddress != \"\")\n-        nextaddr = self.nodes[3].getnewaddress()\n-        # Now the change address key should be removed from the keypool\n-        assert(changeaddress != nextaddr)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#discussion_r127070401",
      "id" : 127070401,
      "original_commit_id" : "6715e782c3049ec43c0c94268f9ad924988e5ddf",
      "original_position" : 28,
      "path" : "test/functional/fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 49618166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10784",
      "updated_at" : "2017-07-12T21:08:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127070401",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Alex was here",
      "created_at" : "2017-07-12T21:00:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314895548",
      "id" : 314895548,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-12T21:00:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314895548",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Pieter was here.",
      "created_at" : "2017-07-13T00:58:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-314939250",
      "id" : 314939250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-13T00:58:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314939250",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Jonas was here (though wants rebase).",
      "created_at" : "2017-07-18T11:55:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-316041489",
      "id" : 316041489,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-18T11:55:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316041489",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2017-07-18T15:20:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10784#issuecomment-316098770",
      "id" : 316098770,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10784",
      "updated_at" : "2017-07-18T15:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316098770",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   }
]
