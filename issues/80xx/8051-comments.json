[
   {
      "body" : "Sense, this makes none: replacing the sync_blocks call with a sleep does not fix it (even when the sleep is longer than how long the sync takes).",
      "created_at" : "2016-05-13T03:28:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-218943822",
      "id" : 218943822,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-13T03:29:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218943822",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Note that #8045 fails due to ` Error: Unable to bind to 0.0.0.0:11280 on this computer. Bitcoin Core is probably already running.` in the network setup phase. Your exception seems unrelated to #8045 .",
      "created_at" : "2016-05-13T12:13:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219026564",
      "id" : 219026564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-13T12:13:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219026564",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke I think the unable to bind is just because i failed to kill the bitcoind from a previous test",
      "created_at" : "2016-05-14T23:40:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219257645",
      "id" : 219257645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-14T23:40:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219257645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Switched to @sdaftuar's solution",
      "created_at" : "2016-05-15T01:58:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219261647",
      "id" : 219261647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-15T01:58:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219261647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8051#discussion_r63287984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63287984"
         }
      },
      "body" : "`-rpcservertimeout=90` is now set twice",
      "commit_id" : "8fd0c66a54ad2eb75903fc584ebd95ab14075572",
      "created_at" : "2016-05-15T08:12:43Z",
      "diff_hunk" : "@@ -48,8 +48,9 @@ def setup_chain(self):\n     # This mirrors how the network was setup in the bash test\n     def setup_network(self, split=False):\n         # nodes 1, 2,3 are spenders, let's give them a keypool=100\n-        extra_args = [[\"-keypool=100\"], [\"-keypool=100\"], [\"-keypool=100\"], []]\n-        self.nodes = start_nodes(4, self.options.tmpdir, extra_args)\n+        extra_args = [[\"-keypool=100\", \"-rpcservertimeout=90\"], [\"-keypool=100\"], [\"-keypool=100\"], []]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#discussion_r63287984",
      "id" : 63287984,
      "original_commit_id" : "e7a7f8f9b1e6630efcdf4641879d58015f170c8c",
      "original_position" : 6,
      "path" : "qa/rpc-tests/walletbackup.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8051",
      "updated_at" : "2016-05-17T03:19:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63287984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8051#discussion_r63459433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63459433"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "8fd0c66a54ad2eb75903fc584ebd95ab14075572",
      "created_at" : "2016-05-17T03:19:19Z",
      "diff_hunk" : "@@ -48,8 +48,9 @@ def setup_chain(self):\n     # This mirrors how the network was setup in the bash test\n     def setup_network(self, split=False):\n         # nodes 1, 2,3 are spenders, let's give them a keypool=100\n-        extra_args = [[\"-keypool=100\"], [\"-keypool=100\"], [\"-keypool=100\"], []]\n-        self.nodes = start_nodes(4, self.options.tmpdir, extra_args)\n+        extra_args = [[\"-keypool=100\", \"-rpcservertimeout=90\"], [\"-keypool=100\"], [\"-keypool=100\"], []]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#discussion_r63459433",
      "id" : 63459433,
      "original_commit_id" : "e7a7f8f9b1e6630efcdf4641879d58015f170c8c",
      "original_position" : 6,
      "path" : "qa/rpc-tests/walletbackup.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8051",
      "updated_at" : "2016-05-17T03:19:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63459433",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I don't understand why a server timeout appears to solve this.\r\n\r\nWhat the server timeout does (or is supposed to do, at least) is time out client sessions that are not making a request. They are in the state either before sending a request (or between request or keep-alive), or pausing too long during sending a request (slowloris).\r\n\r\nThe server should never time out while it is *processing* a request, no matter how long it takes. If that does happen, that is really really bad. This logic is unfortunately implemented in libevent so not easily accessible to us either.\r\n\r\nWhat is your version of libevent?\r\n",
      "created_at" : "2016-05-18T09:15:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219970495",
      "id" : 219970495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-18T09:15:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219970495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "What might happen is that the client hasn't sent a request for a while to the server and thus the server closes the keepalive connection. Python's http doesn't detect this properly and raises an error. I vaguely remember issues with this before.\r\nE.g. see #6695, espeically ddf98d1d84343f2db0502a85628ef80f2ec57dbd.\r\n\r\n    Python's httplib does not graciously handle disconnections from the http server, resulting in BadStatusLine errors.\r\n    See https://bugs.python.org/issue3566 \"httplib persistent connections violate MUST in RFC2616 sec 8.1.4.\"\r\n\r\nHowever according to  this is supposed to be fixed in Python 3.5. But it looks like you're using that.\r\nI'm not sure how well we cope with Python 3.5's solution though.\r\nReverting commit ddf98d1d84343f2db0502a85628ef80f2ec57dbd then testing with Python 3.5 should be interesting.\r\n\r\n\r\n",
      "created_at" : "2016-05-18T09:20:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219971595",
      "id" : 219971595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-18T09:25:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219971595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Ahh so now we get a `BrokenPipeError(32, 'Broken pipe')` (or `CannotSendRequest` ? ). I think that's the new Python 3.5 behavior.\r\n\r\nI think we should catch that and repeat the request with a new connection if we do, analogous to the `except httplib.BadStatusLine as e:` handling in https://github.com/bitcoin/bitcoin/commit/ddf98d1d84343f2db0502a85628ef80f2ec57dbd.\r\n",
      "created_at" : "2016-05-18T09:32:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-219974356",
      "id" : 219974356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-05-18T10:15:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219974356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Thanks, that fixes it.\r\n\r\nRebased and updated to retry on BrokenPipeError as well as BadStatusLine.",
      "created_at" : "2016-06-02T16:36:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8051#issuecomment-223348229",
      "id" : 223348229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8051",
      "updated_at" : "2016-06-02T16:36:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223348229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
