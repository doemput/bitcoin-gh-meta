[
   {
      "body" : "bad_alloc means that memory is full.\r\nAdd swap or reduce the dbcache size :-)\r\n",
      "created_at" : "2016-05-12T09:42:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-218709091",
      "id" : 218709091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-12T09:42:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218709091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I though 2GB ram, minimal linux and dbcache=1500 should do it.\r\nBut let me try to use dbcache=1000.\r\n",
      "created_at" : "2016-05-12T09:44:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-218709464",
      "id" : 218709464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-12T09:44:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218709464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Ideally a bad_alloc would close the application immediately with a clearer error though\r\nSee also #7228, which is even worse as there it simply continues, rejecting a block.\r\n",
      "created_at" : "2016-05-12T10:26:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-218718660",
      "id" : 218718660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-12T10:26:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218718660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "The main problem with the bad_alloc crash is that the database was/is corrupted afterwards.\r\nEither we should implement something like #8037 or try to graceful close in low-men situations (maybe impossible).",
      "created_at" : "2016-05-14T15:40:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-219226956",
      "id" : 219226956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-14T15:40:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219226956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Again a `St9bad_alloc` at `progress=0.901800`.\r\nRAM: 2GB.\r\nDBCache: 800MB.\r\n\r\nNode running in a gnu-screen:\r\n\r\n```\r\nubuntu@pine64:~/bitcoin$ ./src/bitcoind --dbcache=800 --datadir=/disk2/fullnode/ --prune=550\r\n\r\n\r\n************************\r\nEXCEPTION: St9bad_alloc\r\nstd::bad_alloc\r\nbitcoin in ProcessMessages()\r\n\r\nbitcoind: main.cpp:2237: bool ConnectBlock(const CBlock&, CValidationState&, CBlockIndex*, CCoinsViewCache&, const CChainParams&, bool): Assertion `hashPrevBlock == view.GetBestBlock()' failed.\r\nAborted\r\n```\r\n\r\nMore details:\r\n```\r\nubuntu@pine64:~$ tail -f /disk2/fullnode/debug.log \r\n2016-05-25 17:30:53 skip verificationUpdateTip: new best=00000000000000000145cb386289ab8f9015246d226431a4b5de6da87f524c79 height=393014 version=0x00000004 log2_work=83.900934 tx=103124904 date='2016-01-12 14:55:45' progress=0.901795 cache=589.5MiB(357746tx)\r\n2016-05-25 17:30:54 skip verificationUpdateTip: new best=0000000000000000075e9a75e8d44ba9e512e96d05a70a3159b13ad62eef1066 height=393015 version=0x00000004 log2_work=83.90097 tx=103126917 date='2016-01-12 15:00:52' progress=0.901800 cache=590.4MiB(359388tx)\r\n2016-05-25 17:30:58 skip verification\r\n\r\n************************\r\nEXCEPTION: St9bad_alloc       \r\nstd::bad_alloc       \r\nbitcoin in ProcessMessages()       \r\n\r\n2016-05-25 17:31:12 ProcessMessages(block, 248665 bytes) FAILED peer=31\r\n^C\r\nubuntu@pine64:~$ free\r\n              total        used        free      shared  buff/cache   available\r\nMem:        2036960       49056     1731308       16744      256596     1939369\r\nSwap:             0           0           0\r\nubuntu@pine64:~$ \r\n```\r\n\r\nRAM failure?",
      "created_at" : "2016-05-26T07:32:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-221798239",
      "id" : 221798239,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-26T07:32:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221798239",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Calling `free` *after* the memory has been deallocated by the kernel doesn't provide any information. Call free periodically in other `screen`...",
      "created_at" : "2016-05-26T07:35:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-221798704",
      "id" : 221798704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-26T07:35:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221798704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@paveljanik: I did paste the `free` output only to prove the system total memory (2GB).",
      "created_at" : "2016-05-26T07:56:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-221802813",
      "id" : 221802813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-26T07:56:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221802813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschnelli It may be useful to monitor memory usage while the application is running too...",
      "created_at" : "2016-05-26T12:18:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8044#issuecomment-221855271",
      "id" : 221855271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8044",
      "updated_at" : "2016-05-26T12:18:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221855271",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
