[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6723#discussion_r40449623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6723"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40449623"
         }
      },
      "body" : "Including `wallet.h` here makes the smallest diff but I am not sure if this complies with bitcoin coding guidelines? Also travis fails because I did not yet consider no-wallet builds.",
      "commit_id" : "b824e63c133315ff45ea83f5cc3b41a3dcdcf6a9",
      "created_at" : "2015-09-25T16:42:31Z",
      "diff_hunk" : "@@ -33,6 +33,7 @@\n #include \"utilmoneystr.h\"\n #include \"utilstrencodings.h\"\n #include \"validationinterface.h\"\n+#include \"wallet/wallet.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#discussion_r40449623",
      "id" : 40449623,
      "original_commit_id" : "b824e63c133315ff45ea83f5cc3b41a3dcdcf6a9",
      "original_position" : 4,
      "path" : "src/main.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6723",
      "updated_at" : "2015-09-25T16:44:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40449623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Seems to be NACK territory.\r\n\r\nCoupling the wallets `-maxtxfee` to mempool seems as a step in the wrong direction. `-maxtxfee` is a protection of the wallet part.\r\nIf we are unhappy with `minRelayTxFee.GetFee(nSize) * 10000` as max mempool fee, we should think about adding another `-arg` or searching after a better non-magic-number solution.",
      "created_at" : "2015-09-25T16:53:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143279084",
      "id" : 143279084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T16:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143279084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Yes, maybe you are right. I created the PR to point out a bug in the wallet:\r\n\r\nLocally created transaction (Qt, sendtoaddress, rawtransaction, ...) are usually added to the mempool. The problem appears when the mempool uses different rules than Qt to determine if a transaction is \"valid\": A \"valid\" transaction created (by e.g. Qt) may be rejected AFTER being added to the wallet. This leads to the double-spend-warning and conflicted-tx icon in Qt. Imo, this is not only misleading but a wallet bug which should be fixed. This feature was introduced in #2949.",
      "created_at" : "2015-09-25T17:00:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143283076",
      "id" : 143283076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T17:00:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143283076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Agree with Jonas.\n",
      "created_at" : "2015-09-25T17:01:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143283399",
      "id" : 143283399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T17:01:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143283399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@MarcoFalke: if this is the cases (didn't check myself), than the wallet should reject a transaction that cannot be added to the local mempool. In future, a mempool could be optional for the (QT)wallet, ... maybe the wallet should check if the transaction was broadcasted over the network (by checking if some invs of some nodes come in). If no invs of the just sent tx are coming in (after reasonable timespan), warn the user, allow to increase fees, etc.",
      "created_at" : "2015-09-25T17:05:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143286393",
      "id" : 143286393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T17:05:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143286393",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I think the whole maximum behavior is not worth having if it introduces another economically varying parameter that must be maintained.\r\n\r\nI've tested rawtx and it correctly does not add the transaction to the wallet.\r\n\r\nI don't think this behavior really should be applied to non-raw-tx as there is no mechanism to override and it should have better ways to avoid crazy fees.  This really only exists as a last ditch protection to catch the crazy cases we've observed where users have lost tens or hundreds of BTC to fees because they (or software they're running) misunderstood and misused the raw transaction interface.",
      "created_at" : "2015-09-25T17:37:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143297836",
      "id" : 143297836,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T17:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143297836",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> @jonasschnelli  didn't check myself\r\n\r\nSteps to reproduce on 48efbdb:\r\n```\r\n-> settxfee 0.04\r\n<- true\r\n\r\n-> sendtoaddress mwEHWzBhaPYiErWWhmWW7QCjGoKNPaQQax 16\r\n<- Error: The transaction was rejected! This might happen if some of the coins in your wallet were already spent, such as if you used a copy of wallet.dat and coins were spent in the copy but not marked as spent here. (code -4)\r\n```\r\n\r\n\r\n\r\n\r\n> @gmaxwell I've tested rawtx and it correctly does not add the transaction to the wallet.\r\n\r\nSorry, my mistake. (Only transactions where the wallet calculates the fee are affected)\r\n\r\nYou can \"work around\" this bug by setting `-minrelaytxfee` higher:\r\n\r\n```\r\n[command-line arg -minrelaytxfee=0.00002000]\r\n\r\n-> settxfee 0.04\r\n<- true\r\n\r\n\r\n-> sendtoaddress mwEHWzBhaPYiErWWhmWW7QCjGoKNPaQQax 8\r\n<- f2b6c51afbf09ee05422a19916410c038198b3c4f9921b6c6262c98b69e9817b\r\n\r\n```\r\n\r\n**However**, \"normal\" transaction will then falsely include a higher fee, even though `minrelaytxfee` should not be coupled with transaction creation. (At least not without educating the non-code reading user):\r\n\r\n```\r\n[still command-line arg -minrelaytxfee=0.00002000]\r\n\r\n-> settxfee 0\r\n<- true\r\n\r\n\r\n-> sendtoaddress mwEHWzBhaPYiErWWhmWW7QCjGoKNPaQQax 8\r\n<- 6269040f060061858ff9e11bbce9bed2ded6cc299f296b8898ecc30e77a7f1bf\r\n```\r\nWhere 6296040... pays a fee of .00002 BTC per kB (=minrelaytxfee)\r\n\r\n\r\n> @gmaxwell I don't think this behavior really should be applied to non-raw-tx\r\n\r\nSounds reasonable and should be easy to code. I will have a look...",
      "created_at" : "2015-09-25T18:48:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143319643",
      "id" : 143319643,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T18:48:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143319643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "An alternative (not for this PR) would be to have a way of calling\nAcceptToMemoryPool in a dummy mode, where everything is done except\nactually adding to the mempool. Such a function could optionally return a\ndata structure with information about the transaction's effects that can\nonly be computed with the UTXO set present, such as fees, age of inputs, ...\n\nThat could move the high fee detection logic to RPC, rather than being part\nof the network relay code...\n",
      "created_at" : "2015-09-25T18:59:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143322318",
      "id" : 143322318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-25T18:59:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143322318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing per \"I don't think this behavior really should be applied to non-raw-tx\".",
      "created_at" : "2015-09-26T17:45:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-143475219",
      "id" : 143475219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2015-09-26T17:45:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143475219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "This was merged as #7084 instead.",
      "created_at" : "2016-03-14T00:35:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6723#issuecomment-196089068",
      "id" : 196089068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6723",
      "updated_at" : "2016-03-14T00:35:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/196089068",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
