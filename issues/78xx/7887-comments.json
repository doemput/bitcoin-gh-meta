[
   {
      "body" : "This makes CBlockReject dead code.",
      "created_at" : "2016-04-15T21:10:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-210647506",
      "id" : 210647506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-15T21:10:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210647506",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "`p2p-fullblocktest.py` fails and would require update:\r\n`Block not in reject map: 13572f60d7b17134219196b3dba1c8f175782feac4e4e02d5bd957d7b946e0e6`\r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/123437467#L4534",
      "created_at" : "2016-04-16T07:21:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-210756429",
      "id" : 210756429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-16T07:21:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210756429",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "This means no reject messages or misbehaviour/banning will trigger anymore for any block validation rules (after their header was accepted). Is that intentional?",
      "created_at" : "2016-04-16T08:53:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-210775716",
      "id" : 210775716,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-16T08:53:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210775716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@kazcw : Indeed, it does make CBlockReject dead code, I'll remove it, too.\r\n\r\n@jonasschnelli : I'll fix p2p-fullblocktest, don't know how I managed not to run it.\r\n\r\n@sipa : Rejection and DoS still happens in the else if (strCommand == NetMsgType::BLOCK ...) condition in ProcessMessages, if ProcessNewBlock returns an invalid validation state.\r\n\r\nI may be mis-reading the code (in which case there needs to be a big comment in the code explaining why it doesn't do what it says), but ProcessNewBlock calls  AcceptBlock, which calls AcceptBlockHeader and CheckBlock and ContextualCheckBlock and ActivateBestChain with the same validation state.  Looking again... ActivateBestChainStep overwrites an invalid validation state if ConnectTip fails?  WTF?\r\n\r\nI wrote an alternative version of this pull request that uses mapBlocksInFlight to identify the peer that sent us a block (using Boost.ScopeExit and modifying ProcessNewBlock so the entry in mapBlocksInFlight isn't removed until all of the validation is done).\r\n\r\n",
      "created_at" : "2016-04-16T16:01:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-210846694",
      "id" : 210846694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-16T16:01:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210846694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen ProcessNewBlock's state only returns errors resulting from failure to add it to the block index (header invalid, checktransaction fails, system error when writing to disk, ...). Activation of the best block is treated as something happening in the background, and its errors are reported via InvalidBlockFound (specifically so errors don't get reported twice).",
      "created_at" : "2016-04-16T16:15:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-210848601",
      "id" : 210848601,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-16T16:15:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210848601",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing this for now-- but I put refactoring the way validation errors are reported from ProcessNewBlock on my mental TODO list (the goal I'm working towards is parallel validation of new blocks).\r\n",
      "created_at" : "2016-04-18T15:15:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7887#issuecomment-211425004",
      "id" : 211425004,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7887",
      "updated_at" : "2016-04-18T15:15:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/211425004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   }
]
